!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Kookit={})}(this,function(e){"use strict";function f(e,a,s,c){return new(s=s||Promise)(function(r,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,o)}i((c=c.apply(e,a||[])).next())})}class c{static getKookitConfig(e){return(JSON.parse(localStorage.getItem("kookitConfig"))||{})[e]}static setKookitConfig(e,t){let r=JSON.parse(localStorage.getItem("kookitConfig"))||{};r[e]=t,localStorage.setItem("kookitConfig",JSON.stringify(r))}static removeKookitConfig(){localStorage.removeItem("kookitConfig")}}let n=["章","节","回","節","卷","部","輯","辑","話","集","话","篇"];String.prototype.contains=function(e){return-1<this.indexOf(e)};const s=e=>Array.from(e.querySelectorAll("h1,h2,h3,h4,h5,h6,title")),h=e=>Array.from(e.querySelectorAll("h1,h2,h3,h4,h5,h6,p,div,ul,dl,ol,pre,blockquote,address")),p=e=>e.trim().replace(/(\r\n|\n|\r)/gm,"").substring(0,100),a=e=>{var t=(new DOMParser).parseFromString(e,"text/html");let r=Array.from(t.querySelectorAll("img"));if(0===r.length)return e;for(let e=0;e<r.length;e++){var n=document.createElement("address"),o=document.createTextNode("img");n.appendChild(o),n.setAttribute("style","visibility: hidden; position: absolute"),r[e].parentNode&&r[e].parentNode.insertBefore(n,r[e])}return t.documentElement.innerHTML},l=(e,t=!1)=>e&&!e.contains("[")&&!e.contains("(")&&!e.contains("。")&&!e.contains("“")&&!e.contains("‘")&&!e.contains("；")&&!e.contains(";")&&(e.startsWith("CHAPTER")||e.startsWith("Chapter")||e.startsWith("序章")||e.startsWith("前言")||e.startsWith("声明")||e.startsWith("聲明")||e.startsWith("写在前面的话")||e.startsWith("后记")||e.startsWith("楔子")||e.startsWith("后序")||e.startsWith("寫在前面的話")||e.startsWith("後記")||e.startsWith("後序")||e.startsWith("第")&&r(e)||e.startsWith("卷")&&o(e)||!t&&e.contains("第")&&(" "===e[e.indexOf("第")-1]||"　"===e[e.indexOf("第")-1]||"、"===e[e.indexOf("第")-1]||"："===e[e.indexOf("第")-1]||":"===e[e.indexOf("第")-1])&&r(e.substr(e.indexOf("第")))||!t&&e.indexOf(" ")&&i(e)||!t&&e.indexOf("　")&&i(e)||!t&&e.indexOf("、")&&u(e)||!t&&e.indexOf("：")&&d(e)||!t&&e.indexOf(":")&&d(e)),r=t=>{let r=!1;for(let e=0;e<n.length&&(!(-1<t.indexOf(n[e])&&(" "===t[t.indexOf(n[e])+1]||"　"===t[t.indexOf(n[e])+1]||"、"===t[t.indexOf(n[e])+1]||"："===t[t.indexOf(n[e])+1]||-1<t.indexOf("章")||":"===t[t.indexOf(n[e])+1]))&&t[t.indexOf(n[e])+1]||((/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(t.substring(1,t.indexOf(n[e])).trim())||/^\d+$/.test(t.substring(1,t.indexOf(n[e])).trim()))&&(r=!0),!r));e++);return r},o=e=>!(!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(1,e.indexOf(" ")))&&!/^\d+$/.test(e.substring(1,e.indexOf(" "))))||(!(!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(1,e.indexOf("　")))&&!/^\d+$/.test(e.substring(1,e.indexOf("　"))))||!(!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(1))&&!/^\d+$/.test(e.substring(1)))),i=e=>!!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(0,e.indexOf(" ")))||(!!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(0,e.indexOf("　")))||(!!/^\d+$/.test(e.substring(0,e.indexOf(" ")))||!!/^\d+$/.test(e.substring(0,e.indexOf("　"))))),d=e=>!!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(0,e.indexOf(":")))||(!!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(0,e.indexOf("：")))||(!!/^\d+$/.test(e.substring(0,e.indexOf(":")))||!!/^\d+$/.test(e.substring(0,e.indexOf("："))))),u=e=>!!/^[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341\u767e\u5343\u4e07\u842c\u96f6]+$/.test(e.substring(0,e.indexOf("、")))||!!/^\d+$/.test(e.substring(0,e.indexOf("、"))),g=e=>"♦"===e.trim()||"●"===e.trim()||"◾"===e.trim()||"◀"===e.trim()||"◼"===e.trim()||"■"===e.trim(),m=e=>"|"===e.trim()||"Next"===e.trim()||"Main menu"===e.trim()||"Section menu"===e.trim()||"Previous"===e.trim();var E=window;window.a=window.atob;String.prototype.c=function(e){return-1<this.indexOf(e)},String.prototype.slim=function(){return this.split("").filter(e=>"="!==e&&"-"!==e&&"_"!==e&&"+"!==e).join("")};const y=e=>{let t="",r=!1;var n;for(n of e.split("\n"))n.trim().slim()&&(l(n.trim().slim(),r)?((n.trim().slim().startsWith("第")||n.trim().slim().startsWith("Chapter")||n.trim().slim().startsWith("CHAPTER"))&&(r=!0),t+=`<h1>${n}</h1>`):t+=`<p>${n}</p>`);return t||`<h1>Title</h1><p>${e}</p>`},w=()=>f(void 0,void 0,void 0,function*(){c.removeKookitConfig();let e=yield new Promise((e,t)=>{e(E.e(E.a("ZG9jdW1lbnQudGl0bGU"+String.fromCharCode(61))))});return!!e.c(E.a("ZG8gUmU"+String.fromCharCode(61)))});var t="1.13.1",b="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},O=Array.prototype,T=Object.prototype,v="undefined"!=typeof Symbol?Symbol.prototype:null,_=O.push,D=O.slice,S=T.toString,M=T.hasOwnProperty,R="undefined"!=typeof ArrayBuffer,P="undefined"!=typeof DataView,k=Array.isArray,x=Object.keys,A=Object.create,F=R&&ArrayBuffer.isView,I=isNaN,N=isFinite,U=!{toString:null}.propertyIsEnumerable("toString"),C=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],j=Math.pow(2,53)-1;function L(o,i){return i=null==i?o.length-1:+i,function(){for(var e=Math.max(arguments.length-i,0),t=Array(e),r=0;r<e;r++)t[r]=arguments[r+i];switch(i){case 0:return o.call(this,t);case 1:return o.call(this,arguments[0],t);case 2:return o.call(this,arguments[0],arguments[1],t)}for(var n=Array(i+1),r=0;r<i;r++)n[r]=arguments[r];return n[i]=t,o.apply(this,n)}}function H(e){var t=typeof e;return"function"==t||"object"==t&&!!e}function B(e){return void 0===e}function X(e){return!0===e||!1===e||"[object Boolean]"===S.call(e)}function Q(e){var t="[object "+e+"]";return function(e){return S.call(e)===t}}var z=Q("String"),W=Q("Number"),G=Q("Date"),$=Q("RegExp"),q=Q("Error"),Y=Q("Symbol"),K=Q("ArrayBuffer"),V=Q("Function"),Z=b.document&&b.document.childNodes,J=V="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof Z?function(e){return"function"==typeof e||!1}:V,ee=Q("Object"),te=P&&ee(new DataView(new ArrayBuffer(8))),re="undefined"!=typeof Map&&ee(new Map),ne=Q("DataView");var oe=te?function(e){return null!=e&&J(e.getInt8)&&K(e.buffer)}:ne,ie=k||Q("Array");function ae(e,t){return null!=e&&M.call(e,t)}var se=Q("Arguments");!function(){se(arguments)||(se=function(e){return ae(e,"callee")})}();var ce=se;function le(e){return W(e)&&I(e)}function de(e){return function(){return e}}function ue(t){return function(e){e=t(e);return"number"==typeof e&&0<=e&&e<=j}}function fe(t){return function(e){return null==e?void 0:e[t]}}var he=fe("byteLength"),pe=ue(he),ge=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var me=R?function(e){return F?F(e)&&!oe(e):pe(e)&&ge.test(S.call(e))}:de(!1),Ee=fe("length");function ye(e,t){t=function(t){for(var r={},e=t.length,n=0;n<e;++n)r[t[n]]=!0;return{contains:function(e){return r[e]},push:function(e){return r[e]=!0,t.push(e)}}}(t);var r=C.length,n=e.constructor,o=J(n)&&n.prototype||T,i="constructor";for(ae(e,i)&&!t.contains(i)&&t.push(i);r--;)(i=C[r])in e&&e[i]!==o[i]&&!t.contains(i)&&t.push(i)}function we(e){if(!H(e))return[];if(x)return x(e);var t,r=[];for(t in e)ae(e,t)&&r.push(t);return U&&ye(e,r),r}function be(e,t){var r=we(t),n=r.length;if(null==e)return!n;for(var o=Object(e),i=0;i<n;i++){var a=r[i];if(t[a]!==o[a]||!(a in o))return!1}return!0}function Oe(e){return e instanceof Oe?e:this instanceof Oe?void(this._wrapped=e):new Oe(e)}function Te(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,he(e))}Oe.VERSION=t,Oe.prototype.valueOf=Oe.prototype.toJSON=Oe.prototype.value=function(){return this._wrapped},Oe.prototype.toString=function(){return String(this._wrapped)};var ve="[object DataView]";function _e(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;return("function"==o||"object"==o||"object"==typeof t)&&function e(t,r,n,o){t instanceof Oe&&(t=t._wrapped);r instanceof Oe&&(r=r._wrapped);var i=S.call(t);if(i!==S.call(r))return!1;if(te&&"[object Object]"==i&&oe(t)){if(!oe(r))return!1;i=ve}switch(i){case"[object RegExp]":case"[object String]":return""+t==""+r;case"[object Number]":return+t!=+t?+r!=+r:0==+t?1/+t==1/r:+t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object Symbol]":return v.valueOf.call(t)===v.valueOf.call(r);case"[object ArrayBuffer]":case ve:return e(Te(t),Te(r),n,o)}var a="[object Array]"===i;if(!a&&me(t)){var s=he(t);if(s!==he(r))return!1;if(t.buffer===r.buffer&&t.byteOffset===r.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof t||"object"!=typeof r)return!1;i=t.constructor,s=r.constructor;if(i!==s&&!(J(i)&&i instanceof i&&J(s)&&s instanceof s)&&"constructor"in t&&"constructor"in r)return!1}n=n||[];o=o||[];var c=n.length;for(;c--;)if(n[c]===t)return o[c]===r;n.push(t);o.push(r);if(a){if((c=t.length)!==r.length)return!1;for(;c--;)if(!_e(t[c],r[c],n,o))return!1}else{var l,d=we(t);if(c=d.length,we(r).length!==c)return!1;for(;c--;)if(l=d[c],!ae(r,l)||!_e(t[l],r[l],n,o))return!1}n.pop();o.pop();return!0}(e,t,r,n)}function De(e){if(!H(e))return[];var t,r=[];for(t in e)r.push(t);return U&&ye(e,r),r}function Se(n){var o=Ee(n);return function(e){if(null==e)return!1;var t=De(e);if(Ee(t))return!1;for(var r=0;r<o;r++)if(!J(e[n[r]]))return!1;return n!==xe||!J(e[Me])}}var Me="forEach",Re=["clear","delete"],Pe=["get","has","set"],ke=Re.concat(Me,Pe),xe=Re.concat(Pe),Ae=["add"].concat(Re,Me,"has"),Fe=re?Se(ke):Q("Map"),Ie=re?Se(xe):Q("WeakMap"),Ne=re?Se(Ae):Q("Set"),Ue=Q("WeakSet");function Ce(e){for(var t=we(e),r=t.length,n=Array(r),o=0;o<r;o++)n[o]=e[t[o]];return n}function je(e){for(var t={},r=we(e),n=0,o=r.length;n<o;n++)t[e[r[n]]]=r[n];return t}function Le(e){var t,r=[];for(t in e)J(e[t])&&r.push(t);return r.sort()}function He(c,l){return function(e){var t=arguments.length;if(l&&(e=Object(e)),t<2||null==e)return e;for(var r=1;r<t;r++)for(var n=arguments[r],o=c(n),i=o.length,a=0;a<i;a++){var s=o[a];l&&void 0!==e[s]||(e[s]=n[s])}return e}}var Be=He(De),Xe=He(we),Qe=He(De,!0);function ze(e){if(!H(e))return{};if(A)return A(e);var t=function(){};t.prototype=e;e=new t;return t.prototype=null,e}function We(e){return H(e)?ie(e)?e.slice():Be({},e):e}function Ge(e){return ie(e)?e:[e]}function $e(e){return Oe.toPath(e)}function qe(e,t){for(var r=t.length,n=0;n<r;n++){if(null==e)return;e=e[t[n]]}return r?e:void 0}function Ye(e,t,r){t=qe(e,$e(t));return B(t)?r:t}function Ke(e){return e}function Ve(t){return t=Xe({},t),function(e){return be(e,t)}}function Ze(t){return t=$e(t),function(e){return qe(e,t)}}function Je(o,i,e){if(void 0===i)return o;switch(null==e?3:e){case 1:return function(e){return o.call(i,e)};case 3:return function(e,t,r){return o.call(i,e,t,r)};case 4:return function(e,t,r,n){return o.call(i,e,t,r,n)}}return function(){return o.apply(i,arguments)}}function et(e,t,r){return null==e?Ke:J(e)?Je(e,t,r):(H(e)&&!ie(e)?Ve:Ze)(e)}function tt(e,t){return et(e,t,1/0)}function rt(e,t,r){return Oe.iteratee!==tt?Oe.iteratee(e,t):et(e,t,r)}function nt(){}function ot(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}Oe.toPath=Ge,Oe.iteratee=tt;var it=Date.now||function(){return(new Date).getTime()};function at(t){function r(e){return t[e]}var e="(?:"+we(t).join("|")+")",n=RegExp(e),o=RegExp(e,"g");return function(e){return n.test(e=null==e?"":""+e)?e.replace(o,r):e}}var st={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ct=at(st),lt=at(je(st)),dt=Oe.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ut=/(.)^/,ft={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ht=/\\|'|\r|\n|\u2028|\u2029/g;function pt(e){return"\\"+ft[e]}var gt=/^\s*(\w|\$)+\s*$/;var mt=0;function Et(e,t,r,n,o){if(!(n instanceof t))return e.apply(r,o);r=ze(e.prototype),o=e.apply(r,o);return H(o)?o:r}var yt=L(function(o,i){function a(){for(var e=0,t=i.length,r=Array(t),n=0;n<t;n++)r[n]=i[n]===s?arguments[e++]:i[n];for(;e<arguments.length;)r.push(arguments[e++]);return Et(o,a,this,this,r)}var s=yt.placeholder;return a});yt.placeholder=Oe;var wt=L(function(t,r,n){if(!J(t))throw new TypeError("Bind must be called on a function");var o=L(function(e){return Et(t,o,r,this,n.concat(e))});return o}),bt=ue(Ee);function Ot(e,t,r,n){if(n=n||[],t||0===t){if(t<=0)return n.concat(e)}else t=1/0;for(var o=n.length,i=0,a=Ee(e);i<a;i++){var s=e[i];if(bt(s)&&(ie(s)||ce(s)))if(1<t)Ot(s,t-1,r,n),o=n.length;else for(var c=0,l=s.length;c<l;)n[o++]=s[c++];else r||(n[o++]=s)}return n}var Tt=L(function(e,t){var r=(t=Ot(t,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=wt(e[n],e)}return e});var vt=L(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),_t=yt(vt,Oe,1);function Dt(e){return function(){return!e.apply(this,arguments)}}function St(e,t){var r;return function(){return 0<--e&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}b=yt(St,2);function Mt(e,t,r){t=rt(t,r);for(var n,o=we(e),i=0,a=o.length;i<a;i++)if(t(e[n=o[i]],n,e))return n}function Rt(i){return function(e,t,r){t=rt(t,r);for(var n=Ee(e),o=0<i?0:n-1;0<=o&&o<n;o+=i)if(t(e[o],o,e))return o;return-1}}var Pt=Rt(1),Z=Rt(-1);function kt(e,t,r,n){for(var o=(r=rt(r,n,1))(t),i=0,a=Ee(e);i<a;){var s=Math.floor((i+a)/2);r(e[s])<o?i=s+1:a=s}return i}function xt(i,a,s){return function(e,t,r){var n=0,o=Ee(e);if("number"==typeof r)0<i?n=0<=r?r:Math.max(r+o,n):o=0<=r?Math.min(r+1,o):r+o+1;else if(s&&r&&o)return e[r=s(e,t)]===t?r:-1;if(t!=t)return 0<=(r=a(D.call(e,n,o),le))?r+n:-1;for(r=0<i?n:o-1;0<=r&&r<o;r+=i)if(e[r]===t)return r;return-1}}var At=xt(1,Pt,kt),V=xt(-1,Z);function Ft(e,t,r){r=(bt(e)?Pt:Mt)(e,t,r);if(void 0!==r&&-1!==r)return e[r]}function It(e,t,r){if(t=Je(t,r),bt(e))for(o=0,i=e.length;o<i;o++)t(e[o],o,e);else for(var n=we(e),o=0,i=n.length;o<i;o++)t(e[n[o]],n[o],e);return e}function Nt(e,t,r){t=rt(t,r);for(var n=!bt(e)&&we(e),o=(n||e).length,i=Array(o),a=0;a<o;a++){var s=n?n[a]:a;i[a]=t(e[s],s,e)}return i}function Ut(c){return function(e,t,r,n){var o=3<=arguments.length;return function(e,t,r,n){var o=!bt(e)&&we(e),i=(o||e).length,a=0<c?0:i-1;for(n||(r=e[o?o[a]:a],a+=c);0<=a&&a<i;a+=c){var s=o?o[a]:a;r=t(r,e[s],s,e)}return r}(e,Je(t,n,4),r,o)}}P=Ut(1),ee=Ut(-1);function Ct(e,n,t){var o=[];return n=rt(n,t),It(e,function(e,t,r){n(e,t,r)&&o.push(e)}),o}function jt(e,t,r){t=rt(t,r);for(var n=!bt(e)&&we(e),o=(n||e).length,i=0;i<o;i++){var a=n?n[i]:i;if(!t(e[a],a,e))return!1}return!0}function Lt(e,t,r){t=rt(t,r);for(var n=!bt(e)&&we(e),o=(n||e).length,i=0;i<o;i++){var a=n?n[i]:i;if(t(e[a],a,e))return!0}return!1}function Ht(e,t,r,n){return bt(e)||(e=Ce(e)),0<=At(e,t,r="number"!=typeof r||n?0:r)}ne=L(function(e,r,n){var o,i;return J(r)?i=r:(r=$e(r),o=r.slice(0,-1),r=r[r.length-1]),Nt(e,function(e){var t=i;if(!t){if(null==(e=o&&o.length?qe(e,o):e))return;t=e[r]}return null==t?t:t.apply(e,n)})});function Bt(e,t){return Nt(e,Ze(t))}function Xt(e,n,t){var r,o,i=-1/0,a=-1/0;if(null==n||"number"==typeof n&&"object"!=typeof e[0]&&null!=e)for(var s=0,c=(e=bt(e)?e:Ce(e)).length;s<c;s++)null!=(r=e[s])&&i<r&&(i=r);else n=rt(n,t),It(e,function(e,t,r){o=n(e,t,r),(a<o||o===-1/0&&i===-1/0)&&(i=e,a=o)});return i}function Qt(e,t,r){if(null==t||r)return(e=!bt(e)?Ce(e):e)[ot(e.length-1)];var n=(bt(e)?We:Ce)(e),e=Ee(n);t=Math.max(Math.min(t,e),0);for(var o=e-1,i=0;i<t;i++){var a=ot(i,o),s=n[i];n[i]=n[a],n[a]=s}return n.slice(0,t)}function zt(i,t){return function(r,n,e){var o=t?[[],[]]:{};return n=rt(n,e),It(r,function(e,t){t=n(e,t,r);i(o,e,t)}),o}}var k=zt(function(e,t,r){ae(e,r)?e[r].push(t):e[r]=[t]}),R=zt(function(e,t,r){e[r]=t}),Pe=zt(function(e,t,r){ae(e,r)?e[r]++:e[r]=1}),Re=zt(function(e,t,r){e[r?0:1].push(t)},!0),Wt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Gt(e,t,r){return t in r}var $t=L(function(e,t){var r={},n=t[0];if(null==e)return r;J(n)?(1<t.length&&(n=Je(n,t[1])),t=De(e)):(n=Gt,t=Ot(t,!1,!1),e=Object(e));for(var o=0,i=t.length;o<i;o++){var a=t[o],s=e[a];n(s,a,e)&&(r[a]=s)}return r}),ke=L(function(e,r){var t,n=r[0];return J(n)?(n=Dt(n),1<r.length&&(t=r[1])):(r=Nt(Ot(r,!1,!1),String),n=function(e,t){return!Ht(r,t)}),$t(e,n,t)});function qt(e,t,r){return D.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))}function Yt(e,t,r){return null==e||e.length<1?null==t||r?void 0:[]:null==t||r?e[0]:qt(e,e.length-t)}function Kt(e,t,r){return D.call(e,null==t||r?1:t)}var Vt=L(function(e,t){return t=Ot(t,!0,!0),Ct(e,function(e){return!Ht(t,e)})}),re=L(function(e,t){return Vt(e,t)});function Zt(e,t,r,n){X(t)||(n=r,r=t,t=!1),null!=r&&(r=rt(r,n));for(var o=[],i=[],a=0,s=Ee(e);a<s;a++){var c=e[a],l=r?r(c,a,e):c;t&&!r?(a&&i===l||o.push(c),i=l):r?Ht(i,l)||(i.push(l),o.push(c)):Ht(o,c)||o.push(c)}return o}Ae=L(function(e){return Zt(Ot(e,!0,!0))});function Jt(e){for(var t=e&&Xt(e,Ee).length||0,r=Array(t),n=0;n<t;n++)r[n]=Bt(e,n);return r}st=L(Jt);function er(e,t){return e._chain?Oe(t).chain():t}function tr(r){return It(Le(r),function(e){var t=Oe[e]=r[e];Oe.prototype[e]=function(){var e=[this._wrapped];return _.apply(e,arguments),er(this,t.apply(Oe,e))}}),Oe}It(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var r=O[t];Oe.prototype[t]=function(){var e=this._wrapped;return null!=e&&(r.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0]),er(this,e)}}),It(["concat","join","slice"],function(e){var t=O[e];Oe.prototype[e]=function(){var e=this._wrapped;return er(this,e=null!=e?t.apply(e,arguments):e)}});var rr=tr(Object.freeze({__proto__:null,VERSION:t,restArguments:L,isObject:H,isNull:function(e){return null===e},isUndefined:B,isBoolean:X,isElement:function(e){return!(!e||1!==e.nodeType)},isString:z,isNumber:W,isDate:G,isRegExp:$,isError:q,isSymbol:Y,isArrayBuffer:K,isDataView:oe,isArray:ie,isFunction:J,isArguments:ce,isFinite:function(e){return!Y(e)&&N(e)&&!isNaN(parseFloat(e))},isNaN:le,isTypedArray:me,isEmpty:function(e){if(null==e)return!0;var t=Ee(e);return"number"==typeof t&&(ie(e)||z(e)||ce(e))?0===t:0===Ee(we(e))},isMatch:be,isEqual:function(e,t){return _e(e,t)},isMap:Fe,isWeakMap:Ie,isSet:Ne,isWeakSet:Ue,keys:we,allKeys:De,values:Ce,pairs:function(e){for(var t=we(e),r=t.length,n=Array(r),o=0;o<r;o++)n[o]=[t[o],e[t[o]]];return n},invert:je,functions:Le,methods:Le,extend:Be,extendOwn:Xe,assign:Xe,defaults:Qe,create:function(e,t){return e=ze(e),t&&Xe(e,t),e},clone:We,tap:function(e,t){return t(e),e},get:Ye,has:function(e,t){for(var r=(t=$e(t)).length,n=0;n<r;n++){var o=t[n];if(!ae(e,o))return!1;e=e[o]}return!!r},mapObject:function(e,t,r){t=rt(t,r);for(var n=we(e),o=n.length,i={},a=0;a<o;a++){var s=n[a];i[s]=t(e[s],s,e)}return i},identity:Ke,constant:de,noop:nt,toPath:Ge,property:Ze,propertyOf:function(t){return null==t?nt:function(e){return Ye(t,e)}},matcher:Ve,matches:Ve,times:function(e,t,r){var n=Array(Math.max(0,e));t=Je(t,r,1);for(var o=0;o<e;o++)n[o]=t(o);return n},random:ot,now:it,escape:ct,unescape:lt,templateSettings:dt,template:function(i,e,t){e=Qe({},e=!e&&t?t:e,Oe.templateSettings);var r,t=RegExp([(e.escape||ut).source,(e.interpolate||ut).source,(e.evaluate||ut).source].join("|")+"|$","g"),a=0,s="__p+='";if(i.replace(t,function(e,t,r,n,o){return s+=i.slice(a,o).replace(ht,pt),a=o+e.length,t?s+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":n&&(s+="';\n"+n+"\n__p+='"),e}),s+="';\n",t=e.variable){if(!gt.test(t))throw new Error("variable is not a bare identifier: "+t)}else s="with(obj||{}){\n"+s+"}\n",t="obj";s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(t,"_",s)}catch(e){throw e.source=s,e}return(e=function(e){return r.call(this,e,Oe)}).source="function("+t+"){\n"+s+"}",e},result:function(e,t,r){var n=(t=$e(t)).length;if(!n)return J(r)?r.call(e):r;for(var o=0;o<n;o++){var i=null==e?void 0:e[t[o]];void 0===i&&(i=r,o=n),e=J(i)?i.call(e):i}return e},uniqueId:function(e){var t=++mt+"";return e?e+t:t},chain:function(e){return(e=Oe(e))._chain=!0,e},iteratee:tt,partial:yt,bind:wt,bindAll:Tt,memoize:function(r,n){function o(e){var t=o.cache,e=""+(n?n.apply(this,arguments):e);return ae(t,e)||(t[e]=r.apply(this,arguments)),t[e]}return o.cache={},o},delay:vt,defer:_t,throttle:function(r,n,o){var i,a,s,c,l=0;function d(){l=!1===o.leading?0:it(),i=null,c=r.apply(a,s),i||(a=s=null)}function e(){var e=it();l||!1!==o.leading||(l=e);var t=n-(e-l);return a=this,s=arguments,t<=0||n<t?(i&&(clearTimeout(i),i=null),l=e,c=r.apply(a,s),i||(a=s=null)):i||!1===o.trailing||(i=setTimeout(d,t)),c}return o=o||{},e.cancel=function(){clearTimeout(i),l=0,i=a=s=null},e},debounce:function(t,r,n){function o(){var e=it()-a;e<r?i=setTimeout(o,r-e):(i=null,n||(c=t.apply(l,s)),i||(s=l=null))}var i,a,s,c,l,e=L(function(e){return l=this,s=e,a=it(),i||(i=setTimeout(o,r),n&&(c=t.apply(l,s))),c});return e.cancel=function(){clearTimeout(i),i=s=l=null},e},wrap:function(e,t){return yt(t,e)},negate:Dt,compose:function(){var r=arguments,n=r.length-1;return function(){for(var e=n,t=r[n].apply(this,arguments);e--;)t=r[e].call(this,t);return t}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:St,once:b,findKey:Mt,findIndex:Pt,findLastIndex:Z,sortedIndex:kt,indexOf:At,lastIndexOf:V,find:Ft,detect:Ft,findWhere:function(e,t){return Ft(e,Ve(t))},each:It,forEach:It,map:Nt,collect:Nt,reduce:P,foldl:P,inject:P,reduceRight:ee,foldr:ee,filter:Ct,select:Ct,reject:function(e,t,r){return Ct(e,Dt(rt(t)),r)},every:jt,all:jt,some:Lt,any:Lt,contains:Ht,includes:Ht,include:Ht,invoke:ne,pluck:Bt,where:function(e,t){return Ct(e,Ve(t))},max:Xt,min:function(e,n,t){var r,o,i=1/0,a=1/0;if(null==n||"number"==typeof n&&"object"!=typeof e[0]&&null!=e)for(var s=0,c=(e=bt(e)?e:Ce(e)).length;s<c;s++)null!=(r=e[s])&&r<i&&(i=r);else n=rt(n,t),It(e,function(e,t,r){((o=n(e,t,r))<a||o===1/0&&i===1/0)&&(i=e,a=o)});return i},shuffle:function(e){return Qt(e,1/0)},sample:Qt,sortBy:function(e,n,t){var o=0;return n=rt(n,t),Bt(Nt(e,function(e,t,r){return{value:e,index:o++,criteria:n(e,t,r)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(n<r||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")},groupBy:k,indexBy:R,countBy:Pe,partition:Re,toArray:function(e){return e?ie(e)?D.call(e):z(e)?e.match(Wt):bt(e)?Nt(e,Ke):Ce(e):[]},size:function(e){return null==e?0:(bt(e)?e:we(e)).length},pick:$t,omit:ke,first:Yt,head:Yt,take:Yt,initial:qt,last:function(e,t,r){return null==e||e.length<1?null==t||r?void 0:[]:null==t||r?e[e.length-1]:Kt(e,Math.max(0,e.length-t))},rest:Kt,tail:Kt,drop:Kt,compact:function(e){return Ct(e,Boolean)},flatten:function(e,t){return Ot(e,t,!1)},without:re,uniq:Zt,unique:Zt,union:Ae,intersection:function(e){for(var t=[],r=arguments.length,n=0,o=Ee(e);n<o;n++){var i=e[n];if(!Ht(t,i)){for(var a=1;a<r&&Ht(arguments[a],i);a++);a===r&&t.push(i)}}return t},difference:Vt,unzip:Jt,transpose:Jt,zip:st,object:function(e,t){for(var r={},n=0,o=Ee(e);n<o;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},range:function(e,t,r){null==t&&(t=e||0,e=0),r=r||(t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),o=Array(n),i=0;i<n;i++,e+=r)o[i]=e;return o},chunk:function(e,t){if(null==t||t<1)return[];for(var r=[],n=0,o=e.length;n<o;)r.push(D.call(e,n,n+=t));return r},mixin:tr,default:Oe}));rr._=rr;const nr=(e,t="")=>{var r=document.createElement("iframe");if(r.style.width="100%",r.style.border="0",r.style.margin="0",r.style.padding="0",r.style.fontSize="100%",r.style.font="inherit",r.style.verticalAlign="baseline",e.innerHTML="",e.appendChild(r),t&&r.contentDocument){let e=r.contentDocument.createElement("style");e.id="azw3-style",e.textContent=t,r.contentDocument.head.appendChild(e)}},or=(r,n)=>{let e=document.getElementById("page-area");if(e){var o=e.getElementsByTagName("iframe")[0];if(o){let t=o.contentDocument;if(t){let e=t.createElement("style");e.id="default-style",e.textContent="p,empty-line{display: inherit;margin-block-start: inherit;margin-block-end: inherit;margin-inline-start: inherit;margin-inline-end: inherit;}body{margin: 0px}",t.head.appendChild(e),"scroll"!==n&&(o="double"===n?2:1,n=(n=Math.floor(r.clientWidth/12))%2==0?n:n-1,t.body.setAttribute("style",`width: auto;height: 100%;overflow-y: hidden;overflow-X: hidden;padding-left: 0px;padding-right: 0px;margin: 0px;box-sizing: border-box;max-width: inherit;column-fill: auto;column-gap: ${n}px;column-count: 12;column-width: ${(r.offsetWidth-n)/o}px;`))}}}};class ir{constructor(e){this.bookStr=e,this.chapterList=[],this.chapterDocList=[]}getChapterDoc(){var t=this.bookStr.split("<address> </address>").filter(e=>""!==e.trim()).map(e=>a(e));let n=[],o=[],r="";for(let e=0;e<t.length;e++)(e=>{let t=s(e);var r=0<t.length;let n=e.getElementsByTagName("p"),o;for(let e=0;e<t.length;e++){var i=o&&g(t[e].innerText)&&m(t[e].innerText);if(t[e].innerText.trim()&&!i){o=t[e];break}}for(let e=0;e<n.length&&(!n[e].innerText.trim()||-1!==n[e].innerHTML.indexOf("<"));e++);var a=o&&30<o.innerText.trim().length,e=50<e.body.innerText.length;return r&&(!a||l(o.innerText.trim()))&&e})((new DOMParser).parseFromString(t[e],"text/html"))?(n.push(r+t[e]),r=""):r+=t[e];0===n.length&&n.push(r);for(let e=0;e<n.length;e++){var i=(new DOMParser).parseFromString(n[e],"text/html");let t=s(i),r;for(let e=0;e<t.length;e++)if(t[e].innerText.trim()&&!g(t[e].innerText)&&!m(t[e].innerText)){r=t[e];break}this.chapterDocList.push({title:r?r.innerText:"",text:n[e]}),r&&o.push(r.innerText)}return this.chapterDocList}getChapter(){for(let e=0;e<this.chapterDocList.length;e++){var t=Math.floor(9e5*Math.random())+1e5;this.chapterDocList[e].title&&this.chapterList.push({title:this.chapterDocList[e].title,id:"title"+t,href:"title"+t,index:e,subitems:[]})}return this.chapterList}}class ar{constructor(e){this.bookStr=e,this.chapterList=[],this.chapterDocList=[],this.bookDoc=(new DOMParser).parseFromString(this.bookStr,"text/html"),this.chapterDomList=[]}getChapter(){this.chapterDomList=s(this.bookDoc),this.insertPageBreak();let e=new ir(this.bookDoc.body.innerHTML);return this.chapterDocList=e.getChapterDoc(),this.chapterList=e.getChapter(),this.chapterList}getDocText(){return this.bookDoc.body.innerText}isContainChapter(){return this.chapterDomList=s(this.bookDoc),0<this.chapterDomList.length}insertPageBreak(){for(let e=0;e<this.chapterDomList.length;e++){var t=document.createElement("address"),r=document.createTextNode(" ");t.appendChild(r),this.chapterDomList[e].parentNode&&this.chapterDomList[e].parentNode.insertBefore(t,this.chapterDomList[e])}}getChapterDoc(){return this.chapterDocList}}var re={S:"万与丑专业丛东丝丢两严丧个丬丰临为丽举么义乌乐乔习乡书买乱争于亏云亘亚产亩亲亵亸亿仅从仑仓仪们价众优伙会伛伞伟传伤伥伦伧伪伫体余佣佥侠侣侥侦侧侨侩侪侬俣俦俨俩俪俭债倾偬偻偾偿傥傧储傩儿兑兖党兰关兴兹养兽冁内冈册写军农冢冯冲决况冻净凄凉凌减凑凛几凤凫凭凯击凼凿刍划刘则刚创删别刬刭刽刿剀剂剐剑剥剧劝办务劢动励劲劳势勋勐勚匀匦匮区医华协单卖卢卤卧卫却卺厂厅历厉压厌厍厕厢厣厦厨厩厮县参叆叇双发变叙叠叶号叹叽吁后吓吕吗吣吨听启吴呒呓呕呖呗员呙呛呜咏咔咙咛咝咤咴咸哌响哑哒哓哔哕哗哙哜哝哟唛唝唠唡唢唣唤唿啧啬啭啮啰啴啸喷喽喾嗫呵嗳嘘嘤嘱噜噼嚣嚯团园囱围囵国图圆圣圹场坂坏块坚坛坜坝坞坟坠垄垅垆垒垦垧垩垫垭垯垱垲垴埘埙埚埝埯堑堕塆墙壮声壳壶壸处备复够头夸夹夺奁奂奋奖奥妆妇妈妩妪妫姗姜娄娅娆娇娈娱娲娴婳婴婵婶媪嫒嫔嫱嬷孙学孪宁宝实宠审宪宫宽宾寝对寻导寿将尔尘尧尴尸尽层屃屉届属屡屦屿岁岂岖岗岘岙岚岛岭岳岽岿峃峄峡峣峤峥峦崂崃崄崭嵘嵚嵛嵝嵴巅巩巯币帅师帏帐帘帜带帧帮帱帻帼幂幞干并广庄庆庐庑库应庙庞废庼廪开异弃张弥弪弯弹强归当录彟彦彻径徕御忆忏忧忾怀态怂怃怄怅怆怜总怼怿恋恳恶恸恹恺恻恼恽悦悫悬悭悯惊惧惨惩惫惬惭惮惯愍愠愤愦愿慑慭憷懑懒懔戆戋戏戗战戬户扎扑扦执扩扪扫扬扰抚抛抟抠抡抢护报担拟拢拣拥拦拧拨择挂挚挛挜挝挞挟挠挡挢挣挤挥挦捞损捡换捣据捻掳掴掷掸掺掼揸揽揿搀搁搂搅携摄摅摆摇摈摊撄撑撵撷撸撺擞攒敌敛数斋斓斗斩断无旧时旷旸昙昼昽显晋晒晓晔晕晖暂暧札术朴机杀杂权条来杨杩杰极构枞枢枣枥枧枨枪枫枭柜柠柽栀栅标栈栉栊栋栌栎栏树栖样栾桊桠桡桢档桤桥桦桧桨桩梦梼梾检棂椁椟椠椤椭楼榄榇榈榉槚槛槟槠横樯樱橥橱橹橼檐檩欢欤欧歼殁殇残殒殓殚殡殴毁毂毕毙毡毵氇气氢氩氲汇汉污汤汹沓沟没沣沤沥沦沧沨沩沪沵泞泪泶泷泸泺泻泼泽泾洁洒洼浃浅浆浇浈浉浊测浍济浏浐浑浒浓浔浕涂涌涛涝涞涟涠涡涢涣涤润涧涨涩淀渊渌渍渎渐渑渔渖渗温游湾湿溃溅溆溇滗滚滞滟滠满滢滤滥滦滨滩滪漤潆潇潋潍潜潴澜濑濒灏灭灯灵灾灿炀炉炖炜炝点炼炽烁烂烃烛烟烦烧烨烩烫烬热焕焖焘煅煳熘爱爷牍牦牵牺犊犟状犷犸犹狈狍狝狞独狭狮狯狰狱狲猃猎猕猡猪猫猬献獭玑玙玚玛玮环现玱玺珉珏珐珑珰珲琎琏琐琼瑶瑷璇璎瓒瓮瓯电画畅畲畴疖疗疟疠疡疬疮疯疱疴痈痉痒痖痨痪痫痴瘅瘆瘗瘘瘪瘫瘾瘿癞癣癫癯皑皱皲盏盐监盖盗盘眍眦眬着睁睐睑瞒瞩矫矶矾矿砀码砖砗砚砜砺砻砾础硁硅硕硖硗硙硚确硷碍碛碜碱碹磙礼祎祢祯祷祸禀禄禅离秃秆种积称秽秾稆税稣稳穑穷窃窍窑窜窝窥窦窭竖竞笃笋笔笕笺笼笾筑筚筛筜筝筹签简箓箦箧箨箩箪箫篑篓篮篱簖籁籴类籼粜粝粤粪粮糁糇紧絷纟纠纡红纣纤纥约级纨纩纪纫纬纭纮纯纰纱纲纳纴纵纶纷纸纹纺纻纼纽纾线绀绁绂练组绅细织终绉绊绋绌绍绎经绐绑绒结绔绕绖绗绘给绚绛络绝绞统绠绡绢绣绤绥绦继绨绩绪绫绬续绮绯绰绱绲绳维绵绶绷绸绹绺绻综绽绾绿缀缁缂缃缄缅缆缇缈缉缊缋缌缍缎缏缐缑缒缓缔缕编缗缘缙缚缛缜缝缞缟缠缡缢缣缤缥缦缧缨缩缪缫缬缭缮缯缰缱缲缳缴缵罂网罗罚罢罴羁羟羡翘翙翚耢耧耸耻聂聋职聍联聩聪肃肠肤肷肾肿胀胁胆胜胧胨胪胫胶脉脍脏脐脑脓脔脚脱脶脸腊腌腘腭腻腼腽腾膑臜舆舣舰舱舻艰艳艹艺节芈芗芜芦苁苇苈苋苌苍苎苏苘苹茎茏茑茔茕茧荆荐荙荚荛荜荞荟荠荡荣荤荥荦荧荨荩荪荫荬荭荮药莅莜莱莲莳莴莶获莸莹莺莼萚萝萤营萦萧萨葱蒇蒉蒋蒌蓝蓟蓠蓣蓥蓦蔷蔹蔺蔼蕲蕴薮藁藓虏虑虚虫虬虮虽虾虿蚀蚁蚂蚕蚝蚬蛊蛎蛏蛮蛰蛱蛲蛳蛴蜕蜗蜡蝇蝈蝉蝎蝼蝾螀螨蟏衅衔补衬衮袄袅袆袜袭袯装裆裈裢裣裤裥褛褴襁襕见观觃规觅视觇览觉觊觋觌觍觎觏觐觑觞触觯詟誉誊讠计订讣认讥讦讧讨让讪讫训议讯记讱讲讳讴讵讶讷许讹论讻讼讽设访诀证诂诃评诅识诇诈诉诊诋诌词诎诏诐译诒诓诔试诖诗诘诙诚诛诜话诞诟诠诡询诣诤该详诧诨诩诪诫诬语诮误诰诱诲诳说诵诶请诸诹诺读诼诽课诿谀谁谂调谄谅谆谇谈谊谋谌谍谎谏谐谑谒谓谔谕谖谗谘谙谚谛谜谝谞谟谠谡谢谣谤谥谦谧谨谩谪谫谬谭谮谯谰谱谲谳谴谵谶谷豮贝贞负贠贡财责贤败账货质贩贪贫贬购贮贯贰贱贲贳贴贵贶贷贸费贺贻贼贽贾贿赀赁赂赃资赅赆赇赈赉赊赋赌赍赎赏赐赑赒赓赔赕赖赗赘赙赚赛赜赝赞赟赠赡赢赣赪赵赶趋趱趸跃跄跖跞践跶跷跸跹跻踊踌踪踬踯蹑蹒蹰蹿躏躜躯车轧轨轩轪轫转轭轮软轰轱轲轳轴轵轶轷轸轹轺轻轼载轾轿辀辁辂较辄辅辆辇辈辉辊辋辌辍辎辏辐辑辒输辔辕辖辗辘辙辚辞辩辫边辽达迁过迈运还这进远违连迟迩迳迹适选逊递逦逻遗遥邓邝邬邮邹邺邻郁郄郏郐郑郓郦郧郸酝酦酱酽酾酿释里鉅鉴銮錾钆钇针钉钊钋钌钍钎钏钐钑钒钓钔钕钖钗钘钙钚钛钝钞钟钠钡钢钣钤钥钦钧钨钩钪钫钬钭钮钯钰钱钲钳钴钵钶钷钸钹钺钻钼钽钾钿铀铁铂铃铄铅铆铈铉铊铋铍铎铏铐铑铒铕铗铘铙铚铛铜铝铞铟铠铡铢铣铤铥铦铧铨铪铫铬铭铮铯铰铱铲铳铴铵银铷铸铹铺铻铼铽链铿销锁锂锃锄锅锆锇锈锉锊锋锌锍锎锏锐锑锒锓锔锕锖锗错锚锜锞锟锠锡锢锣锤锥锦锨锩锫锬锭键锯锰锱锲锳锴锵锶锷锸锹锺锻锼锽锾锿镀镁镂镃镆镇镈镉镊镌镍镎镏镐镑镒镕镖镗镙镚镛镜镝镞镟镠镡镢镣镤镥镦镧镨镩镪镫镬镭镮镯镰镱镲镳镴镶长门闩闪闫闬闭问闯闰闱闲闳间闵闶闷闸闹闺闻闼闽闾闿阀阁阂阃阄阅阆阇阈阉阊阋阌阍阎阏阐阑阒阓阔阕阖阗阘阙阚阛队阳阴阵阶际陆陇陈陉陕陧陨险随隐隶隽难雏雠雳雾霁霉霭靓静靥鞑鞒鞯鞴韦韧韨韩韪韫韬韵页顶顷顸项顺须顼顽顾顿颀颁颂颃预颅领颇颈颉颊颋颌颍颎颏颐频颒颓颔颕颖颗题颙颚颛颜额颞颟颠颡颢颣颤颥颦颧风飏飐飑飒飓飔飕飖飗飘飙飚飞飨餍饤饥饦饧饨饩饪饫饬饭饮饯饰饱饲饳饴饵饶饷饸饹饺饻饼饽饾饿馀馁馂馃馄馅馆馇馈馉馊馋馌馍馎馏馐馑馒馓馔馕马驭驮驯驰驱驲驳驴驵驶驷驸驹驺驻驼驽驾驿骀骁骂骃骄骅骆骇骈骉骊骋验骍骎骏骐骑骒骓骔骕骖骗骘骙骚骛骜骝骞骟骠骡骢骣骤骥骦骧髅髋髌鬓魇魉鱼鱽鱾鱿鲀鲁鲂鲄鲅鲆鲇鲈鲉鲊鲋鲌鲍鲎鲏鲐鲑鲒鲓鲔鲕鲖鲗鲘鲙鲚鲛鲜鲝鲞鲟鲠鲡鲢鲣鲤鲥鲦鲧鲨鲩鲪鲫鲬鲭鲮鲯鲰鲱鲲鲳鲴鲵鲶鲷鲸鲹鲺鲻鲼鲽鲾鲿鳀鳁鳂鳃鳄鳅鳆鳇鳈鳉鳊鳋鳌鳍鳎鳏鳐鳑鳒鳓鳔鳕鳖鳗鳘鳙鳛鳜鳝鳞鳟鳠鳡鳢鳣鸟鸠鸡鸢鸣鸤鸥鸦鸧鸨鸩鸪鸫鸬鸭鸮鸯鸰鸱鸲鸳鸴鸵鸶鸷鸸鸹鸺鸻鸼鸽鸾鸿鹀鹁鹂鹃鹄鹅鹆鹇鹈鹉鹊鹋鹌鹍鹎鹏鹐鹑鹒鹓鹔鹕鹖鹗鹘鹚鹛鹜鹝鹞鹟鹠鹡鹢鹣鹤鹥鹦鹧鹨鹩鹪鹫鹬鹭鹯鹰鹱鹲鹳鹴鹾麦麸黄黉黡黩黪黾鼋鼌鼍鼗鼹齄齐齑齿龀龁龂龃龄龅龆龇龈龉龊龋龌龙龚龛龟志制咨只里系范松没尝尝闹面准钟别闲乾尽脏拼",T:"萬與醜專業叢東絲丟兩嚴喪個爿豐臨為麗舉麽義烏樂喬習鄉書買亂爭於虧雲亙亞產畝親褻亸億僅從侖倉儀們價眾優夥會傴傘偉傳傷倀倫傖偽佇體余傭僉俠侶僥偵側僑儈儕儂俁儔儼倆儷儉債傾傯僂僨償儻儐儲儺兒兌兗黨蘭關興茲養獸囅內岡冊寫軍農冢馮沖決況凍凈淒涼淩減湊凜幾鳳鳧憑凱擊氹鑿芻劃劉則剛創刪別刬剄劊劌剴劑剮劍剝劇勸辦務勱動勵勁勞勢勛猛勚勻匭匱區醫華協單賣盧鹵臥衛卻巹廠廳歷厲壓厭厙廁廂厴廈廚廄廝縣參叆叇雙發變敘叠葉號嘆嘰籲後嚇呂嗎唚噸聽啟吳嘸囈嘔嚦唄員咼嗆嗚詠哢嚨嚀噝咤噅鹹哌響啞噠嘵嗶噦嘩噲嚌噥喲嘜唝嘮唡嗩唣喚唿嘖嗇囀嚙啰啴嘯噴嘍嚳囁呵噯噓嚶囑嚕劈囂謔團園囪圍圇國圖圓聖壙場阪壞塊堅壇壢壩塢墳墜壟壟壚壘墾坰堊墊埡垯垱塏堖塒塤堝墊垵塹墮塆墻壯聲殼壺壸處備復夠頭誇夾奪奩奐奮獎奧妝婦媽嫵嫗媯姍姜婁婭嬈嬌孌娛媧嫻婳嬰嬋嬸媼嬡嬪嬙嬤孫學孿寧寶實寵審憲宮寬賓寢對尋導壽將爾塵堯尷屍盡層屃屜屆屬屢屨嶼歲豈嶇崗峴嶴嵐島嶺嶽崠巋峃嶧峽峣嶠崢巒嶗崍崄嶄嶸嵚崳嶁脊巔鞏巰幣帥師幃帳簾幟帶幀幫幬幘幗冪襆幹並廣莊慶廬廡庫應廟龐廢庼廩開異棄張彌弳彎彈強歸當錄彟彥徹徑徠禦憶懺憂愾懷態慫憮慪悵愴憐總懟懌戀懇惡慟懨愷惻惱惲悅愨懸慳憫驚懼慘懲憊愜慚憚慣湣慍憤憒願懾慭怵懣懶懍戇戔戲戧戰戩戶紮撲扡執擴捫掃揚擾撫拋摶摳掄搶護報擔擬攏揀擁攔擰撥擇掛摯攣挜撾撻挾撓擋撟掙擠揮挦撈損撿換搗據撚擄摑擲撣摻摜摣攬撳攙擱摟攪攜攝攄擺搖擯攤攖撐攆擷擼攛擻攢敵斂數齋斕鬥斬斷無舊時曠旸曇晝昽顯晉曬曉曄暈暉暫曖劄術樸機殺雜權條來楊榪傑極構樅樞棗櫪梘棖槍楓梟櫃檸檉梔柵標棧櫛櫳棟櫨櫟欄樹棲樣欒棬椏橈楨檔榿橋樺檜槳樁夢梼梾檢欞槨櫝槧欏橢樓欖櫬櫚櫸槚檻檳櫧橫檣櫻櫫櫥櫓櫞檐檁歡歟歐殲歿殤殘殞殮殫殯毆毀轂畢斃氈毿氌氣氫氬氳匯漢汙湯洶沓溝沒灃漚瀝淪滄沨溈滬沵濘淚澩瀧瀘濼瀉潑澤涇潔灑窪浹淺漿澆湞浉濁測澮濟瀏浐渾滸濃潯浕塗湧濤澇淶漣潿渦涢渙滌潤澗漲澀澱淵淥漬瀆漸澠漁瀋滲溫遊灣濕潰濺漵溇潷滾滯灩灄滿瀅濾濫灤濱灘滪濫瀠瀟瀲濰潛瀦瀾瀨瀕灝滅燈靈災燦煬爐燉煒熗點煉熾爍爛烴燭煙煩燒燁燴燙燼熱煥燜燾煆糊溜愛爺牘牦牽犧犢犟狀獷獁猶狽麅狝獰獨狹獅獪猙獄猻獫獵獼玀豬貓猬獻獺璣玙玚瑪瑋環現玱璽瑉玨琺瓏珰琿琎璉瑣瓊瑤璦璇瓔瓚甕甌電畫暢畬疇癤療瘧癘瘍癧瘡瘋皰屙癰痙癢瘂癆瘓癇癡癉瘆瘞瘺癟癱癮癭癩癬癲臒皚皺皸盞鹽監蓋盜盤瞘眥眬著睜睞瞼瞞矚矯磯礬礦碭碼磚硨硯碸礪礱礫礎硁矽碩硤磽硙硚確鹼礙磧磣堿碹滾禮祎禰禎禱禍稟祿禪離禿稈種積稱穢秾穭稅穌穩穡窮竊竅窯竄窩窺竇窶豎競篤筍筆筧箋籠籩築篳篩筜箏籌簽簡箓簀篋籜籮簞簫簣簍籃籬籪籟糴類秈糶糲粵糞糧糝糇緊縶糸糾紆紅紂纖紇約級紈纊紀紉緯紜纮純紕紗綱納纴縱綸紛紙紋紡纻纼紐紓線紺紲紱練組紳細織終縐絆紼絀紹繹經紿綁絨結絝繞绖絎繪給絢絳絡絕絞統綆綃絹繡绤綏絳繼綈績緒綾绬續綺緋綽緔緄繩維綿綬繃綢绹綹綣綜綻綰綠綴緇緙緗緘緬纜緹緲緝缊繢緦綞緞緶缐緱縋緩締縷編緡緣縉縛縟縝縫缞縞纏縭縊縑繽縹縵縲纓縮繆繅纈繚繕繒韁繾繰繯繳纘罌網羅罰罷羆羈羥羨翹翙翚耮耬聳恥聶聾職聹聯聵聰肅腸膚膁腎腫脹脅膽勝朧腖臚脛膠脈膾臟臍腦膿臠腳脫腡臉臘腌腘腭膩靦膃騰臏臜輿艤艦艙艫艱艷艹藝節羋薌蕪蘆蓯葦藶莧萇蒼苧蘇檾蘋莖蘢蔦塋煢繭荊薦荙莢蕘蓽蕎薈薺蕩榮葷滎犖熒蕁藎蓀蔭蕒葒葤藥蒞蓧萊蓮蒔萵薟獲蕕瑩鶯蒓萚蘿螢營縈蕭薩蔥蕆蕢蔣蔞藍薊蘺蕷鎣驀薔蘞藺藹蘄蘊藪槁蘚虜慮虛蟲虬蟣雖蝦蠆蝕蟻螞蠶蠔蜆蠱蠣蟶蠻蟄蛺蟯螄蠐蛻蝸蠟蠅蟈蟬蠍螻蠑螀蟎蟏釁銜補襯袞襖裊袆襪襲袯裝襠裈褳襝褲襇褸襤繈襕見觀觃規覓視覘覽覺覬覡覿觍覦覯覲覷觴觸觶詟譽謄訁計訂訃認譏訐訌討讓訕訖訓議訊記讱講諱謳詎訝訥許訛論讻訟諷設訪訣證詁訶評詛識诇詐訴診詆謅詞詘詔诐譯詒誆誄試詿詩詰詼誠誅詵話誕詬詮詭詢詣諍該詳詫諢詡诪誡誣語誚誤誥誘誨誑說誦誒請諸諏諾讀諑誹課諉諛誰諗調諂諒諄誶談誼謀諶諜謊諫諧謔謁謂諤諭諼讒諮諳諺諦謎諞谞謨讜謖謝謠謗謚謙謐謹謾謫譾謬譚譖譙讕譜譎讞譴譫讖谷豮貝貞負贠貢財責賢敗賬貨質販貪貧貶購貯貫貳賤賁貰貼貴貺貸貿費賀貽賊贄賈賄貲賃賂贓資賅贐賕賑賚賒賦賭賫贖賞賜赑赒賡賠賧賴赗贅賻賺賽賾贗贊赟贈贍贏贛赪趙趕趨趲躉躍蹌跖躒踐跶蹺蹕躚躋踴躊蹤躓躑躡蹣躕躥躪躦軀車軋軌軒轪軔轉軛輪軟轟軲軻轤軸軹軼軤軫轢軺輕軾載輊轎辀輇輅較輒輔輛輦輩輝輥輞辌輟輜輳輻輯辒輸轡轅轄輾轆轍轔辭辯辮邊遼達遷過邁運還這進遠違連遲邇逕跡適選遜遞邐邏遺遙鄧鄺鄔郵鄒鄴鄰郁郤郟鄶鄭鄆酈鄖鄲醞酦醬釅釃釀釋裏鉅鑒鑾鏨釓釔針釘釗釙釕釷釬釧釤钑釩釣鍆釹钖釵钘鈣鈈鈦鈍鈔鐘鈉鋇鋼鈑鈐鑰欽鈞鎢鉤鈧鈁鈥鈄鈕鈀鈺錢鉦鉗鈷缽鈳鉕鈽鈸鉞鉆鉬鉭鉀鈿鈾鐵鉑鈴鑠鉛鉚鈰鉉鉈鉍鈹鐸铏銬銠鉺銪鋏鋣鐃铚鐺銅鋁銱銦鎧鍘銖銑鋌銩铦鏵銓鉿銚鉻銘錚銫鉸銥鏟銃鐋銨銀銣鑄鐒鋪铻錸鋱鏈鏗銷鎖鋰鋥鋤鍋鋯鋨銹銼鋝鋒鋅鋶鐦鐧銳銻鋃鋟鋦錒錆鍺錯錨锜錁錕锠錫錮鑼錘錐錦鍁錈錇錟錠鍵鋸錳錙鍥锳鍇鏘鍶鍔鍤鍬鍾鍛鎪锽鍰鎄鍍鎂鏤镃鏌鎮镈鎘鑷鐫鎳鎿鎦鎬鎊鎰镕鏢鏜鏍镚鏞鏡鏑鏃鏇镠鐔鐝鐐鏷鑥鐓鑭鐠鑹鏹鐙鑊鐳镮鐲鐮鐿鑔鑣镴鑲長門閂閃閆闬閉問闖閏闈閑閎間閔閌悶閘鬧閨聞闥閩閭闿閥閣閡閫鬮閱閬阇閾閹閶鬩閿閽閻閼闡闌闃阓闊闋闔闐阘闕闞阛隊陽陰陣階際陸隴陳陘陜隉隕險隨隱隸雋難雛讎靂霧霽黴靄靚靜靨韃鞽韉韝韋韌韨韓韙韞韜韻頁頂頃頇項順須頊頑顧頓頎頒頌頏預顱領頗頸頡頰颋頜潁颎頦頤頻颒頹頷颕穎顆題颙顎顓顏額顳顢顛顙顥颣顫顬顰顴風飏飐颮颯颶飔颼飖飗飄飆飈飛饗饜饤饑饦餳飩餼飪飫飭飯飲餞飾飽飼饳飴餌饒餉饸饹餃饻餅餑饾餓餘餒馂馃餛餡館餷饋馉餿饞馌饃馎餾饈饉饅饊饌饢馬馭馱馴馳驅驲駁驢駔駛駟駙駒騶駐駝駑駕驛駘驍罵骃驕驊駱駭駢骉驪騁驗骍骎駿騏騎騍騅骔骕驂騙騭骙騷騖驁騮騫騸驃騾驄驏驟驥骦驤髏髖髕鬢魘魎魚鱽鱾魷鲀魯魴鲄鮁鮃鮎鱸鲉鲊鮒鲌鮑鱟鲏鮐鮭鮚鲓鮪鮞鲖鲗鲘鲙鱭鮫鮮鲝鯗鱘鯁鱺鰱鰹鯉鰣鰷鯀鯊鯇鲪鯽鲬鯖鯪鲯鯫鯡鯤鯧鯝鯢鯰鯛鯨鲹鯴鯔鱝鰈鲾鲿鳀鳁鳂鰓鱷鰍鰒鰉鳈鳉鯿鰠鰲鰭鰨鰥鰩鳑鳒鰳鰾鱈鱉鰻鰵鱅鳛鱖鱔鱗鱒鳠鳡鱧鳣鳥鳩雞鳶鳴鸤鷗鴉鸧鴇鴆鴣鶇鸕鴨鸮鴦鸰鴟鴝鴛鸴鴕鷥鷙鴯鴰鵂鸻鸼鴿鸞鴻鹀鵓鸝鵑鵠鵝鵒鷴鵜鵡鵲鶓鵪鹍鵯鵬鹐鶉鹒鹓鹔鶘鹖鶚鶻鶿鶥鶩鹝鷂鹟鹠鹡鹢鶼鶴鹥鸚鷓鷚鷯鷦鷲鷸鷺鹯鷹鸌鹲鸛鹴鹺麥麩黃黌黡黷黲黽黿鼌鼉鼗鼴齇齊齏齒齔龁龂齟齡齙齠齜齦齬齪齲齷龍龔龕龜誌制咨只裏系範松沒嘗嘗鬧面準鐘別閑乾盡臟拼"},sr=re.S,cr=re.T;function lr(e,t){var r,n,o,i,a="",s=t?(i=sr,cr):(i=cr,sr);if("string"!=typeof e)return e;for(r=0;r<e.length;r++)n=e.charAt(r),13312<(o=e.charCodeAt(r))&&o<40899||63744<o&&o<64106?a+=-1!==(o=i.indexOf(n))?s.charAt(o):n:a+=n;return a}var dr={s2t:function(e){return lr(e,!0)},t2s:function(e){return lr(e,!1)}};let ur=!1;const fr=(r,n,o,i,a,s,c)=>f(void 0,void 0,void 0,function*(){let e=document.getElementById("page-area");if(e){var t=e.getElementsByTagName("iframe")[0];if(t){let e=t.contentDocument;e&&(t=(t=Math.floor(r.clientWidth/12))%2==0?t:t-1,0<a&&0<e.body.scrollLeft?e.body.scrollBy({top:0,left:-r.offsetWidth-t,behavior:s?"smooth":"auto"}):0<a&&0===e.body.scrollLeft?(pr(r,n,o,i),c("rendered")):a<0&&(((e,t,r,n,o)=>{let i=document.getElementById("page-area");var a,s;i&&(!(a=i.getElementsByTagName("iframe")[0])||(s=a.contentDocument)&&Math.abs(e.scrollHeight-e.scrollTop-e.clientHeight)<10&&Math.abs(s.body.scrollWidth-s.body.scrollLeft-s.body.clientWidth)<10&&(yr(e,t,r,n),o("rendered")))})(r,n,o,i,c),e.body.scrollBy({top:0,left:r.offsetWidth+t,behavior:s?"smooth":"auto"})))}}}),hr=(e,t,r,n)=>{r=r.filter(e=>e.href),t=rr.findLastIndex(r,{index:e,href:t});return"prev"===n?r[t-1]:r[t+1]},pr=(t,r,n,o)=>{var e=c.getKookitConfig("chapterTitle"),i=parseInt(c.getKookitConfig("chapterDocIndex")||"0"),a=c.getKookitConfig("chapterHref")||"";if(0!==i&&e){let e=hr(i,a,r,"prev");c.setKookitConfig("chapterTitle",e.title),c.setKookitConfig("chapterHref",e.href),c.setKookitConfig("chapterDocIndex",e.index.toString()),c.setKookitConfig("text","prevChapter"),gr(e.index,e.title,e.href,n,t,o),e.href&&-1<e.href.indexOf("#")&&mr(t,o,"","",e.href)}},gr=(t=0,r="",n="",o,i,a)=>{let e=document.getElementById("page-area");if(e){var s=e.getElementsByTagName("iframe")[0];if(s){let e=s.contentDocument;e&&(e.body.innerHTML="",e.body.innerHTML=o[t].text,c.setKookitConfig("chapterTitle",r),c.setKookitConfig("chapterHref",n),c.setKookitConfig("chapterDocIndex",t.toString()),c.setKookitConfig("percentage",t/o.length+""),((t,r)=>{let n=document.getElementById("page-area");if(n){let e=n.getElementsByTagName("iframe")[0];var o;e&&("scroll"===r?(o=e.contentDocument)&&(r=o.body,o=o.documentElement,e.height=2*Math.max(r.scrollHeight,r.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight)+"px",setTimeout(()=>{let e=document.getElementById("page-area");if(e){let n=e.getElementsByTagName("iframe")[0];if(n){var o=n.contentDocument;if(o){let e=o.body;var i=e.lastElementChild,a=e.lastChild,s=e.getElementsByTagName("a"),c=e.getElementsByTagName("p"),l=e.getElementsByTagName("img"),d=e.getElementsByTagName("div"),o=s[s.length-1],s=c[c.length-1],l=c[l.length-1],d=d[d.length-1];let t=s||o||l||d;rr.isElement(o)&&rr.isElement(s)&&rr.isElement(d)&&(t=o.clientHeight+o.offsetTop>s.clientHeight+s.offsetTop?o:s,d.clientHeight+d.offsetTop>t.clientHeight+t.offsetTop&&(t=d)),rr.isElement(l)&&l.clientHeight+l.offsetTop>t.clientHeight+t.offsetTop&&(t=l);let r=0;if((i||t||a)&&(3!==a.nodeType||i||t)){if(3===a.nodeType&&document.createRange){let e=document.createRange();e.selectNodeContents(a),!e.getBoundingClientRect||(l=e.getBoundingClientRect())&&(r=l.bottom-l.top)}a=Math.max(rr.isElement(i)?i.clientHeight+i.offsetTop:0,rr.isElement(a)?a.clientHeight+a.offsetTop:0,rr.isElement(t)?t.clientHeight+t.offsetTop:0)+400+(3===a.nodeType?r:0);n.height=a+"px"}}}}},500)):e.height=t.offsetHeight+"px")}})(i,a),((n,o)=>{let e=document.getElementById("page-area");if(e){var i=e.getElementsByTagName("iframe")[0];if(i){let r=i.contentDocument;if(r){var a,i=Math.floor(n.clientWidth/12),s=i%2==0?i:i-1;let e,t;for(a of r.getElementsByTagName("img")){var c=a.parentElement;e=0,t=0,a.width&&a.height?a.height/a.width>c.clientHeight/c.clientWidth?(e=c.clientHeight,t=e*a.width/a.height):(t=c.clientWidth,e=t*a.height/a.width):e=c&&c.clientWidth&&0<c.clientWidth?(t=c.clientWidth,c.clientHeight):(t=n.offsetWidth,n.offsetHeight),t=Math.min("scroll"===o||"single"===o?n.offsetWidth:(n.offsetWidth-s)/2,t),(t||e)&&a.setAttribute("style",`max-width: ${0<t?t:""}px;max-height:${0<e?e:""}px`)}}}}})(i,a))}}},mr=(s,c,l,d,u)=>f(void 0,void 0,void 0,function*(){let e=document.getElementById("page-area");if(e){var o=e.getElementsByTagName("iframe")[0];if(o){let n=o.contentDocument;if(n){let e=Array.from(n.getElementsByTagName("link"));e.forEach(e=>{e.onload=()=>{console.log("finished")}});let t=[];e.forEach(r=>{t.push(new Promise((e,t)=>{r.addEventListener("load",e)}))});var i=yield Promise.all(t);console.log(i);let r=n.body;if(l){let e=h(n.body);var a=e.filter((e,t)=>p(e.innerText)&&(p(e.innerText)===p(l)||p(e.innerText)===dr.t2s(p(l))||p(e.innerText)===dr.s2t(p(l)))&&Math.abs(t-parseInt(d))<2);r=a[0]}else u&&-1<u.indexOf("#")&&(a=u.split("#").reverse()[0],r=n.body.querySelector("#"+a)||n.body);i=r?r.getBoundingClientRect().left:"prevChapter"===l?n.body.scrollWidth:0,o=r?r.getBoundingClientRect().top:0,"scroll"!==c?n.body.scrollTo(i,0):s.scrollTo(0,o)}}}}),Er=(i,a)=>f(void 0,void 0,void 0,function*(){if(!ur){let e=document.getElementById("page-area");if(e){var n=e.getElementsByTagName("iframe")[0];if(n){n=n.contentDocument;if(n){let t=h(n.body);var o=t.filter(e=>wr(i,e,a)&&e.innerText.trim())[0];let r=0;for(let e=0;e<t.length;e++)if(wr(i,t[e],a)&&o&&t[e].innerHTML===o.innerHTML){r=e;break}c.setKookitConfig("text",o&&o.innerText||""),c.setKookitConfig("count",r+""),ur=!0,setTimeout(()=>{ur=!1},100)}}}}}),yr=(e,t,r,n)=>{var o=parseInt(c.getKookitConfig("chapterDocIndex")||"0"),i=c.getKookitConfig("chapterHref")||"";let a=hr(o,i,t,"next");c.setKookitConfig("chapterTitle",a.title),c.setKookitConfig("chapterHref",a.href),c.setKookitConfig("chapterDocIndex",a.index.toString()),c.setKookitConfig("text",""),gr(a.index,a.title,a.href,r,e,n),a.href&&-1<a.href.indexOf("#")&&mr(e,n,"","",a.href)},wr=(e,t,r)=>{var n,o=!1,i=t.getBoundingClientRect();return"scroll"!==r&&t.innerText.trim()?o=-10<(n=i.left)&&n<=e.offsetWidth:t.innerText.trim()?o=(t=i.top)>=e.scrollTop&&t<=e.scrollTop+e.offsetHeight:"scroll"!==r&&(o=0<=(i=i.left)&&i<=e.offsetWidth),o};class br extends class{constructor(){this.callbacks={},this.callbacks.base={}}on(e,t){const r=this;if(void 0===e||""===e)return console.warn("wrong names"),!1;if(void 0===t)return console.warn("wrong callback"),!1;const n=this.resolveNames(e);return n.forEach(function(e){e=r.resolveName(e);r.callbacks[e.namespace]instanceof Object||(r.callbacks[e.namespace]={}),r.callbacks[e.namespace][e.value]instanceof Array||(r.callbacks[e.namespace][e.value]=[]),r.callbacks[e.namespace][e.value].push(t)}),this}off(e){const n=this;if(void 0===e||""===e)return console.warn("wrong name"),!1;const t=this.resolveNames(e);return t.forEach(function(e){var t=n.resolveName(e);if("base"!==t.namespace&&""===t.value)delete n.callbacks[t.namespace];else if("base"===t.namespace)for(const r in n.callbacks)n.callbacks[r]instanceof Object&&n.callbacks[r][t.value]instanceof Array&&(delete n.callbacks[r][t.value],0===Object.keys(n.callbacks[r]).length&&delete n.callbacks[r]);else n.callbacks[t.namespace]instanceof Object&&n.callbacks[t.namespace][t.value]instanceof Array&&(delete n.callbacks[t.namespace][t.value],0===Object.keys(n.callbacks[t.namespace]).length&&delete n.callbacks[t.namespace])}),this}trigger(e,t=[]){if(void 0===e||""===e)return console.warn("wrong name"),!1;const r=this;const n=t instanceof Array?t:[];let o=this.resolveNames(e);o=this.resolveName(o[0]),setTimeout(()=>{if("base"===o.namespace)for(const e in r.callbacks){if(r.callbacks[e]instanceof Object&&r.callbacks[e][o.value]instanceof Array&&r.callbacks[e][o.value])r.callbacks[e][o.value].forEach(function(e){e.apply(r,n)});else if(this.callbacks[o.namespace]instanceof Object&&r.callbacks[o.namespace][o.value]){if(""===o.value)return console.warn("wrong name"),this;r.callbacks[o.namespace][o.value].forEach(function(e){e.apply(r,n)})}return null}},100)}resolveNames(e){let t=e;return t=t.replace(/[^a-zA-Z0-9 ,/.]/g,""),t=t.replace(/[,/]+/g," "),t=t.split(" "),t}resolveName(e){const t={};var r=e.split(".");return t.original=e,t.value=r[0],t.namespace="base",1<r.length&&""!==r[1]&&(t.namespace=r[1]),t}}{constructor(e,t){super(),this.mode=e,this.chapterList=[],this.chapterDocList=[],this.book="",this.element="",this.isSliding=t||!1}getPageSize(){return{width:this.element.clientWidth,height:this.element.clientHeight}}flatChapter(t){let r=[];for(let e=0;e<t.length;e++)t[e].subitems&&0<t[e].subitems.length?(r.push(t[e]),r=r.concat(this.flatChapter(t[e].subitems))):r.push(t[e]);return r}getChapter(){return this.chapterList}goToChapter(e,t,r){return f(this,void 0,void 0,function*(){gr(parseInt(e),r,t,this.chapterDocList,this.element,this.mode),t&&-1<t.indexOf("#")&&(yield mr(this.element,this.mode,"","",t)),this.record(),this.trigger("rendered")})}goToPosition(i){return f(this,void 0,void 0,function*(){var{text:e,chapterDocIndex:t,chapterTitle:r,chapterHref:n,count:o}=JSON.parse(i);gr(t,r,n,this.chapterDocList,this.element,this.mode),yield mr(this.element,this.mode,e,o,""),this.record(),this.trigger("rendered")})}removeContent(){this.element.innerHTML=""}prev(){this.trigger("page-changed");let e=document.getElementById("page-area");var t;e&&(!(t=e.getElementsByTagName("iframe")[0])||(t=t.contentDocument)&&("scroll"===this.mode||0===t.body.scrollLeft?(pr(this.element,this.flatChapter(this.chapterList),this.chapterDocList,this.mode),this.trigger("rendered")):fr(this.element,this.flatChapter(this.chapterList),this.chapterDocList,this.mode,1,this.isSliding,this.trigger),Er(this.element,this.mode)))}next(){this.trigger("page-changed");let e=document.getElementById("page-area");var t;e&&(!(t=e.getElementsByTagName("iframe")[0])||(t=t.contentDocument)&&(Math.abs(t.body.scrollWidth-t.body.scrollLeft-t.body.clientWidth)<10||"scroll"===this.mode?(yr(this.element,this.flatChapter(this.chapterList),this.chapterDocList,this.mode),this.trigger("rendered")):fr(this.element,this.flatChapter(this.chapterList),this.chapterDocList,this.mode,-1,this.isSliding,this.trigger),Er(this.element,this.mode)))}prevChapter(){this.trigger("page-changed");let e=document.getElementById("page-area");var t;!e||(t=e.getElementsByTagName("iframe")[0])&&t.contentDocument&&(pr(this.element,this.flatChapter(this.chapterList),this.chapterDocList,this.mode),this.record(),this.trigger("rendered"))}nextChapter(){this.trigger("page-changed");let e=document.getElementById("page-area");var t;!e||(t=e.getElementsByTagName("iframe")[0])&&t.contentDocument&&(yr(this.element,this.flatChapter(this.chapterList),this.chapterDocList,this.mode),this.record(),this.trigger("rendered"))}visibleText(){return((r,n)=>{let e=document.getElementById("page-area");if(e){var o=e.getElementsByTagName("iframe")[0];if(o){o=o.contentDocument;if(o){let e=h(o.body),t=e.filter(e=>wr(r,e,n)&&e.innerText.trim());return("scroll"!==n?t:e).map(e=>e.innerText).join(" ")}}}})(this.element,this.mode)}doSearch(e){return((n,o)=>{let i=[];for(let r=0;r<o.length;r++){var e=(new DOMParser).parseFromString(o[r].text,"text/html");let t=h(e.body);for(let e=0;e<t.length;e++)-1<t[e].innerText.indexOf(n)&&i.push({excerpt:t[e].innerText,cfi:JSON.stringify({text:t[e].innerText,chapterTitle:o[r].title,chapterDocIndex:r,chapterHref:o[r].href,count:e,percentage:r/o.length})})}return i})(e,this.chapterDocList)}getProgress(){return(()=>{let e=document.getElementById("page-area");if(e){var t=e.getElementsByTagName("iframe")[0];if(t){t=t.contentDocument;if(t)return{totalPage:parseInt(t.body.scrollWidth/t.body.clientWidth+"")+1,currentPage:parseInt(t.body.scrollLeft/t.body.clientWidth+"")+1}}}})()}record(){Er(this.element,this.mode)}getPosition(){return{text:c.getKookitConfig("text"),chapterTitle:c.getKookitConfig("chapterTitle"),chapterDocIndex:c.getKookitConfig("chapterDocIndex"),chapterHref:c.getKookitConfig("chapterHref"),count:c.getKookitConfig("count"),percentage:c.getKookitConfig("percentage")}}setStyle(t){let e=document.getElementById("page-area");if(e){var r=e.getElementsByTagName("iframe")[0];if(r){let e=r.contentDocument;e&&e.body.setAttribute("style",t+e.body.getAttribute("style"))}}}}class Or{constructor(e){this.book=e,this.chapterList=[],this.flattenChapters=[],this.chapterDocList=[]}getChapter(e){return f(this,void 0,void 0,function*(){return this.chapterList=e?yield Promise.all(e.map(t=>f(this,void 0,void 0,function*(){var e=t.href&&(yield this.book.resolveHref(t.href))?(yield this.book.resolveHref(t.href)).index:-1;return{title:t.label||"Content",href:t.href,index:e,subitems:t.subitems?yield this.getChapter(t.subitems):[]}}))):yield Promise.all(this.book.sections.filter(e=>e.load).map((e,t)=>f(this,void 0,void 0,function*(){return{title:e.label||"Content",href:e.href||"",index:t,subitems:e.subitems?yield this.getChapter(e.subitems):[]}}))),this.flattenChapters=this.flatChapter(this.chapterList),this.chapterList})}getChapterDoc(){return f(this,void 0,void 0,function*(){let e=yield Promise.all(this.book.sections.filter(e=>e.load).map(e=>f(this,void 0,void 0,function*(){return e.load?(yield fetch(yield e.load()).then(e=>e.blob())).text():""})));const r=this.flattenChapters.map(e=>e.index);return e.map(e=>a(e)).map((e,t)=>-1<r.indexOf(t)?{title:this.flattenChapters[r.indexOf(t)].title,href:this.flattenChapters[r.indexOf(t)].href,text:e}:{title:"",href:"",text:e})})}flatChapter(t){let r=[];for(let e=0;e<t.length;e++)t[e].subitems&&0<t[e].subitems.length?(r.push(t[e]),r=r.concat(this.flatChapter(t[e].subitems))):r.push(t[e]);return r}getMetadata(){return new Promise((n,e)=>f(this,void 0,void 0,function*(){const t=this.book.metadata;try{var e=yield this.book.getCover(),r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{n({name:t.title,author:t.author[0].name,description:t.description,publisher:t.publisher,cover:r.result})}}catch(e){n({name:t.title,author:t.author[0].name||t.author[0],description:t.description,publisher:t.publisher,cover:""})}}))}}const Tr=(e,n)=>e.map((e,t,r)=>n(e,t,r)?t:null).filter(e=>null!=e),vr=(n,e)=>[-1,...e,n.length].reduce(({xs:e,a:t},r)=>({xs:e?.concat([n.slice(t+1,r)])??[],a:r}),{}).xs,_r=(e,t)=>e.slice(0,-1).concat([e[e.length-1].concat(t[0])]).concat(t.slice(1)),Dr=/\d/,Sr=/^epubcfi\((.*)\)$/,Mr=e=>e.replace(/[\^[\](),;=]/g,"^$&"),Rr=e=>Sr.test(e)?e:`epubcfi(${e})`,Pr=(e,t)=>Tr(e,([e])=>e===t),kr=e=>{const t=[];let r;for(var[n,o]of e){if("/"===n)t.push({index:o});else{const i=t[t.length-1];if(":"===n)i.offset=o;else if("~"===n)i.temporal=o;else if("@"===n)i.spatial=(i.spatial??[]).concat(o);else if(";s"===n)i.side=o;else if("["===n){if("/"!==r||!o){i.text=(i.text??[]).concat(o);continue}i.id=o}}r=n}return t},xr=e=>vr(e,Pr(e,"!")).map(kr),Ar=e=>{var t=(e=>{const t=[];let r,n,o="";var i=e=>(t.push(e),r=null,o=""),a=e=>(o+=e,n=!1);for(const s of Array.from(e.trim()).concat(""))if("^"!==s||n){if("!"===r)i(["!"]);else if(","===r)i([","]);else if("/"===r||":"===r){if(Dr.test(s)){a(s);continue}i([r,parseInt(o)])}else if("~"===r){if(Dr.test(s)||"."===s){a(s);continue}i(["~",parseFloat(o)])}else if("@"===r){if(":"===s){i(["@",parseFloat(o)]),r="@";continue}if(Dr.test(s)||"."===s){a(s);continue}i(["@",parseFloat(o)])}else{if("["===r){";"!==s||n?","!==s||n?"]"!==s||n?a(s):i(["[",o]):(i(["[",o]),r="["):(i(["[",o]),r=";");continue}if(r?.startsWith(";")){"="!==s||n?";"!==s||n?"]"!==s||n?a(s):i([r,o]):(i([r,o]),r=";"):(r=`;${o}`,o="");continue}}"/"!==s&&":"!==s&&"~"!==s&&"@"!==s&&"["!==s&&"!"!==s&&","!==s||(r=s)}else n=!0;return t})((r=e).match(Sr)?.[1]??r),e=Pr(t,",");if(!e.length)return xr(t);var[r,t,e]=vr(t,e).map(xr);return{parent:r,start:t,end:e}},Fr=({index:e,id:t,offset:r,temporal:n,spatial:o,text:i,side:a})=>{var s=a?`;s=${a}`:"";return`/${e}`+(t?`[${Mr(t)}${s}]`:"")+(null!=r&&e%2?`:${r}`:"")+(n?`~${n}`:"")+(o?`@${o.join(":")}`:"")+(i||!t&&a?"["+(i?.map(Mr)?.join(",")??"")+s+"]":"")},Ir=e=>e.parent?[e.parent,e.start,e.end].map(Ir).join(","):e.map(e=>e.map(Fr).join("")).join("!"),Nr=e=>Rr(Ir(e)),Ur=(e,t)=>"string"==typeof e?Nr(Ur(Ar(e),t)):e.parent?_r(e.parent,e[t?"end":"start"]):e,Cr=({nodeType:e})=>3===e||4===e,jr=({nodeType:e})=>1===e,Lr=e=>{const t=Array.from(e.childNodes).filter(e=>Cr(e)||jr(e)).reduce((e,t)=>{let r=e[e.length-1];return r?Cr(t)?Array.isArray(r)?r.push(t):Cr(r)?e[e.length-1]=[r,t]:e.push(t):jr(r)?e.push(null,t):e.push(t):e.push(t),e},[]);return jr(t[0])&&t.unshift("first"),jr(t[t.length-1])&&t.push("last"),t.unshift("before"),t.push("after"),t},Hr=(e,t)=>e?Lr(e)[t]:null,Br=(e,t)=>{var r,n=t[t.length-1]["id"];if(n){n=e.ownerDocument.getElementById(n);if(n)return{node:n,offset:0}}for({index:r}of t){var o=Hr(e,r);if("first"===o)return{node:e.firstChild??e};if("last"===o)return{node:e.lastChild??e};if("before"===o)return{node:e,before:!0};if("after"===o)return{node:e,after:!0};e=o}var i=t[t.length-1]["offset"];if(!Array.isArray(e))return{node:e,offset:i};let a=0;for(const c of e){var s=c.nodeValue["length"];if(a+s>=i)return{node:c,offset:i-a};a+=s}},Xr=(t,r)=>{var{parentNode:e,id:n}=t;const o=Lr(e);var i=o.findIndex(e=>Array.isArray(e)?e.some(e=>e===t):e===t),a=o[i];if(Array.isArray(a)){let e=0;for(const s of a){if(s===t){e+=r;break}e+=s.nodeValue.length}r=e}i={id:n,index:i,offset:r};return e!==t.ownerDocument.documentElement?Xr(e).concat(i):[i]},Qr=(e,t)=>Br(e.documentElement,Ur(t)).node,zr={CONTAINER:"urn:oasis:names:tc:opendocument:xmlns:container",XHTML:"http://www.w3.org/1999/xhtml",OPF:"http://www.idpf.org/2007/opf",EPUB:"http://www.idpf.org/2007/ops",DC:"http://purl.org/dc/elements/1.1/",DCTERMS:"http://purl.org/dc/terms/",ENC:"http://www.w3.org/2001/04/xmlenc#",NCX:"http://www.daisy.org/z3986/2005/ncx/",XLINK:"http://www.w3.org/1999/xlink",SMIL:"http://www.w3.org/ns/SMIL"},Wr={XML:"application/xml",NCX:"application/x-dtbncx+xml",XHTML:"application/xhtml+xml",HTML:"text/html",CSS:"text/css",SVG:"image/svg+xml",JS:/\/(x-)?(javascript|ecmascript)/},Gr=e=>e.toLowerCase().replace(/[-:](.)/g,(e,t)=>t.toUpperCase()),$r=e=>e?e.trim().replace(/\s{2,}/g," "):"",qr=(t,r,e)=>e?e=>e.getAttribute(t)?.split(/\s/)?.includes(r):"function"==typeof r?e=>r(e.getAttribute(t)):e=>e.getAttribute(t)===r,Yr=(...e)=>t=>t?Object.fromEntries(e.map(e=>[Gr(e),t.getAttribute(e)])):null,Kr=e=>$r(e?.textContent),Vr=(e,r)=>{e=e.lookupNamespaceURI(null)===r||e.lookupPrefix(r);const n=e?(e,t)=>e=>e.namespaceURI===r&&e.localName===t:(e,t)=>e=>e.localName===t;return{$:(e,t)=>[...e.children].find(n(e,t)),$$:(e,t)=>[...e.children].filter(n(e,t)),$$$:e?(e,t)=>[...e.getElementsByTagNameNS(r,t)]:(e,t)=>[...e.getElementsByTagName(r,t)]}},Zr=(t,e)=>{try{if(e.includes(":"))return new URL(t,e);var r="whatever:///";return decodeURI(new URL(t,r+e).href.replace(r,""))}catch(e){return console.warn(e),t}},Jr=e=>/^(?!blob)\w+:/i.test(e),en=async(e,t,r)=>{const n=[];e.replace(t,(...e)=>(n.push(e),null));const o=[];for(const i of n)o.push(await r(...i));return e.replace(t,()=>o.shift())},tn=e=>e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");Ae={attrs:["dir","xml:lang"]},st={name:"alternate-script",many:!0,...Ae,props:["file-as"]},re={many:!0,...Ae,props:[{name:"role",many:!0,attrs:["scheme"]},"file-as",st]};const rn=[{name:"title",many:!0,...Ae,props:["title-type","display-seq","file-as",st]},{name:"identifier",many:!0,props:[{name:"identifier-type",attrs:["scheme"]}]},{name:"language",many:!0},{name:"creator",...re},{name:"contributor",...re},{name:"publisher",...Ae,props:["file-as",st]},{name:"description",...Ae,props:[st]},{name:"rights",...Ae,props:[st]},{name:"date"},{name:"dcterms:modified",type:"meta"},{name:"subject",many:!0,...Ae,props:["term","authority",st]},{name:"belongs-to-collection",type:"meta",many:!0,...Ae,props:["collection-type","group-position","dcterms:identifier","file-as",st,{name:"belongs-to-collection",recursive:!0}]}],nn=(e,i=e=>e)=>{const{$:a,$$:r,$$$:t}=Vr(e,zr.XHTML),n=o=>e=>{const t=a(e,"a")??a(e,"span");var r=a(e,"ol"),e=(e=t?.getAttribute("href"))?decodeURI(i(e)):null;const n={label:Kr(t)||t?.getAttribute("title"),href:e,subitems:s(r)};return o&&(n.type=t?.getAttributeNS(zr.EPUB,"type")?.split(/\s/)),n},s=(e,t)=>e?r(e,"li").map(n(t)):null;var o=(e,t)=>s(a(e,"ol"),t);let c=null,l=null,d=null,u=[];for(const f of t(e,"nav")){const h=f.getAttributeNS(zr.EPUB,"type")?.split(/\s/)??[];h.includes("toc")?c??=o(f):h.includes("page-list")?l??=o(f):h.includes("landmarks")?d??=o(f,!0):u.push({label:Kr(f.firstElementChild),type:h,list:o(f)})}return{toc:c,pageList:l,landmarks:d,others:u}},on=(r,i=e=>e)=>{const{$:a,$$:s}=Vr(r,zr.NCX),c=e=>{var t=a(e,"navLabel");const r=a(e,"content");var n=Kr(t),t=(t=r.getAttribute("src"))?decodeURI(i(t)):null;if("navPoint"!==e.localName)return{label:n,href:t};{const o=s(e,"navPoint");return{label:n,href:t,subitems:o.length?o.map(c):null}}},n=(e,t)=>s(e,t).map(c);var e=(e,t)=>{e=a(r.documentElement,e);return e?n(e,t):null};return{toc:e("navMap","navPoint"),pageList:e("pageList","pageTarget"),others:s(r.documentElement,"navList").map(e=>({label:Kr(a(e,"navLabel")),list:n(e,"navTarget")}))}},an=e=>{if(e){var t=e.split(":").map(e=>parseFloat(e));if(3===t.length){var[r,n,o]=t;return 60*r*60+60*n+o}if(2===t.length){var[t,i]=t;return 60*t+i}var[i,e]=e.split(/(?=[^\d.])/);return parseFloat(i)*("h"===e?3600:"min"===e?60:"ms"===e?.001:1)}},sn=(e,n=e=>e)=>{const{$:o,$$$:t}=Vr(e,zr.SMIL);return t(e,"par").map(e=>{var t=o(e,"text")?.getAttribute("src")?.split("#")?.[1];const r=o(e,"audio");return r?{id:t,audio:{src:(e=r.getAttribute("src"))?decodeURI(n(e)):null,clipBegin:an(r.getAttribute("clipBegin")),clipEnd:an(r.getAttribute("clipEnd"))}}:{id:t}})},cn=/([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})/,ln=e=>Kr(e.getElementById(e.documentElement.getAttribute("unique-identifier"))??e.getElementsByTagNameNS(zr.DC,"identifier")[0]),dn=async(e,t,r)=>{const n=new Uint8Array(await r.slice(0,t).arrayBuffer());t=Math.min(t,n.length);for(var o=0;o<t;o++)n[o]=n[o]^e[o%e.length];return new Blob([n,r.slice(t)],{type:r.type})},un=(t=async e=>{e=(new TextEncoder).encode(e),e=await globalThis.crypto.subtle.digest("SHA-1",e);return new Uint8Array(e)})=>({"http://www.idpf.org/2008/embedding":{key:e=>t(ln(e).replaceAll(/[\u0020\u0009\u000d\u000a]/g,"")),decode:(e,t)=>dn(e,1040,t)},"http://ns.adobe.com/pdf/enc#RC":{key:e=>{const r=(e=>{for(const r of e.getElementsByTagNameNS(zr.DC,"identifier")){var[t]=Kr(r).split(":").slice(-1);if(cn.test(t))return t}return""})(e).replaceAll("-","");return Uint8Array.from({length:16},(e,t)=>parseInt(r.slice(2*t,2*t+2),16))},decode:(e,t)=>dn(e,1024,t)}});class fn{#uris=new Map;#decoders=new Map;#algorithms;constructor(e){this.#algorithms=e}async init(e,t){var r,n;if(e)for({algorithm:r,uri:n}of Array.from(e.getElementsByTagNameNS(zr.ENC,"EncryptedData"),e=>({algorithm:e.getElementsByTagNameNS(zr.ENC,"EncryptionMethod")[0]?.getAttribute("Algorithm"),uri:e.getElementsByTagNameNS(zr.ENC,"CipherReference")[0]?.getAttribute("URI")}))){if(!this.#decoders.has(r)){const o=this.#algorithms[r];if(!o){console.warn("Unknown encryption algorithm");continue}const i=await o.key(t);this.#decoders.set(r,e=>o.decode(i,e))}this.#uris.set(n,r)}}getDecoder(e){return this.#decoders.get(this.#uris.get(e))??(e=>e)}}class hn{constructor({opf:e,resolveHref:n}){this.opf=e;const{$:t,$$:r,$$$:o}=Vr(e,zr.OPF);var i=t(e.documentElement,"manifest");const a=t(e.documentElement,"spine"),s=r(a,"itemref");this.manifest=r(i,"item").map(Yr("href","id","media-type","properties","media-overlay")).map(e=>(e.href=n(e.href),e.properties=e.properties?.split(/\s/),e)),this.spine=s.map(Yr("idref","id","linear","properties")).map(e=>(e.properties=e.properties?.split(/\s/),e)),this.pageProgressionDirection=a.getAttribute("page-progression-direction"),this.navPath=this.getItemByProperty("nav")?.href,this.ncxPath=(this.getItemByID(a.getAttribute("toc"))??this.manifest.find(e=>e.mediaType===Wr.NCX))?.href;i=t(e.documentElement,"guide");i&&(this.guide=r(i,"reference").map(Yr("type","title","href")).map(({type:e,title:t,href:r})=>({label:t,type:e.split(/\s/),href:n(r)}))),this.cover=this.getItemByProperty("cover-image")??this.getItemByID(o(e,"meta").find(qr("name","cover"))?.getAttribute("content"))??this.getItemByHref(this.guide?.find(e=>e.type.includes("cover"))?.href),this.cfis=(e=>{const t=[];var r,n,o=e[0]["parentNode"];const i=Xr(o);for([r,n]of Lr(o).entries()){var a=e[t.length];n===a&&t.push(Nr([i.concat({id:a.id,index:r})]))}return t})(s)}getItemByID(t){return this.manifest.find(e=>e.id===t)}getItemByHref(t){return this.manifest.find(e=>e.href===t)}getItemByProperty(t){return this.manifest.find(e=>e.properties?.includes(t))}resolveCFI(e){const t=Ar(e),r=(t.parent??t).shift();let n=Qr(this.opf,r);n&&"idref"!==n.nodeName&&(r.at(-1).id=null,n=Qr(this.opf,r));const o=n?.getAttribute("idref");return{index:this.spine.findIndex(e=>e.idref===o),anchor:e=>((e,t)=>{var r=Ur(t),n=Ur(t,!0),t=e.documentElement,r=Br(t,r[0]),n=Br(t,n[0]);const o=e.createRange();return r.before?o.setStartBefore(r.node):r.after?o.setStartAfter(r.node):o.setStart(r.node,r.offset),n.before?o.setEndBefore(n.node):n.after?o.setEndAfter(n.node):o.setEnd(n.node,n.offset),o})(e,t)}}}class pn{#cache=new Map;#children=new Map;#refCount=new Map;allowScript=!1;constructor({loadText:e,loadBlob:t,resources:r}){this.loadText=e,this.loadBlob=t,this.manifest=r.manifest,this.assets=r.manifest}createURL(e,t,r,n){if(!t)return"";r=URL.createObjectURL(new Blob([t],{type:r}));if(this.#cache.set(e,r),this.#refCount.set(e,1),n){const o=this.#children.get(n);o?o.push(e):this.#children.set(n,[e])}return r}ref(e,t){const r=this.#children.get(t);return r?.includes(e)||(this.#refCount.set(e,this.#refCount.get(e)+1),r?r.push(e):this.#children.set(t,[e])),this.#cache.get(e)}unref(e){if(this.#refCount.has(e)){var t=this.#refCount.get(e)-1;if(t<1){URL.revokeObjectURL(this.#cache.get(e)),this.#cache.delete(e),this.#refCount.delete(e);const r=this.#children.get(e);if(r)for(;r.length;)this.unref(r.pop());this.#children.delete(e)}else this.#refCount.set(e,t)}}async loadItem(e,t=[]){if(!e)return null;const{href:r,mediaType:n}=e;var o=Wr.JS.test(e.mediaType);if(o&&!this.allowScript)return null;var i=t.at(-1);return this.#cache.has(r)?this.ref(r,i):(o||[Wr.XHTML,Wr.HTML,Wr.CSS,Wr.SVG].includes(n))&&t.every(e=>e!==r)?this.loadReplaced(e,t):this.createURL(r,await this.loadBlob(r),n,i)}async loadHref(e,t,r=[]){if(Jr(e))return e;const n=Zr(e,t);var o=this.manifest.find(e=>e.href===n);return o?this.loadItem(o,r.concat(t)):e}async loadReplaced(e,o=[]){const{href:i,mediaType:r}=e;var n,a=o.at(-1),s=await this.loadText(i);if(!s)return null;if([Wr.XHTML,Wr.HTML,Wr.SVG].includes(r)){let t=(new DOMParser).parseFromString(s,r);if(r===Wr.XHTML&&t.querySelector("parsererror")&&(e.mediaType=Wr.HTML,t=(new DOMParser).parseFromString(s,e.mediaType)),[Wr.XHTML,Wr.SVG].includes(e.mediaType)){let e=t.firstChild;for(;e instanceof ProcessingInstruction;)e.data&&(n=await en(e.data,/(?:^|\s*)(href\s*=\s*['"])([^'"]*)(['"])/i,(e,t,r,n)=>this.loadHref(r,i,o).then(e=>`${t}${e}${n}`)),e.replaceWith(t.createProcessingInstruction(e.target,n))),e=e.nextSibling}var c=async(e,t)=>e.setAttribute(t,await this.loadHref(e.getAttribute(t),i,o));for(const d of t.querySelectorAll("link[href]"))await c(d,"href");for(const u of t.querySelectorAll("[src]"))await c(u,"src");for(const f of t.querySelectorAll("[poster]"))await c(f,"poster");for(const h of t.querySelectorAll("object[data]"))await c(h,"data");for(const p of t.querySelectorAll("[*|href]:not([href]"))p.setAttributeNS(zr.XLINK,"href",await this.loadHref(p.getAttributeNS(zr.XLINK,"href"),i,o));for(const g of t.querySelectorAll("style"))g.textContent&&(g.textContent=await this.replaceCSS(g.textContent,i,o));for(const m of t.querySelectorAll("[style]"))m.setAttribute("style",await this.replaceCSS(m.getAttribute("style"),i,o));const l=(new XMLSerializer).serializeToString(t);return this.createURL(i,l,e.mediaType,a)}const l=r===Wr.CSS?await this.replaceCSS(s,i,o):await this.replaceString(s,i,o);return this.createURL(i,l,r,a)}async replaceCSS(e,r,n=[]){e=await en(e,/url\(\s*["']?([^'"\n]*?)\s*["']?\s*\)/gi,(e,t)=>this.loadHref(t,r,n).then(e=>`url("${e}")`));const t=await en(e,/@import\s*["']([^"'\n]*?)["']/gi,(e,t)=>this.loadHref(t,r,n).then(e=>`@import "${e}"`)),o=window?.innerWidth??800,i=window?.innerHeight??600,a=t.replace(/(\d*\.?\d+)vw/g,(e,t)=>parseFloat(t)*o/100+"px").replace(/(\d*\.?\d+)vh/g,(e,t)=>parseFloat(t)*i/100+"px");return a.replaceAll("-epub-","")}replaceString(e,a,t=[]){const s=new Map,r=this.assets.map(e=>{if(e.href!==a){var t=((e,t)=>{if(!e)return t;const r=e.replace(/\/$/,"").split("/"),n=t.replace(/\/$/,"").split("/");t=(r.length>n.length?r:n).findIndex((e,t)=>r[t]!==n[t]);return t<0?"":Array(r.length-t).fill("..").concat(n.slice(t)).join("/")})(a.slice(0,a.lastIndexOf("/")+1),e.href),r=encodeURI(t),n="/"+e.href,o=encodeURI(n),o=new Set([t,r,n,o]);for(const i of o)s.set(i,e);return Array.from(o)}}).flat().filter(e=>e);if(!r.length)return e;var n=new RegExp(r.map(tn).join("|"),"g");return en(e,n,async e=>this.loadItem(s.get(e.replace(/^\//,"")),t.concat(a)))}unloadItem(e){this.unref(e?.href)}}class gn{parser=new DOMParser;#encryption;constructor({loadText:e,loadBlob:t,getSize:r,sha1:n}){this.loadText=e,this.loadBlob=t,this.getSize=r,this.#encryption=new fn(un(n))}#parseXML(e){return e?this.parser.parseFromString(e,Wr.XML):null}async#loadXML(e){return this.#parseXML(await this.loadText(e))}async init(){const e=await this.#loadXML("META-INF/container.xml");if(!e)throw new Error("Failed to load container file");var t=Array.from(e.getElementsByTagNameNS(zr.CONTAINER,"rootfile"),Yr("full-path","media-type")).filter(e=>"application/oebps-package+xml"===e.mediaType);if(!t.length)throw new Error("No package document defined in container");const r=t[0].fullPath;var n=await this.#loadXML(r);if(!n)throw new Error("Failed to load package document");t=await this.#loadXML("META-INF/encryption.xml");await this.#encryption.init(t,n),this.resources=new hn({opf:n,resolveHref:e=>Zr(e,r)});const i=new pn({loadText:this.loadText,loadBlob:e=>Promise.resolve(this.loadBlob(e)).then(this.#encryption.getDecoder(e)),resources:this.resources});this.sections=this.resources.spine.map((e,t)=>{var{idref:r,linear:n,properties:e=[]}=e;const o=this.resources.getItemByID(r);return o?{id:this.resources.getItemByID(r)?.href,load:()=>i.loadItem(o),unload:()=>i.unloadItem(o),createDocument:()=>this.loadDocument(o),size:this.getSize(o.href),cfi:this.resources.cfis[t],linear:n,pageSpread:(e=>{for(const t of e){if("page-spread-left"===t||"rendition:page-spread-left"===t)return"left";if("page-spread-right"===t||"rendition:page-spread-right"===t)return"right";if("rendition:page-spread-center"===t)return"center"}})(e),resolveHref:e=>Zr(e,o.href),loadMediaOverlay:()=>this.loadMediaOverlay(o)}:(console.warn(`Could not find item with ID "${r}" in manifest`),null)}).filter(e=>e);const{navPath:o,ncxPath:a}=this.resources;if(o)try{var s=nn(await this.#loadXML(o),e=>Zr(e,o));this.toc=s.toc,this.pageList=s.pageList,this.landmarks=s.landmarks}catch(e){console.warn(e)}if(!this.toc&&a)try{var c=on(await this.#loadXML(a),e=>Zr(e,a));this.toc=c.toc,this.pageList=c.pageList}catch(e){console.warn(e)}this.landmarks??=this.resources.guide;const{metadata:l,rendition:d,media:u}=(e=>{const{$:t,$$:r}=Vr(e,zr.OPF),n=t(e.documentElement,"metadata"),i=Array.from(n.children),c=(a,t)=>{if(!t)return null;const{props:e=[],attrs:r=[]}=a,n=Kr(t);if(!e.length&&!r.length)return n;var o=t.getAttribute("id");const s=o?i.filter(qr("refines","#"+o)):[];return Object.fromEntries([["value",n]].concat(e.map(e=>{var{many:t,recursive:r}=e,n="string"==typeof e?e:e.name,o=qr("property",n);const i=r?a:e;return[Gr(n),t?s.filter(o).map(e=>c(i,e)):c(i,s.find(o))]})).concat(r.map(e=>[Gr(e),t.getAttribute(e)])))},a=i.filter(qr("refines",null));e=t=>Object.fromEntries(r(n,"meta").filter(qr("property",e=>e?.startsWith(t))).map(e=>[e.getAttribute("property").replace(t,""),Kr(e)]));return{metadata:Object.fromEntries(rn.map(t=>{const{type:e,name:r,many:n}=t;var o="meta"===e?e=>e.namespaceURI===zr.OPF&&e.getAttribute("property")===r:e=>e.namespaceURI===zr.DC&&e.localName===r;return[Gr(r),n?a.filter(o).map(e=>c(t,e)):c(t,a.find(o))]})),rendition:e("rendition:"),media:e("media:")}})(n);this.rendition=d,this.media=u,u.duration=an(u.duration),this.dir=this.resources.pageProgressionDirection,this.rawMetadata=l;c=l?.title?.[0];this.metadata={title:c?.value,sortAs:c?.fileAs,language:l?.language,identifier:ln(n),description:l?.description?.value,publisher:l?.publisher?.value,published:l?.date,modified:l?.dctermsModified,subject:l?.subject?.filter(({value:e,code:t})=>e||t)?.map(({value:e,code:t,scheme:r})=>({name:e,code:t,scheme:r})),rights:l?.rights?.value};const f={art:"artist",aut:"author",bkp:"producer",clr:"colorist",edt:"editor",ill:"illustrator",trl:"translator",pbl:"publisher"};n=r=>e=>{var t=[...new Set(e.role?.map(({value:e,scheme:t})=>(t&&"marc:relators"!==t?null:f[e])??r))],e={name:e.value,sortAs:e.fileAs};return[t.length?t:[r],e]};return l?.creator?.map(n("author"))?.concat(l?.contributor?.map?.(n("contributor")))?.forEach(([e,t])=>e.forEach(e=>{this.metadata[e]?this.metadata[e].push(t):this.metadata[e]=[t]})),this}async loadDocument(e){var t=await this.loadText(e.href);return this.parser.parseFromString(t,e.mediaType)}async loadMediaOverlay(e){e=e.mediaOverlay;if(!e)return null;const t=this.resources.getItemByID(e);e=await this.#loadXML(t.href);return sn(e,e=>Zr(e,t.href))}resolveCFI(e){return this.resources.resolveCFI(e)}resolveHref(e){const[t,r]=e.split("#"),n=this.resources.getItemByHref(decodeURI(t));return n?{index:this.resources.spine.findIndex(({idref:e})=>e===n.id),anchor:r?e=>((e,t)=>e.getElementById(t)??e.querySelector(`[name="${CSS.escape(t)}"]`))(e,r):()=>0}:null}splitTOCHref(e){return e?.split("#")??[]}getTOCFragment(e,t){return e.getElementById(t)??e.querySelector(`[name="${CSS.escape(t)}"]`)}isExternal(e){return Jr(e)}async getCover(){var e=this.resources?.cover;return e?.href?new Blob([await this.loadBlob(e.href)],{type:e.mediaType}):null}async getCalibreBookmarks(){const e=await this.loadText("META-INF/calibre_bookmarks.txt");var t="encoding=json+base64:";if(e?.startsWith(t)){t=atob(e.slice(t.length));return JSON.parse(t)}}}const mn=e=>{if(!e)return"";const t=document.createElement("textarea");return t.innerHTML=e,t.value},En={XML:"application/xml",XHTML:"application/xhtml+xml",HTML:"text/html",CSS:"text/css",SVG:"image/svg+xml"},yn={name:[0,32,"string"],type:[60,4,"string"],creator:[64,4,"string"],numRecords:[76,2,"uint"]},wn={compression:[0,2,"uint"],numTextRecords:[8,2,"uint"],recordSize:[10,2,"uint"],encryption:[12,2,"uint"]},bn={magic:[16,4,"string"],length:[20,4,"uint"],type:[24,4,"uint"],encoding:[28,4,"uint"],uid:[32,4,"uint"],version:[36,4,"uint"],titleOffset:[84,4,"uint"],titleLength:[88,4,"uint"],localeRegion:[94,1,"uint"],localeLanguage:[95,1,"uint"],resourceStart:[108,4,"uint"],huffcdic:[112,4,"uint"],numHuffcdic:[116,4,"uint"],exthFlag:[128,4,"uint"],trailingFlags:[240,4,"uint"],indx:[244,4,"uint"]},On={resourceStart:[108,4,"uint"],fdst:[192,4,"uint"],numFdst:[196,4,"uint"],frag:[248,4,"uint"],skel:[252,4,"uint"],guide:[260,4,"uint"]},Tn={magic:[0,4,"string"],length:[4,4,"uint"],count:[8,4,"uint"]},vn={magic:[0,4,"string"],length:[4,4,"uint"],type:[8,4,"uint"],idxt:[20,4,"uint"],numRecords:[24,4,"uint"],encoding:[28,4,"uint"],language:[32,4,"uint"],total:[36,4,"uint"],ordt:[40,4,"uint"],ligt:[44,4,"uint"],numLigt:[48,4,"uint"],numCncx:[52,4,"uint"]},_n={magic:[0,4,"string"],length:[4,4,"uint"],numControlBytes:[8,4,"uint"]},Dn={magic:[0,4,"string"],offset1:[8,4,"uint"],offset2:[12,4,"uint"]},Sn={magic:[0,4,"string"],length:[4,4,"uint"],numEntries:[8,4,"uint"],codeLength:[12,4,"uint"]},Mn={magic:[0,4,"string"],numEntries:[8,4,"uint"]},Rn={flags:[8,4,"uint"],dataStart:[12,4,"uint"],keyLength:[16,4,"uint"],keyStart:[20,4,"uint"]},Pn={1252:"windows-1252",65001:"utf-8"},kn={100:["creator","string",!0],101:["publisher"],103:["description"],104:["isbn"],105:["subject","string",!0],106:["date"],108:["contributor","string",!0],109:["rights"],110:["subjectCode","string",!0],112:["source","string",!0],113:["asin"],121:["boundary","uint"],122:["fixedLayout"],125:["numResources","uint"],126:["originalResolution"],127:["zeroGutter"],128:["zeroMargin"],129:["coverURI"],132:["regionMagnification"],201:["coverOffset","uint"],202:["thumbnailOffset","uint"],503:["title"],524:["language","string",!0],527:["pageProgressionDirection"]},xn={1:["ar","ar-SA","ar-IQ","ar-EG","ar-LY","ar-DZ","ar-MA","ar-TN","ar-OM","ar-YE","ar-SY","ar-JO","ar-LB","ar-KW","ar-AE","ar-BH","ar-QA"],2:["bg"],3:["ca"],4:["zh","zh-TW","zh-CN","zh-HK","zh-SG"],5:["cs"],6:["da"],7:["de","de-DE","de-CH","de-AT","de-LU","de-LI"],8:["el"],9:["en","en-US","en-GB","en-AU","en-CA","en-NZ","en-IE","en-ZA","en-JM",null,"en-BZ","en-TT","en-ZW","en-PH"],10:["es","es-ES","es-MX",null,"es-GT","es-CR","es-PA","es-DO","es-VE","es-CO","es-PE","es-AR","es-EC","es-CL","es-UY","es-PY","es-BO","es-SV","es-HN","es-NI","es-PR"],11:["fi"],12:["fr","fr-FR","fr-BE","fr-CA","fr-CH","fr-LU","fr-MC"],13:["he"],14:["hu"],15:["is"],16:["it","it-IT","it-CH"],17:["ja"],18:["ko"],19:["nl","nl-NL","nl-BE"],20:["no","nb","nn"],21:["pl"],22:["pt","pt-BR","pt-PT"],23:["rm"],24:["ro"],25:["ru"],26:["hr",null,"sr"],27:["sk"],28:["sq"],29:["sv","sv-SE","sv-FI"],30:["th"],31:["tr"],32:["ur"],33:["id"],34:["uk"],35:["be"],36:["sl"],37:["et"],38:["lv"],39:["lt"],41:["fa"],42:["vi"],43:["hy"],44:["az"],45:["eu"],46:["hsb"],47:["mk"],48:["st"],49:["ts"],50:["tn"],52:["xh"],53:["zu"],54:["af"],55:["ka"],56:["fo"],57:["hi"],58:["mt"],59:["se"],62:["ms"],63:["kk"],65:["sw"],67:["uz",null,"uz-UZ"],68:["tt"],69:["bn"],70:["pa"],71:["gu"],72:["or"],73:["ta"],74:["te"],75:["kn"],76:["ml"],77:["as"],78:["mr"],79:["sa"],82:["cy","cy-GB"],83:["gl","gl-ES"],87:["kok"],97:["ne"],98:["fy"]},An=(e,t)=>{const r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r},Fn=(e,t,r)=>{const n=new e.constructor(e.length+t.length+r.length);return n.set(e),n.set(t,e.length),n.set(r,e.length+t.length),n},In=new TextDecoder,Nn=e=>In.decode(e),Un=e=>{if(e){var t=e.byteLength,t=4===t?"getUint32":2===t?"getUint16":"getUint8";return new DataView(e)[t](0)}},Cn=(e,o)=>Object.fromEntries(Array.from(Object.entries(e)).map(([e,[t,r,n]])=>[e,("string"===n?Nn:Un)(o.slice(t,t+r))])),jn=e=>new TextDecoder(Pn[e]),Ln=(e,t=0)=>{let r=0,n=0;for(const o of e.subarray(t,t+4))if(r=r<<7|(127&o)>>>0,n++,128&o)break;return{value:r,length:n}},Hn=e=>{let t=0;for(;0<e;e>>=1)1==(1&e)&&t++;return t},Bn=e=>{let t=0;for(;0==(1&e);)e>>=1,t++;return t},Xn=t=>{let r=[];for(let e=0;e<t.length;e++){var n=t[e];if(0===n)r.push(0);else if(n<=8)for(const s of t.subarray(e+1,(e+=n)+1))r.push(s);else if(n<=127)r.push(n);else if(n<=191){var o=n<<8|t[1+e++],i=(16383&o)>>>3,a=3+(7&o);for(let e=0;e<a;e++)r.push(r[r.length-i])}else r.push(32,128^n)}return Uint8Array.from(r)},Qn=async(t,r)=>{const n=await r(t.huffcdic),{magic:e,offset1:o,offset2:i}=Cn(Dn,n);if("HUFF"!==e)throw new Error("Invalid HUFF record");const u=Array.from({length:256},(e,t)=>o+4*t).map(e=>Un(n.slice(e,e+4))).map(e=>[128&e,31&e,e>>>8]),f=[null].concat(Array.from({length:32},(e,t)=>i+8*t).map(e=>[Un(n.slice(e,e+4)),Un(n.slice(e+4,e+8))])),h=[];for(let e=1;e<t.numHuffcdic;e++){const g=await r(t.huffcdic+e);var a=Cn(Sn,g);if("CDIC"!==a.magic)throw new Error("Invalid CDIC record");var s=Math.min(1<<a.codeLength,a.numEntries-h.length);const m=g.slice(a.length);for(let e=0;e<s;e++){var c=Un(m.slice(2*e,2*e+2)),l=Un(m.slice(c,c+2)),d=32768&l,l=new Uint8Array(m.slice(c+2,c+2+(32767&l)));h.push([l,d])}}const p=a=>{let s=new Uint8Array;var c=8*a.byteLength;for(let i=0;i<c;){var l=Number(((t,r)=>{var e=r+32,n=e>>3;let o=0n;for(let e=r>>3;e<=n;e++)o=o<<8n|BigInt(t[e]??0);return o>>8n-BigInt(7&e)&0xffffffffn})(a,i));let[e,t,r]=u[l>>>24];if(!e){for(;l>>>32-t<f[t][0];)t+=1;r=f[t][1]}if((i+=t)>c)break;var d=r-(l>>>32-t);let[n,o]=h[d];o||(n=p(n),h[d]=[n,!0]),s=An(s,n)}return s};return p},zn=async(t,r)=>{const e=await r(t),n=Cn(vn,e);if("INDX"!==n.magic)throw new Error("Invalid INDX record");const o=jn(n.encoding),i=e.slice(n.length);var a=Cn(_n,i);if("TAGX"!==a.magic)throw new Error("Invalid TAGX section");var s=(a.length-12)/4,c=Array.from({length:s},(e,t)=>new Uint8Array(i.slice(12+4*t,12+4*t+4)));const l={};let d=0;for(let e=0;e<n.numCncx;e++){const U=await r(t+n.numRecords+e+1);var u=new Uint8Array(U);for(let e=0;e<u.byteLength;){var f=e,{value:h,length:p}=Ln(u,e);e+=p;p=U.slice(e,e+h);e+=h,l[d+f]=o.decode(p)}d+=65536}const g=[];for(let e=0;e<n.numRecords;e++){const C=await r(t+1+e);var m=new Uint8Array(C);const n=Cn(vn,C);if("INDX"!==n.magic)throw new Error("Invalid INDX record");for(let r=0;r<n.numRecords;r++){var E=n.idxt+4+2*r,y=Un(C.slice(E,E+2)),w=Un(C.slice(y,y+1)),E=Nn(C.slice(y+1,y+1+w));const j=[];var b,O,T,v,_,D,S,M,R,P,k,x=y+1+w;let e=0,t=x+a.numControlBytes;for([b,O,T,v]of c)1&v?e++:(S=x+e,(_=Un(C.slice(S,S+1))&T)===T?1<Hn(T)?({value:D,length:S}=Ln(m,t),j.push([b,null,D,O]),t+=S):j.push([b,1,null,O]):j.push([b,_>>Bn(T),null,O]));const L={};for([M,R,P,k]of j){const H=[];if(null!=R)for(let e=0;e<R*k;e++){var{value:A,length:F}=Ln(m,t);H.push(A),t+=F}else{let e=0;for(;e<P;){var{value:I,length:N}=Ln(m,t);H.push(I),t+=N,e+=N}}L[M]=H}g.push({name:E,tagMap:L})}}return{table:g,cncx:l}};class Wn extends class{#file;#offsets;pdb;async open(e){this.#file=e;var t=Cn(yn,await e.slice(0,78).arrayBuffer());this.pdb=t;const r=await e.slice(78,78+8*t.numRecords).arrayBuffer();this.#offsets=Array.from({length:t.numRecords},(e,t)=>Un(r.slice(8*t,8*t+4))).map((e,t,r)=>[e,r[t+1]])}loadRecord(e){e=this.#offsets[e];if(!e)throw new RangeError("Record index out of bounds");return this.#file.slice(...e).arrayBuffer()}async loadMagic(e){e=this.#offsets[e][0];return Nn(await this.#file.slice(e,e+4).arrayBuffer())}}{#start=0;#resourceStart;#decoder;#encoder;#decompress;#removeTrailingEntries;constructor({unzlib:e}){super(),this.unzlib=e}async open(e){await super.open(e),this.headers=this.#getHeaders(await super.loadRecord(0)),this.#resourceStart=this.headers.mobi.resourceStart;let t=8<=this.headers.mobi.version;if(!t){e=this.headers.exth?.boundary;if(e<4294967295)try{this.headers=this.#getHeaders(await super.loadRecord(e)),this.#start=e,t=!0}catch(e){console.warn(e),console.warn("Failed to open KF8; falling back to MOBI")}}return await this.#setup(),new(t?eo:qn)(this).init()}#getHeaders(e){var t=Cn(wn,e);const r=Cn(bn,e);if("MOBI"!==r.magic)throw new Error("Missing MOBI header");var{titleOffset:n,titleLength:o,localeLanguage:i,localeRegion:a}=r;r.title=e.slice(n,n+o);i=xn[i];r.language=i?.[a>>2]??i?.[0];i=64&r.exthFlag?((t,e)=>{var{magic:r,count:n}=Cn(Tn,t);if("EXTH"!==r)throw new Error("Invalid EXTH header");const o=jn(e),i={};let a=12;for(let e=0;e<n;e++){var s,c,l,d=Un(t.slice(a,a+4)),u=Un(t.slice(a+4,a+8));d in kn&&([s,c,l]=kn[d],d=t.slice(a+8,a+u),d="uint"===c?Un(d):o.decode(d),l?(i[s]??=[],i[s].push(d)):i[s]=d),a+=u}return i})(e.slice(r.length+16),r.encoding):null,e=8<=r.version?Cn(On,e):null;return{palmdoc:t,mobi:r,exth:i,kf8:e}}async#setup(){var{palmdoc:e,mobi:t}=this.headers;this.#decoder=jn(t.encoding),this.#encoder=new TextEncoder;var e=e["compression"];if(this.#decompress=1===e?e=>e:2===e?Xn:17480===e?await Qn(t,this.loadRecord.bind(this)):null,!this.#decompress)throw new Error("Unknown compression type");var t=t["trailingFlags"];const n=1&t,o=Hn(t>>>1);this.#removeTrailingEntries=t=>{for(let e=0;e<o;e++){var r=(e=>{let t=0;for(const r of e.subarray(-4))128&r&&(t=0),t=t<<7|127&r;return t})(t);t=t.subarray(0,-r)}var e;return n&&(e=1+(3&t[t.length-1]),t=t.subarray(0,-e)),t}}decode(...e){return this.#decoder.decode(...e)}encode(...e){return this.#encoder.encode(...e)}loadRecord(e){return super.loadRecord(this.#start+e)}loadMagic(e){return super.loadMagic(this.#start+e)}loadText(e){return this.loadRecord(e+1).then(e=>new Uint8Array(e)).then(this.#removeTrailingEntries).then(this.#decompress)}async loadResource(e){const t=await super.loadRecord(this.#resourceStart+e);e=Nn(t.slice(0,4));return"FONT"===e?(async(e,t)=>{var{flags:r,dataStart:n,keyLength:o,keyStart:i}=Cn(Rn,e);const a=new Uint8Array(e.slice(n));if(2&r)for(var n=16===o?1024:1040,s=new Uint8Array(e.slice(i,i+o)),c=Math.min(n,a.length),l=0;l<c;l++)a[l]=a[l]^s[l%s.length];if(1&r)try{return t(a)}catch(e){console.warn(e),console.warn("Failed to decompress font")}return a})(t,this.unzlib):"VIDE"===e||"AUDI"===e?t.slice(12):t}getNCX(){var e=this.headers.mobi.indx;if(e<4294967295)return(async(e,t)=>{const{table:r,cncx:n}=await zn(e,t),o=r.map(({tagMap:e},t)=>({index:t,offset:e[1]?.[0],size:e[2]?.[0],label:n[e[3]]??"",headingLevel:e[4]?.[0],pos:e[6],parent:e[21]?.[0],firstChild:e[22]?.[0],lastChild:e[23]?.[0]})),i=t=>(null==t.firstChild||(t.children=o.filter(e=>e.parent===t.index).map(i)),t);return o.filter(e=>0===e.headingLevel).map(i)})(e,this.loadRecord.bind(this))}getMetadata(){const{mobi:e,exth:t}=this.headers;return{identifier:e.uid.toString(),title:mn(t?.title||this.decode(e.title)),author:t?.creator?.map(mn),publisher:mn(t?.publisher),language:t?.language??e.language,published:t?.date,description:mn(t?.description),subject:t?.subject?.map(mn),rights:mn(t?.rights)}}async getCover(){var e=this.headers["exth"],e=e?.coverOffset<4294967295?e?.coverOffset:e?.thumbnailOffset<4294967295?e?.thumbnailOffset:null;if(null!=e){e=await this.loadResource(e);return new Blob([e])}}}const Gn=/<\s*(?:mbp:)?pagebreak[^>]*>/gi,$n=/<[^<>]+filepos=['"]{0,1}(\d+)[^<>]*>/gi;class qn{parser=new DOMParser;serializer=new XMLSerializer;#resourceCache=new Map;#textCache=new Map;#cache=new Map;#sections;#fileposList=[];#type=En.HTML;constructor(e){this.mobi=e}async init(){let t=new Uint8Array;for(let e=0;e<this.mobi.headers.palmdoc.numTextRecords;e++)t=An(t,await this.mobi.loadText(e));const n=Array.from(new Uint8Array(t),e=>String.fromCharCode(e)).join("");this.#sections=[0].concat(Array.from(n.matchAll(Gn),e=>e.index)).map((e,t,r)=>n.slice(e,r[t+1])).map(e=>Uint8Array.from(e,e=>e.charCodeAt(0))).map(e=>({book:this,raw:e})).reduce((e,t)=>{var r=e[e.length-1];return t.start=r?.end??0,t.end=t.start+t.raw.byteLength,e.concat(t)},[]),this.sections=this.#sections.map((e,t)=>({id:t,load:()=>this.loadSection(e),createDocument:()=>this.createDocument(e),size:e.end-e.start}));const o=[];try{const i=await this.mobi.getNCX(),a=({label:e,offset:t,children:r})=>{var n=t.toString().padStart(10,"0"),t=`filepos:${n}`;return o.push(n),{label:e=mn(e),href:t,subitems:r?.map(a)}};if(this.toc=i?.map(a),this.landmarks=await this.getGuide(),!this.toc){var e=this.landmarks.find(({type:e})=>e?.includes("toc"))?.href;if(e){var r=this.resolveHref(e)["index"];const s=await this.sections[r].createDocument();this.toc=Array.from(s.querySelectorAll("a[filepos]"),e=>({label:e.innerText?.trim(),href:`filepos:${e.getAttribute("filepos")}`}))}}}catch(e){console.warn(e)}return this.#fileposList=[...new Set(o.concat(Array.from(n.matchAll($n),e=>e[1])))].map(e=>({filepos:e,number:Number(e)})).sort((e,t)=>e.number-t.number),this.metadata=this.mobi.getMetadata(),this.getCover=this.mobi.getCover.bind(this.mobi),this}async getGuide(){const e=await this.createDocument(this.#sections[0]);return Array.from(e.getElementsByTagName("reference"),e=>({label:e.getAttribute("title"),type:e.getAttribute("type")?.split(/\s/),href:`filepos:${e.getAttribute("filepos")}`}))}async loadResource(e){if(this.#resourceCache.has(e))return this.#resourceCache.get(e);var t=await this.mobi.loadResource(e),t=URL.createObjectURL(new Blob([t]));return this.#resourceCache.set(e,t),t}async loadRecindex(e){return this.loadResource(Number(e)-1)}async replaceResources(e){for(const i of e.querySelectorAll("img[recindex]")){var t=i.getAttribute("recindex");try{i.src=await this.loadRecindex(t)}catch(e){console.warn(`Failed to load image ${t}`)}}for(const a of e.querySelectorAll("[mediarecindex]")){var r=a.getAttribute("mediarecindex"),n=a.getAttribute("recindex");try{a.src=await this.loadRecindex(r),n&&(a.poster=await this.loadRecindex(n))}catch(e){console.warn(`Failed to load media ${r}`)}}for(const s of e.querySelectorAll("[filepos]")){var o=s.getAttribute("filepos");s.href=`filepos:${o}`}}async loadText(t){if(this.#textCache.has(t))return this.#textCache.get(t);const n=t["raw"],o=this.#fileposList.filter(({number:e})=>e>=t.start&&e<t.end).map(e=>({...e,offset:e.number-t.start}));let i=n;o.length&&(i=n.subarray(0,o[0].offset),o.forEach(({filepos:e,offset:t},r)=>{r=o[r+1],e=this.mobi.encode(`<a id="filepos${e}"></a>`);i=Fn(i,e,n.subarray(t,r?.offset))}));var e=this.mobi.decode(i).replaceAll(Gn,"");return this.#textCache.set(t,e),e}async createDocument(e){e=await this.loadText(e);return this.parser.parseFromString(e,this.#type)}async loadSection(e){if(this.#cache.has(e))return this.#cache.get(e);const t=await this.createDocument(e),r=t.createElement("style");t.head.append(r),r.append(t.createTextNode(`blockquote {
            margin-block-start: 0;
            margin-block-end: 0;
            margin-inline-start: 1em;
            margin-inline-end: 0;
        }`)),await this.replaceResources(t);var n=this.serializer.serializeToString(t),n=URL.createObjectURL(new Blob([n],{type:this.#type}));return this.#cache.set(e,n),n}resolveHref(e){const t=e.match(/filepos:(.*)/)[1],r=Number(t);return{index:this.#sections.findIndex(e=>e.end>r),anchor:e=>e.getElementById(`filepos${t}`)}}splitTOCHref(e){e=e.match(/filepos:(.*)/)[1];const t=Number(e);return[this.#sections.findIndex(e=>e.end>t),`filepos${e}`]}getTOCFragment(e,t){return e.getElementById(t)}isExternal(e){return/^(?!blob|filepos)\w+:/i.test(e)}}const Yn=/kindle:(flow|embed):(\w+)(?:\?mime=(\w+\/[-+.\w]+))?/,Kn=/kindle:pos:fid:(\w+):off:(\w+)/,Vn=e=>{var[t,e]=e.match(Kn).slice(1);return{fid:parseInt(t,32),off:parseInt(e,32)}},Zn=(e=0,t=0)=>`kindle:pos:fid:${e.toString(32).toUpperCase().padStart(4,"0")}:off:${t.toString(32).toUpperCase().padStart(10,"0")}`,Jn=e=>{var t=e.match(/\s(id|name|aid)\s*=\s*['"]([^'"]*)['"]/i);if(t){var[,e,t]=t;return`[${e}="${CSS.escape(t)}"]`}};class eo{parser=new DOMParser;#cache=new Map;#fragmentOffsets=new Map;#fragmentSelectors=new Map;#tables={};#sections;#fullRawLength;#rawHead=new Uint8Array;#rawTail=new Uint8Array;#lastLoadedHead=-1;#lastLoadedTail=-1;#checkType=!0;#type=En.XHTML;constructor(e){this.mobi=e}async init(){const e=this.mobi.loadRecord.bind(this.mobi);var t=this.mobi.headers["kf8"];try{const c=await e(t.fdst);var r=Cn(Mn,c);if("FDST"!==r.magic)throw new Error("Missing FDST record");var n=Array.from({length:r.numEntries},(e,t)=>12+8*t).map(e=>[Un(c.slice(e,e+4)),Un(c.slice(e+4,e+8))]);this.#tables.fdstTable=n,this.#fullRawLength=n[n.length-1][1]}catch{}const o=(await zn(t.skel,e)).table.map(({name:e,tagMap:t},r)=>({index:r,name:e,numFrag:t[1][0],offset:t[6][0],length:t[6][1]})),i=await zn(t.frag,e),a=i.table.map(({name:e,tagMap:t})=>({insertOffset:parseInt(e),selector:i.cncx[t[2][0]],index:t[4][0],offset:t[6][0],length:t[6][1]}));this.#tables.skelTable=o,this.#tables.fragTable=a,this.#sections=o.reduce((e,t)=>{var r=e[e.length-1],n=r?.fragEnd??0,o=n+t.numFrag;const i=a.slice(n,o);n=t.length+i.map(e=>e.length).reduce((e,t)=>e+t);return e.concat({skel:t,frags:i,fragEnd:o,length:n,totalLength:(r?.totalLength??0)+n})},[]),this.#sections.unshift({frags:[]}),this.sections=this.#sections.map((e,t)=>e.frags.length?{id:t,load:()=>this.loadSection(e),createDocument:()=>this.createDocument(e),size:e.length}:{linear:"no"});try{const l=await this.mobi.getNCX(),d=({label:e,pos:t,children:r})=>{var[n,o]=t,t=Zn(n,o);const i=this.#fragmentOffsets.get(n);return i?i.push(o):this.#fragmentOffsets.set(n,[o]),{label:mn(e),href:t,subitems:r?.map(d)}};this.toc=l?.map(d),this.landmarks=await this.getGuide()}catch(e){console.warn(e)}const s=this.mobi.headers["exth"];return this.dir=s.pageProgressionDirection,this.rendition={layout:"true"===s.fixedLayout?"pre-paginated":"reflowable",viewport:Object.fromEntries(s.originalResolution?.split("x")?.slice(0,2)?.map((e,t)=>[t?"height":"width",e])??[])},this.metadata=this.mobi.getMetadata(),this.getCover=this.mobi.getCover.bind(this.mobi),this}async getResourcesByMagic(t){const r={};var n=this.mobi.headers.kf8.resourceStart,o=this.mobi.pdb.numRecords;for(let e=n;e<o;e++)try{const a=await this.mobi.loadMagic(e);var i=t.find(e=>e===a);i&&(r[i]=e)}catch{}return r}async getGuide(){var e=this.mobi.headers.kf8.guide;if(e<4294967295){var t=this.mobi.loadRecord.bind(this.mobi);const{table:r,cncx:n}=await zn(e,t);return r.map(({name:e,tagMap:t})=>({label:n[t[1][0]]??"",type:e?.split(/\s/),href:Zn(t[6]?.[0]??t[3]?.[0])}))}}async loadResourceBlob(e){var{resourceType:t,id:r,type:e}=(e=>{var[t,r,e]=e.match(Yn).slice(1);return{resourceType:t,id:parseInt(r,32),type:e}})(e),r="flow"===t?await this.loadFlow(r):await this.mobi.loadResource(r-1),r=[En.XHTML,En.HTML,En.CSS,En.SVG].includes(e)?await this.replaceResources(this.mobi.decode(r)):r;return new Blob([r],{type:e})}async loadResource(e){if(this.#cache.has(e))return this.#cache.get(e);var t=await this.loadResourceBlob(e),t=URL.createObjectURL(t);return this.#cache.set(e,t),t}replaceResources(e){return(async(e,t,r)=>{const n=[];e.replace(t,(...e)=>(n.push(e),null));const o=[];for(const i of n)o.push(await r(...i));return e.replace(t,()=>o.shift())})(e,new RegExp(Yn,"g"),this.loadResource.bind(this))}async loadRaw(e,t){var r=t-this.#rawHead.length,n=null==this.#fullRawLength?1/0:this.#fullRawLength-this.#rawTail.length-e;if(r<0||r<n){for(;this.#rawHead.length<t;){var o=++this.#lastLoadedHead,o=await this.mobi.loadText(o);this.#rawHead=An(this.#rawHead,o)}return this.#rawHead.slice(e,t)}for(;this.#fullRawLength-this.#rawTail.length>e;){var i=this.mobi.headers.palmdoc.numTextRecords-1-++this.#lastLoadedTail,i=await this.mobi.loadText(i);this.#rawTail=An(i,this.#rawTail)}n=this.#fullRawLength-this.#rawTail.length;return this.#rawTail.slice(e-n,t-n)}loadFlow(e){if(e<4294967295)return this.loadRaw(...this.#tables.fdstTable[e])}async loadText(e){var{skel:t,frags:r,length:e}=e;const n=await this.loadRaw(t.offset,t.offset+e);let o=n.slice(0,t.length);for(const l of r){var i=l.insertOffset-t.offset,a=t.length+l.offset,s=n.slice(a,a+l.length);o=Fn(o.slice(0,i),s,o.slice(i));i=this.#fragmentOffsets.get(l.index);if(i)for(const d of i){var c=this.mobi.decode(s).slice(d),c=Jn(c);this.#setFragmentSelector(l.index,d,c)}}return this.mobi.decode(o)}async createDocument(e){e=await this.loadText(e);return this.parser.parseFromString(e,this.#type)}async loadSection(e){if(this.#cache.has(e))return this.#cache.get(e);var t=await this.loadText(e);this.#checkType&&this.parser.parseFromString(t,this.#type).querySelector("parsererror")&&(this.#type=En.HTML),this.#checkType&&(this.#checkType=!1);t=await this.replaceResources(t),t=URL.createObjectURL(new Blob([t],{type:this.#type}));return this.#cache.set(e,t),t}getIndexByFID(t){return this.#sections.findIndex(e=>e.frags.some(e=>e.index===t))}#setFragmentSelector(e,t,r){const n=this.#fragmentSelectors.get(e);if(n)n.set(t,r);else{const n=new Map;this.#fragmentSelectors.set(e,n),n.set(t,r)}}async resolveHref(e){const{fid:t,off:r}=Vn(e);var n=this.getIndexByFID(t);if(!(n<0)){const i=this.#fragmentSelectors.get(t)?.get(r);if(i)return{index:n,anchor:e=>e.querySelector(i)};const{skel:a,frags:s}=this.#sections[n];var o=s.find(e=>e.index===t),e=a.offset+a.length+o.offset,o=await this.loadRaw(e,e+o.length),o=this.mobi.decode(o).slice(r);const c=Jn(o);this.#setFragmentSelector(t,r,c);return{index:n,anchor:e=>e.querySelector(c)}}}splitTOCHref(e){e=Vn(e);return[this.getIndexByFID(e.fid),e]}getTOCFragment(e,{fid:t,off:r}){r=this.#fragmentSelectors.get(t)?.get(r);return e.querySelector(r)}isExternal(e){return/^(?!blob|kindle)\w+:/i.test(e)}}const to=({entries:e,loadBlob:n,getSize:t},r)=>{const o=new Map,i=new Map,a=[".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg"],s=e.map(e=>e.filename).filter(t=>a.some(e=>t.endsWith(e))).sort(),c={getCover:()=>n(s[0])};return c.metadata={title:r.name},c.sections=s.map(e=>({id:e,load:()=>(async e=>{if(o.has(e))return o.get(e);var t=URL.createObjectURL(await n(e)),r=URL.createObjectURL(new Blob([`<img src="${t}">`],{type:"text/html"}));return i.set(e,[t,r]),o.set(e,r),r})(e),unload:()=>(e=>{i.get(e)?.forEach?.(e=>URL.revokeObjectURL(e)),i.delete(e),o.delete(e)})(e),size:t(e)})),c.toc=s.map(e=>({label:e,href:e})),c.rendition={layout:"pre-paginated"},c.resolveHref=t=>({index:c.sections.findIndex(e=>e.id===t)}),c.splitTOCHref=e=>[e,null],c.getTOCFragment=e=>e.documentElement,c};var ro,st={exports:{}},no=st.exports=function(){function t(r){function n(e){for(var t=0,r=o.length;t<r;++t)o[t](e);i.push(e)}if("function"!=typeof Promise)throw new Error("Promise implementation not available in this environment.");var o=[],i=[],a=new Promise(function(e,t){r(e,t,n)});a.progress=function(e){if("function"!=typeof e)throw new Error("cb is not a function.");for(var t=0,r=i.length;t<r;++t)e(i[t]);return o.push(e),a};var s=a.then;return a.then=function(e,t,r){return s.call(a,e,t),void 0!==r&&a.progress(r),a},a}function e(e){if(!(e instanceof ArrayBuffer))throw new TypeError("arrayBuffer is not an instance of ArrayBuffer.");if(!r.Worker)throw new Error("Worker implementation is not available in this environment.");return new t(function(r,n,o){var i=new Worker(c),a=[];i.onerror=function(e){n(e)},i.onmessage=function(e){switch(e=e.data,e.type){case"log":console[e.data.level]("Worker: "+e.data.msg);break;case"extract":var t=s(e.data);a.push(t),o(t);break;case"complete":i.terminate(),r(a);break;case"error":i.terminate(),n(new Error(e.data.message));break;default:i.terminate(),n(new Error("Unknown message from worker: "+e.type))}},i.postMessage({type:"extract",buffer:e},[e])})}function s(e){return Object.defineProperties(e,o),e}var c,r=window||this,n=r.URL||r.webkitURL,o={blob:{get:function(){return this._blob||(this._blob=new Blob([this.buffer]))}},getBlobUrl:{value:function(){return this._blobUrl||(this._blobUrl=n.createObjectURL(this.blob))}},readAsString:{value:function(){for(var e=this.buffer,t=e.byteLength,r=1,n=new DataView(e),o=[],i=0;i<t;++i){var a=n.getUint8(i*r,!0);o.push(a)}return this._string=String.fromCharCode.apply(null,o)}},readAsJSON:{value:function(){return JSON.parse(this.readAsString())}}},c=(window||this).URL.createObjectURL(new Blob(['"use strict";function UntarWorker(){}function decodeUTF8(e){for(var r="",t=0;t<e.length;){var a=e[t++];if(a>127){if(a>191&&a<224){if(t>=e.length)throw"UTF-8 decode: incomplete 2-byte sequence";a=(31&a)<<6|63&e[t]}else if(a>223&&a<240){if(t+1>=e.length)throw"UTF-8 decode: incomplete 3-byte sequence";a=(15&a)<<12|(63&e[t])<<6|63&e[++t]}else{if(!(a>239&&a<248))throw"UTF-8 decode: unknown multibyte start 0x"+a.toString(16)+" at index "+(t-1);if(t+2>=e.length)throw"UTF-8 decode: incomplete 4-byte sequence";a=(7&a)<<18|(63&e[t])<<12|(63&e[++t])<<6|63&e[++t]}++t}if(a<=65535)r+=String.fromCharCode(a);else{if(!(a<=1114111))throw"UTF-8 decode: code point 0x"+a.toString(16)+" exceeds UTF-16 reach";a-=65536,r+=String.fromCharCode(a>>10|55296),r+=String.fromCharCode(1023&a|56320)}}return r}function PaxHeader(e){this._fields=e}function TarFile(){}function UntarStream(e){this._bufferView=new DataView(e),this._position=0}function UntarFileStream(e){this._stream=new UntarStream(e),this._globalPaxHeader=null}if(UntarWorker.prototype={onmessage:function(e){try{if("extract"!==e.data.type)throw new Error("Unknown message type: "+e.data.type);this.untarBuffer(e.data.buffer)}catch(r){this.postError(r)}},postError:function(e){this.postMessage({type:"error",data:{message:e.message}})},postLog:function(e,r){this.postMessage({type:"log",data:{level:e,msg:r}})},untarBuffer:function(e){try{for(var r=new UntarFileStream(e);r.hasNext();){var t=r.next();this.postMessage({type:"extract",data:t},[t.buffer])}this.postMessage({type:"complete"})}catch(a){this.postError(a)}},postMessage:function(e,r){self.postMessage(e,r)}},"undefined"!=typeof self){var worker=new UntarWorker;self.onmessage=function(e){worker.onmessage(e)}}PaxHeader.parse=function(e){for(var r=new Uint8Array(e),t=[];r.length>0;){var a=parseInt(decodeUTF8(r.subarray(0,r.indexOf(32)))),n=decodeUTF8(r.subarray(0,a)),i=n.match(/^\\d+ ([^=]+)=(.*)\\n$/);if(null===i)throw new Error("Invalid PAX header data format.");var s=i[1],o=i[2];0===o.length?o=null:null!==o.match(/^\\d+$/)&&(o=parseInt(o));var f={name:s,value:o};t.push(f),r=r.subarray(a)}return new PaxHeader(t)},PaxHeader.prototype={applyHeader:function(e){this._fields.forEach(function(r){var t=r.name,a=r.value;"path"===t?(t="name",void 0!==e.prefix&&delete e.prefix):"linkpath"===t&&(t="linkname"),null===a?delete e[t]:e[t]=a})}},UntarStream.prototype={readString:function(e){for(var r=1,t=e*r,a=[],n=0;n<e;++n){var i=this._bufferView.getUint8(this.position()+n*r,!0);if(0===i)break;a.push(i)}return this.seek(t),String.fromCharCode.apply(null,a)},readBuffer:function(e){var r;if("function"==typeof ArrayBuffer.prototype.slice)r=this._bufferView.buffer.slice(this.position(),this.position()+e);else{r=new ArrayBuffer(e);var t=new Uint8Array(r),a=new Uint8Array(this._bufferView.buffer,this.position(),e);t.set(a)}return this.seek(e),r},seek:function(e){this._position+=e},peekUint32:function(){return this._bufferView.getUint32(this.position(),!0)},position:function(e){return void 0===e?this._position:void(this._position=e)},size:function(){return this._bufferView.byteLength}},UntarFileStream.prototype={hasNext:function(){return this._stream.position()+4<this._stream.size()&&0!==this._stream.peekUint32()},next:function(){return this._readNextFile()},_readNextFile:function(){var e=this._stream,r=new TarFile,t=!1,a=null,n=e.position(),i=n+512;switch(r.name=e.readString(100),r.mode=e.readString(8),r.uid=parseInt(e.readString(8)),r.gid=parseInt(e.readString(8)),r.size=parseInt(e.readString(12),8),r.mtime=parseInt(e.readString(12),8),r.checksum=parseInt(e.readString(8)),r.type=e.readString(1),r.linkname=e.readString(100),r.ustarFormat=e.readString(6),r.ustarFormat.indexOf("ustar")>-1&&(r.version=e.readString(2),r.uname=e.readString(32),r.gname=e.readString(32),r.devmajor=parseInt(e.readString(8)),r.devminor=parseInt(e.readString(8)),r.namePrefix=e.readString(155),r.namePrefix.length>0&&(r.name=r.namePrefix+"/"+r.name)),e.position(i),r.type){case"0":case"":r.buffer=e.readBuffer(r.size);break;case"1":break;case"2":break;case"3":break;case"4":break;case"5":break;case"6":break;case"7":break;case"g":t=!0,this._globalPaxHeader=PaxHeader.parse(e.readBuffer(r.size));break;case"x":t=!0,a=PaxHeader.parse(e.readBuffer(r.size))}void 0===r.buffer&&(r.buffer=new ArrayBuffer(0));var s=i+r.size;return r.size%512!==0&&(s+=512-r.size%512),e.position(s),t&&(r=this._readNextFile()),null!==this._globalPaxHeader&&this._globalPaxHeader.applyHeader(r),null!==a&&a.applyHeader(r),r}};']));return e}(),oo=(ro="undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("kookit.umd.js",document.baseURI).href,function(e){var r,a,y=void 0!==(e=e||{})?e:{};y.ready=new Promise(function(e,t){r=e,a=t}),Object.getOwnPropertyDescriptor(y.ready,"_main")||(Object.defineProperty(y.ready,"_main",{configurable:!0,get:function(){de("You are getting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_main",{configurable:!0,set:function(){de("You are setting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_emscripten_stack_get_end")||(Object.defineProperty(y.ready,"_emscripten_stack_get_end",{configurable:!0,get:function(){de("You are getting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_emscripten_stack_get_end",{configurable:!0,set:function(){de("You are setting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_emscripten_stack_get_free")||(Object.defineProperty(y.ready,"_emscripten_stack_get_free",{configurable:!0,get:function(){de("You are getting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_emscripten_stack_get_free",{configurable:!0,set:function(){de("You are setting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_emscripten_stack_init")||(Object.defineProperty(y.ready,"_emscripten_stack_init",{configurable:!0,get:function(){de("You are getting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_emscripten_stack_init",{configurable:!0,set:function(){de("You are setting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_stackSave")||(Object.defineProperty(y.ready,"_stackSave",{configurable:!0,get:function(){de("You are getting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_stackSave",{configurable:!0,set:function(){de("You are setting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_stackRestore")||(Object.defineProperty(y.ready,"_stackRestore",{configurable:!0,get:function(){de("You are getting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_stackRestore",{configurable:!0,set:function(){de("You are setting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_stackAlloc")||(Object.defineProperty(y.ready,"_stackAlloc",{configurable:!0,get:function(){de("You are getting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_stackAlloc",{configurable:!0,set:function(){de("You are setting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"___wasm_call_ctors")||(Object.defineProperty(y.ready,"___wasm_call_ctors",{configurable:!0,get:function(){de("You are getting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"___wasm_call_ctors",{configurable:!0,set:function(){de("You are setting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_fflush")||(Object.defineProperty(y.ready,"_fflush",{configurable:!0,get:function(){de("You are getting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_fflush",{configurable:!0,set:function(){de("You are setting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"___errno_location")||(Object.defineProperty(y.ready,"___errno_location",{configurable:!0,get:function(){de("You are getting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"___errno_location",{configurable:!0,set:function(){de("You are setting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"_malloc")||(Object.defineProperty(y.ready,"_malloc",{configurable:!0,get:function(){de("You are getting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"_malloc",{configurable:!0,set:function(){de("You are setting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"__get_tzname")||(Object.defineProperty(y.ready,"__get_tzname",{configurable:!0,get:function(){de("You are getting __get_tzname on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"__get_tzname",{configurable:!0,set:function(){de("You are setting __get_tzname on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"__get_daylight")||(Object.defineProperty(y.ready,"__get_daylight",{configurable:!0,get:function(){de("You are getting __get_daylight on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"__get_daylight",{configurable:!0,set:function(){de("You are setting __get_daylight on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"__get_timezone")||(Object.defineProperty(y.ready,"__get_timezone",{configurable:!0,get:function(){de("You are getting __get_timezone on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"__get_timezone",{configurable:!0,set:function(){de("You are setting __get_timezone on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(y.ready,"onRuntimeInitialized")||(Object.defineProperty(y.ready,"onRuntimeInitialized",{configurable:!0,get:function(){de("You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(y.ready,"onRuntimeInitialized",{configurable:!0,set:function(){de("You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),y.noInitialRun=!0;var t,n={};for(t in y)y.hasOwnProperty(t)&&(n[t]=y[t]);var o=[],s="./this.program",c=function(e,t){throw t},l="object"==typeof window,d="function"==typeof importScripts,i="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,u=!l&&!i&&!d;if(y.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var f,w,h,p,g,m="";if(i){if("object"!=typeof process||"function"!=typeof require)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");m=d?require("path").dirname(m)+"/":__dirname+"/",f=function(e,t){return p=p||require("fs"),e=(g=g||require("path")).normalize(e),p.readFileSync(e,t?null:"utf8")},h=function(e){e=f(e,!0);return M((e=!e.buffer?new Uint8Array(e):e).buffer),e},w=function(e,r,n){p=p||require("fs"),e=(g=g||require("path")).normalize(e),p.readFile(e,function(e,t){e?n(e):r(t.buffer)})},1<process.argv.length&&(s=process.argv[1].replace(/\\/g,"/")),o=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof Ye))throw e}),process.on("unhandledRejection",de),c=function(e,t){if(ee())throw process.exitCode=e,t;process.exit(e)},y.inspect=function(){return"[Emscripten Module object]"}}else if(u){if("object"==typeof process&&"function"==typeof require||"object"==typeof window||"function"==typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");"undefined"!=typeof read&&(f=function(e){return read(e)}),h=function(e){return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(M("object"==typeof(e=read(e,"binary"))),e)},w=function(e,t,r){setTimeout(function(){t(h(e))},0)},"undefined"!=typeof scriptArgs?o=scriptArgs:void 0!==arguments&&(o=arguments),"function"==typeof quit&&(c=function(e){quit(e)}),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)}else{if(!l&&!d)throw new Error("environment detection error");if(d?m=self.location.href:"undefined"!=typeof document&&document.currentScript&&(m=document.currentScript.src),m=0!==(m=ro?ro:m).indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"","object"!=typeof window&&"function"!=typeof importScripts)throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");f=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},d&&(h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),w=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}}var E,b=y.print||console.log.bind(console),O=y.printErr||console.warn.bind(console);for(t in n)n.hasOwnProperty(t)&&(y[t]=n[t]);function T(e){T.shown||(T.shown={}),T.shown[e]||(T.shown[e]=1,O(e))}n=null,y.arguments&&(o=y.arguments),Object.getOwnPropertyDescriptor(y,"arguments")||Object.defineProperty(y,"arguments",{configurable:!0,get:function(){de("Module.arguments has been replaced with plain arguments_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),y.thisProgram&&(s=y.thisProgram),Object.getOwnPropertyDescriptor(y,"thisProgram")||Object.defineProperty(y,"thisProgram",{configurable:!0,get:function(){de("Module.thisProgram has been replaced with plain thisProgram (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),y.quit&&(c=y.quit),Object.getOwnPropertyDescriptor(y,"quit")||Object.defineProperty(y,"quit",{configurable:!0,get:function(){de("Module.quit has been replaced with plain quit_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),M(void 0===y.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),M(void 0===y.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),M(void 0===y.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),M(void 0===y.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),M(void 0===y.read,"Module.read option was removed (modify read_ in JS)"),M(void 0===y.readAsync,"Module.readAsync option was removed (modify readAsync in JS)"),M(void 0===y.readBinary,"Module.readBinary option was removed (modify readBinary in JS)"),M(void 0===y.setWindowTitle,"Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),M(void 0===y.TOTAL_MEMORY,"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),Object.getOwnPropertyDescriptor(y,"read")||Object.defineProperty(y,"read",{configurable:!0,get:function(){de("Module.read has been replaced with plain read_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(y,"readAsync")||Object.defineProperty(y,"readAsync",{configurable:!0,get:function(){de("Module.readAsync has been replaced with plain readAsync (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(y,"readBinary")||Object.defineProperty(y,"readBinary",{configurable:!0,get:function(){de("Module.readBinary has been replaced with plain readBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(y,"setWindowTitle")||Object.defineProperty(y,"setWindowTitle",{configurable:!0,get:function(){de("Module.setWindowTitle has been replaced with plain setWindowTitle (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),M(!u,"shell environment detected but not enabled at build time.  Add 'shell' to `-s ENVIRONMENT` to enable."),y.wasmBinary&&(E=y.wasmBinary),Object.getOwnPropertyDescriptor(y,"wasmBinary")||Object.defineProperty(y,"wasmBinary",{configurable:!0,get:function(){de("Module.wasmBinary has been replaced with plain wasmBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});var v,_=y.noExitRuntime||!0;Object.getOwnPropertyDescriptor(y,"noExitRuntime")||Object.defineProperty(y,"noExitRuntime",{configurable:!0,get:function(){de("Module.noExitRuntime has been replaced with plain noExitRuntime (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),"object"!=typeof WebAssembly&&de("no native wasm support detected");var D,S=!1;function M(e,t){e||de("Assertion failed: "+t)}var R,P,k,x,A,F,I="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function N(e,t,r){for(var n=t+r,o=t;e[o]&&!(n<=o);)++o;if(16<o-t&&e.subarray&&I)return I.decode(e.subarray(t,o));for(var i="";t<o;){var a,s,c=e[t++];128&c?(a=63&e[t++],192!=(224&c)?(s=63&e[t++],(c=224==(240&c)?(15&c)<<12|a<<6|s:(240!=(248&c)&&T("Invalid UTF-8 leading byte 0x"+c.toString(16)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),(7&c)<<18|a<<12|s<<6|63&e[t++]))<65536?i+=String.fromCharCode(c):(s=c-65536,i+=String.fromCharCode(55296|s>>10,56320|1023&s))):i+=String.fromCharCode((31&c)<<6|a)):i+=String.fromCharCode(c)}return i}function U(e,t,r,n){if(!(0<n))return 0;for(var o=r,i=r+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if((s=55296<=s&&s<=57343?65536+((1023&s)<<10)|1023&e.charCodeAt(++a):s)<=127){if(i<=r)break;t[r++]=s}else if(s<=2047){if(i<=r+1)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(i<=r+2)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(i<=r+3)break;2097152<=s&&T("Invalid Unicode code point 0x"+s.toString(16)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x1FFFFF)."),t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-o}function C(e,t,r){return M("number"==typeof r,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),U(e,k,t,r)}function j(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);(n=55296<=n&&n<=57343?65536+((1023&n)<<10)|1023&e.charCodeAt(++r):n)<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}function L(e){var t=j(e)+1,r=Be(t);return r&&U(e,P,r,t),r}function H(e){var t=j(e)+1,r=$e(t);return U(e,P,r,t),r}function B(e,t,r){for(var n=0;n<e.length;++n)M(e.charCodeAt(n)===e.charCodeAt(n)&255),P[t++>>0]=e.charCodeAt(n);r||(P[t>>0]=0)}function X(e){R=e,y.HEAP8=P=new Int8Array(e),y.HEAP16=x=new Int16Array(e),y.HEAP32=A=new Int32Array(e),y.HEAPU8=k=new Uint8Array(e),y.HEAPU16=new Uint16Array(e),y.HEAPU32=F=new Uint32Array(e),y.HEAPF32=new Float32Array(e),y.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var Q=5242880;y.TOTAL_STACK&&M(Q===y.TOTAL_STACK,"the stack size can no longer be determined at runtime");var z,u=y.INITIAL_MEMORY||16777216;function W(){var e=Xe();M(0==(3&e)),F[1+(e>>2)]=34821223,F[2+(e>>2)]=2310721022,A[0]=1668509029}function G(){var e,t;S||(t=Xe(),e=F[1+(t>>2)],t=F[2+(t>>2)],34821223==e&&2310721022==t||de("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x"+t.toString(16)+" "+e.toString(16)),1668509029!==A[0]&&de("Runtime error: The application has corrupted its heap memory area (address zero)!"))}Object.getOwnPropertyDescriptor(y,"INITIAL_MEMORY")||Object.defineProperty(y,"INITIAL_MEMORY",{configurable:!0,get:function(){de("Module.INITIAL_MEMORY has been replaced with plain INITIAL_MEMORY (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),M(Q<=u,"INITIAL_MEMORY should be larger than TOTAL_STACK, was "+u+"! (TOTAL_STACK="+Q+")"),M("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),M(!y.wasmMemory,"Use of `wasmMemory` detected.  Use -s IMPORTED_MEMORY to define wasmMemory externally"),M(16777216==u,"Detected runtime INITIAL_MEMORY setting.  Use -s IMPORTED_MEMORY to define wasmMemory dynamically"),function(){var e=new Int16Array(1),t=new Int8Array(e.buffer);if(e[0]=25459,115!==t[0]||99!==t[1])throw"Runtime error: expected the system to be little-endian! (Run with -s SUPPORT_BIG_ENDIAN=1 to bypass)"}();var $=[],q=[],Y=[],K=[],V=!1,Z=!1,J=0;function ee(){return _||0<J}function te(){if(y.preRun)for("function"==typeof y.preRun&&(y.preRun=[y.preRun]);y.preRun.length;)e=y.preRun.shift(),$.unshift(e);var e;we($)}function re(){if(G(),y.postRun)for("function"==typeof y.postRun&&(y.postRun=[y.postRun]);y.postRun.length;)e=y.postRun.shift(),K.unshift(e);var e;we(K)}M(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var ne=0,oe=null,ie=null,ae={};function se(e){for(var t=e;;){if(!ae[e])return e;e=t+Math.random()}}function ce(e){ne++,y.monitorRunDependencies&&y.monitorRunDependencies(ne),e?(M(!ae[e]),ae[e]=1,null===oe&&"undefined"!=typeof setInterval&&(oe=setInterval(function(){if(S)return clearInterval(oe),void(oe=null);var e,t=!1;for(e in ae)t||(t=!0,O("still waiting on run dependencies:")),O("dependency: "+e);t&&O("(end of list)")},1e4))):O("warning: run dependency added without ID")}function le(e){ne--,y.monitorRunDependencies&&y.monitorRunDependencies(ne),e?(M(ae[e]),delete ae[e]):O("warning: run dependency removed without ID"),0==ne&&(null!==oe&&(clearInterval(oe),oe=null),ie&&(e=ie,ie=null,e()))}function de(e){y.onAbort&&y.onAbort(e),O(e+=""),S=!0,D=1,e="abort("+e+") at "+function(){var e=function(){var t=new Error;if(!t.stack){try{throw new Error}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}();y.extraStackTrace&&(e+="\n"+y.extraStackTrace());return be(e)}();e=new WebAssembly.RuntimeError(e);throw a(e),e}y.preloadedImages={},y.preloadedAudios={};var ue,fe,he,pe;function ge(e){return e.startsWith("data:application/octet-stream;base64,")}function me(e){return e.startsWith("file://")}function Ee(r,n){return function(){var e=r,t=n;return n||(t=y.asm),M(V,"native function `"+e+"` called before runtime initialization"),M(!Z,"native function `"+e+"` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),t[r]||M(t[r],"exported native function `"+e+"` not found"),t[r].apply(null,arguments)}}function ye(e){try{if(e==ue&&E)return new Uint8Array(E);if(h)return h(e);throw"both async and sync fetching of the wasm failed"}catch(e){de(e)}}function we(e){for(;0<e.length;){var t,r=e.shift();"function"!=typeof r?"number"==typeof(t=r.func)?void 0===r.arg?z.get(t)():z.get(t)(r.arg):t(void 0===r.arg?null:r.arg):r(y)}}function be(e){return e.replace(/\b_Z[\w\d_]+/g,function(e){var t,t=(t=e,T("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),t);return e===t?e:t+" ["+e+"]"})}function Oe(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){A[this.ptr+4>>2]=e},this.get_type=function(){return A[this.ptr+4>>2]},this.set_destructor=function(e){A[this.ptr+8>>2]=e},this.get_destructor=function(){return A[this.ptr+8>>2]},this.set_refcount=function(e){A[this.ptr>>2]=e},this.set_caught=function(e){P[this.ptr+12>>0]=e=e?1:0},this.get_caught=function(){return 0!=P[this.ptr+12>>0]},this.set_rethrown=function(e){P[this.ptr+13>>0]=e=e?1:0},this.get_rethrown=function(){return 0!=P[this.ptr+13>>0]},this.init=function(e,t){this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=A[this.ptr>>2];A[this.ptr>>2]=e+1},this.release_ref=function(){var e=A[this.ptr>>2];return A[this.ptr>>2]=e-1,M(0<e),1===e}}function Te(e,t){var r=new Date(1e3*A[e>>2]);A[t>>2]=r.getUTCSeconds(),A[t+4>>2]=r.getUTCMinutes(),A[t+8>>2]=r.getUTCHours(),A[t+12>>2]=r.getUTCDate(),A[t+16>>2]=r.getUTCMonth(),A[t+20>>2]=r.getUTCFullYear()-1900,A[t+24>>2]=r.getUTCDay(),A[t+36>>2]=0,A[t+32>>2]=0;e=Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0),e=(r.getTime()-e)/864e5|0;return A[t+28>>2]=e,Te.GMTString||(Te.GMTString=L("GMT")),A[t+40>>2]=Te.GMTString,t}function ve(){var e,t,r,n,o;function i(e){e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return e?e[1]:"GMT"}ve.called||(ve.called=!0,e=(new Date).getFullYear(),t=new Date(e,0,1),r=new Date(e,6,1),n=t.getTimezoneOffset(),o=r.getTimezoneOffset(),e=Math.max(n,o),A[We()>>2]=60*e,A[ze()>>2]=Number(n!=o),t=i(t),r=i(r),t=L(t),r=L(r),o<n?(A[Qe()>>2]=t,A[Qe()+4>>2]=r):(A[Qe()>>2]=r,A[Qe()+4>>2]=t))}y.locateFile?ge(ue="7zz.wasm")||(fe=ue,ue=y.locateFile?y.locateFile(fe,m):m+fe):ue=new URL("7zz.wasm","undefined"==typeof document&&"undefined"==typeof location?new(require("url").URL)("file:"+__filename).href:"undefined"==typeof document?location.href:document.currentScript&&document.currentScript.src||new URL("kookit.umd.js",document.baseURI).href).toString();var _e={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var r=0,n=e.length-1;0<=n;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=!(e=_e.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"))&&!t?".":e)&&r&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=_e.splitPath(e),e=t[0],t=t[1];return e||t?e+(t=t&&t.substr(0,t.length-1)):"."},basename:function(e){if("/"===e)return"/";var t=(e=(e=_e.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return _e.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return _e.normalize(e.join("/"))},join2:function(e,t){return _e.normalize(e+"/"+t)}};var De={resolve:function(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){var n=0<=r?arguments[r]:Fe.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return(t?"/":"")+(e=_e.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"))||"."},relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;0<=r&&""===e[r];r--);return r<t?[]:e.slice(t,r-t+1)}e=De.resolve(e).substr(1),t=De.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),a=i,s=0;s<i;s++)if(n[s]!==o[s]){a=s;break}for(var c=[],s=a;s<n.length;s++)c.push("..");return(c=c.concat(o.slice(a))).join("/")}},Se={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Se.ttys[e]={input:[],output:[],ops:t},Fe.registerDevice(e,Se.stream_ops)},stream_ops:{open:function(e){var t=Se.ttys[e.node.rdev];if(!t)throw new Fe.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,r,n,o){if(!e.tty||!e.tty.ops.get_char)throw new Fe.ErrnoError(60);for(var i,a=0,s=0;s<n;s++){try{i=e.tty.ops.get_char(e.tty)}catch(e){throw new Fe.ErrnoError(29)}if(void 0===i&&0===a)throw new Fe.ErrnoError(6);if(null==i)break;a++,t[r+s]=i}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,r,n,o){if(!e.tty||!e.tty.ops.put_char)throw new Fe.ErrnoError(60);try{for(var i=0;i<n;i++)e.tty.ops.put_char(e.tty,t[r+i])}catch(e){throw new Fe.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),i}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if(i){var r=Buffer.alloc(256),n=0;try{n=p.readSync(process.stdin.fd,r,0,256,null)}catch(e){if(!e.toString().includes("EOF"))throw e;n=0}t=0<n?r.slice(0,n).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n");if(!t)return null;e.input=Le(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(b(N(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(b(N(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(O(N(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(O(N(e.output,0)),e.output=[])}}};function Me(){de("internal error: mmapAlloc called but `memalign` native symbol not exported")}var Re={ops_table:null,mount:function(e){return Re.createNode(null,"/",16895,0)},createNode:function(e,t,r,n){if(Fe.isBlkdev(r)||Fe.isFIFO(r))throw new Fe.ErrnoError(63);Re.ops_table||(Re.ops_table={dir:{node:{getattr:Re.node_ops.getattr,setattr:Re.node_ops.setattr,lookup:Re.node_ops.lookup,mknod:Re.node_ops.mknod,rename:Re.node_ops.rename,unlink:Re.node_ops.unlink,rmdir:Re.node_ops.rmdir,readdir:Re.node_ops.readdir,symlink:Re.node_ops.symlink},stream:{llseek:Re.stream_ops.llseek}},file:{node:{getattr:Re.node_ops.getattr,setattr:Re.node_ops.setattr},stream:{llseek:Re.stream_ops.llseek,read:Re.stream_ops.read,write:Re.stream_ops.write,allocate:Re.stream_ops.allocate,mmap:Re.stream_ops.mmap,msync:Re.stream_ops.msync}},link:{node:{getattr:Re.node_ops.getattr,setattr:Re.node_ops.setattr,readlink:Re.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Re.node_ops.getattr,setattr:Re.node_ops.setattr},stream:Fe.chrdev_stream_ops}});n=Fe.createNode(e,t,r,n);return Fe.isDir(n.mode)?(n.node_ops=Re.ops_table.dir.node,n.stream_ops=Re.ops_table.dir.stream,n.contents={}):Fe.isFile(n.mode)?(n.node_ops=Re.ops_table.file.node,n.stream_ops=Re.ops_table.file.stream,n.usedBytes=0,n.contents=null):Fe.isLink(n.mode)?(n.node_ops=Re.ops_table.link.node,n.stream_ops=Re.ops_table.link.stream):Fe.isChrdev(n.mode)&&(n.node_ops=Re.ops_table.chrdev.node,n.stream_ops=Re.ops_table.chrdev.stream),n.timestamp=Date.now(),e&&(e.contents[t]=n,e.timestamp=n.timestamp),n},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;t<=r||(t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256)),r=e.contents,e.contents=new Uint8Array(t),0<e.usedBytes&&e.contents.set(r.subarray(0,e.usedBytes),0))},resizeFileStorage:function(e,t){var r;e.usedBytes!=t&&(0==t?(e.contents=null,e.usedBytes=0):(r=e.contents,e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t))},node_ops:{getattr:function(e){var t={};return t.dev=Fe.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Fe.isDir(e.mode)?t.size=4096:Fe.isFile(e.mode)?t.size=e.usedBytes:Fe.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Re.resizeFileStorage(e,t.size)},lookup:function(e,t){throw Fe.genericErrors[44]},mknod:function(e,t,r,n){return Re.createNode(e,t,r,n)},rename:function(e,t,r){if(Fe.isDir(e.mode)){var n;try{n=Fe.lookupNode(t,r)}catch(e){}if(n)for(var o in n.contents)throw new Fe.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){for(var r in Fe.lookupNode(e,t).contents)throw new Fe.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t,r=[".",".."];for(t in e.contents)e.contents.hasOwnProperty(t)&&r.push(t);return r},symlink:function(e,t,r){t=Re.createNode(e,t,41471,0);return t.link=r,t},readlink:function(e){if(!Fe.isLink(e.mode))throw new Fe.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,n,o){var i=e.node.contents;if(o>=e.node.usedBytes)return 0;var a=Math.min(e.node.usedBytes-o,n);if(M(0<=a),8<a&&i.subarray)t.set(i.subarray(o,o+a),r);else for(var s=0;s<a;s++)t[r+s]=i[o+s];return a},write:function(e,t,r,n,o,i){if(M(!(t instanceof ArrayBuffer)),t.buffer===P.buffer&&(i=!1),!n)return 0;var a=e.node;if(a.timestamp=Date.now(),t.subarray&&(!a.contents||a.contents.subarray)){if(i)return M(0===o,"canOwn must imply no weird position inside the file"),a.contents=t.subarray(r,r+n),a.usedBytes=n;if(0===a.usedBytes&&0===o)return a.contents=t.slice(r,r+n),a.usedBytes=n;if(o+n<=a.usedBytes)return a.contents.set(t.subarray(r,r+n),o),n}if(Re.expandFileStorage(a,o+n),a.contents.subarray&&t.subarray)a.contents.set(t.subarray(r,r+n),o);else for(var s=0;s<n;s++)a.contents[o+s]=t[r+s];return a.usedBytes=Math.max(a.usedBytes,o+n),n},llseek:function(e,t,r){if(1===r?t+=e.position:2===r&&Fe.isFile(e.node.mode)&&(t+=e.node.usedBytes),t<0)throw new Fe.ErrnoError(28);return t},allocate:function(e,t,r){Re.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,n,o,i){if(0!==t)throw new Fe.ErrnoError(28);if(!Fe.isFile(e.node.mode))throw new Fe.ErrnoError(43);var a,s,e=e.node.contents;if(2&i||e.buffer!==R){if((0<n||n+r<e.length)&&(e=e.subarray?e.subarray(n,n+r):Array.prototype.slice.call(e,n,n+r)),s=!0,!(a=Me()))throw new Fe.ErrnoError(48);P.set(e,a)}else s=!1,a=e.byteOffset;return{ptr:a,allocated:s}},msync:function(e,t,r,n,o){if(!Fe.isFile(e.node.mode))throw new Fe.ErrnoError(43);return 2&o||Re.stream_ops.write(e,t,0,n,r,!1),0}}};var Pe={},ke={isWindows:!1,staticInit:function(){ke.isWindows=!!process.platform.match(/^win/);var e=process.binding("constants");e.fs&&(e=e.fs),ke.flagsForNodeMap={1024:e.O_APPEND,64:e.O_CREAT,128:e.O_EXCL,256:e.O_NOCTTY,0:e.O_RDONLY,2:e.O_RDWR,4096:e.O_SYNC,512:e.O_TRUNC,1:e.O_WRONLY}},convertNodeCode:function(e){e=e.code;return M(e in Pe),Pe[e]},mount:function(e){return M(i),ke.createNode(null,"/",ke.getMode(e.opts.root),0)},createNode:function(e,t,r,n){if(!Fe.isDir(r)&&!Fe.isFile(r)&&!Fe.isLink(r))throw new Fe.ErrnoError(28);r=Fe.createNode(e,t,r);return r.node_ops=ke.node_ops,r.stream_ops=ke.stream_ops,r},getMode:function(e){var t;try{t=Ce.lstatSync(e),ke.isWindows&&(t.mode=t.mode|(292&t.mode)>>2)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}return t.mode},realPath:function(e){for(var t=[];e.parent!==e;)t.push(e.name),e=e.parent;return t.push(e.mount.opts.root),t.reverse(),_e.join.apply(null,t)},flagsForNode:function(e){e&=-2097153,e&=-2049,e&=-32769,e&=-524289;var t,r=0;for(t in ke.flagsForNodeMap)e&t&&(r|=ke.flagsForNodeMap[t],e^=t);if(e)throw new Fe.ErrnoError(28);return r},node_ops:{getattr:function(e){var t,e=ke.realPath(e);try{t=Ce.lstatSync(e)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}return ke.isWindows&&!t.blksize&&(t.blksize=4096),ke.isWindows&&!t.blocks&&(t.blocks=(t.size+t.blksize-1)/t.blksize|0),{dev:t.dev,ino:t.ino,mode:t.mode,nlink:t.nlink,uid:t.uid,gid:t.gid,rdev:t.rdev,size:t.size,atime:t.atime,mtime:t.mtime,ctime:t.ctime,blksize:t.blksize,blocks:t.blocks}},setattr:function(e,t){var r,n=ke.realPath(e);try{void 0!==t.mode&&(Ce.chmodSync(n,t.mode),e.mode=t.mode),void 0!==t.timestamp&&(r=new Date(t.timestamp),Ce.utimesSync(n,r,r)),void 0!==t.size&&Ce.truncateSync(n,t.size)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},lookup:function(e,t){var r=_e.join2(ke.realPath(e),t),r=ke.getMode(r);return ke.createNode(e,t,r)},mknod:function(e,t,r,n){r=ke.createNode(e,t,r,n),n=ke.realPath(r);try{Fe.isDir(r.mode)?Ce.mkdirSync(n,r.mode):Ce.writeFileSync(n,"",{mode:r.mode})}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}return r},rename:function(e,t,r){var n=ke.realPath(e),t=_e.join2(ke.realPath(t),r);try{Ce.renameSync(n,t)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}e.name=r},unlink:function(e,t){t=_e.join2(ke.realPath(e),t);try{Ce.unlinkSync(t)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},rmdir:function(e,t){t=_e.join2(ke.realPath(e),t);try{Ce.rmdirSync(t)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},readdir:function(e){e=ke.realPath(e);try{return Ce.readdirSync(e)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},symlink:function(e,t,r){t=_e.join2(ke.realPath(e),t);try{Ce.symlinkSync(r,t)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},readlink:function(e){var t=ke.realPath(e);try{return t=Ce.readlinkSync(t),je.relative(je.resolve(e.mount.opts.root),t)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}}},stream_ops:{open:function(e){var t=ke.realPath(e.node);try{Fe.isFile(e.node.mode)&&(e.nfd=Ce.openSync(t,ke.flagsForNode(e.flags)))}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},close:function(e){try{Fe.isFile(e.node.mode)&&e.nfd&&Ce.closeSync(e.nfd)}catch(e){if(!e.code)throw e;throw new Fe.ErrnoError(ke.convertNodeCode(e))}},read:function(e,t,r,n,o){if(0===n)return 0;try{return Ce.readSync(e.nfd,Buffer.from(t.buffer),r,n,o)}catch(e){throw new Fe.ErrnoError(ke.convertNodeCode(e))}},write:function(e,t,r,n,o){try{return Ce.writeSync(e.nfd,Buffer.from(t.buffer),r,n,o)}catch(e){throw new Fe.ErrnoError(ke.convertNodeCode(e))}},llseek:function(e,t,r){if(1===r)t+=e.position;else if(2===r&&Fe.isFile(e.node.mode))try{t+=Ce.fstatSync(e.nfd).size}catch(e){throw new Fe.ErrnoError(ke.convertNodeCode(e))}if(t<0)throw new Fe.ErrnoError(28);return t},mmap:function(e,t,r,n,o,i){if(0!==t)throw new Fe.ErrnoError(28);if(!Fe.isFile(e.node.mode))throw new Fe.ErrnoError(43);Me();return ke.stream_ops.read(e,P,void 0,r,n),{ptr:void 0,allocated:!0}},msync:function(e,t,r,n,o){if(!Fe.isFile(e.node.mode))throw new Fe.ErrnoError(43);return 2&o||ke.stream_ops.write(e,t,0,n,r,!1),0}}},xe={DIR_MODE:16895,FILE_MODE:33279,reader:null,mount:function(e){M(d),xe.reader||(xe.reader=new FileReaderSync);var i=xe.createNode(null,"/",xe.DIR_MODE,0),a={};function n(e){for(var t=e.split("/"),r=i,n=0;n<t.length-1;n++){var o=t.slice(0,n+1).join("/");a[o]||(a[o]=xe.createNode(r,t[n],xe.DIR_MODE,0)),r=a[o]}return r}function o(e){e=e.split("/");return e[e.length-1]}return Array.prototype.forEach.call(e.opts.files||[],function(e){xe.createNode(n(e.name),o(e.name),xe.FILE_MODE,0,e,e.lastModifiedDate)}),(e.opts.blobs||[]).forEach(function(e){xe.createNode(n(e.name),o(e.name),xe.FILE_MODE,0,e.data)}),(e.opts.packages||[]).forEach(function(r){r.metadata.files.forEach(function(e){var t=e.filename.substr(1);xe.createNode(n(t),o(t),xe.FILE_MODE,0,r.blob.slice(e.start,e.end))})}),i},createNode:function(e,t,r,n,o,i){var a=Fe.createNode(e,t,r);return a.mode=r,a.node_ops=xe.node_ops,a.stream_ops=xe.stream_ops,a.timestamp=(i||new Date).getTime(),M(xe.FILE_MODE!==xe.DIR_MODE),r===xe.FILE_MODE?(a.size=o.size,a.contents=o):(a.size=4096,a.contents={}),e&&(e.contents[t]=a),a},node_ops:{getattr:function(e){return{dev:1,ino:e.id,mode:e.mode,nlink:1,uid:0,gid:0,rdev:void 0,size:e.size,atime:new Date(e.timestamp),mtime:new Date(e.timestamp),ctime:new Date(e.timestamp),blksize:4096,blocks:Math.ceil(e.size/4096)}},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp)},lookup:function(e,t){throw new Fe.ErrnoError(44)},mknod:function(e,t,r,n){throw new Fe.ErrnoError(63)},rename:function(e,t,r){throw new Fe.ErrnoError(63)},unlink:function(e,t){throw new Fe.ErrnoError(63)},rmdir:function(e,t){throw new Fe.ErrnoError(63)},readdir:function(e){var t,r=[".",".."];for(t in e.contents)e.contents.hasOwnProperty(t)&&r.push(t);return r},symlink:function(e,t,r){throw new Fe.ErrnoError(63)},readlink:function(e){throw new Fe.ErrnoError(63)}},stream_ops:{read:function(e,t,r,n,o){if(o>=e.node.size)return 0;o=e.node.contents.slice(o,o+n),n=xe.reader.readAsArrayBuffer(o);return t.set(new Uint8Array(n),r),o.size},write:function(e,t,r,n,o){throw new Fe.ErrnoError(29)},llseek:function(e,t,r){if(1===r?t+=e.position:2===r&&Fe.isFile(e.node.mode)&&(t+=e.node.size),t<0)throw new Fe.ErrnoError(28);return t}}},Ae={0:"Success",1:"Arg list too long",2:"Permission denied",3:"Address already in use",4:"Address not available",5:"Address family not supported by protocol family",6:"No more processes",7:"Socket already connected",8:"Bad file number",9:"Trying to read unreadable message",10:"Mount device busy",11:"Operation canceled",12:"No children",13:"Connection aborted",14:"Connection refused",15:"Connection reset by peer",16:"File locking deadlock error",17:"Destination address required",18:"Math arg out of domain of func",19:"Quota exceeded",20:"File exists",21:"Bad address",22:"File too large",23:"Host is unreachable",24:"Identifier removed",25:"Illegal byte sequence",26:"Connection already in progress",27:"Interrupted system call",28:"Invalid argument",29:"I/O error",30:"Socket is already connected",31:"Is a directory",32:"Too many symbolic links",33:"Too many open files",34:"Too many links",35:"Message too long",36:"Multihop attempted",37:"File or path name too long",38:"Network interface is not configured",39:"Connection reset by network",40:"Network is unreachable",41:"Too many open files in system",42:"No buffer space available",43:"No such device",44:"No such file or directory",45:"Exec format error",46:"No record locks available",47:"The link has been severed",48:"Not enough core",49:"No message of desired type",50:"Protocol not available",51:"No space left on device",52:"Function not implemented",53:"Socket is not connected",54:"Not a directory",55:"Directory not empty",56:"State not recoverable",57:"Socket operation on non-socket",59:"Not a typewriter",60:"No such device or address",61:"Value too large for defined data type",62:"Previous owner died",63:"Not super-user",64:"Broken pipe",65:"Protocol error",66:"Unknown protocol",67:"Protocol wrong type for socket",68:"Math result not representable",69:"Read only file system",70:"Illegal seek",71:"No such process",72:"Stale file handle",73:"Connection timed out",74:"Text file busy",75:"Cross-device link",100:"Device not a stream",101:"Bad font file fmt",102:"Invalid slot",103:"Invalid request code",104:"No anode",105:"Block device required",106:"Channel number out of range",107:"Level 3 halted",108:"Level 3 reset",109:"Link number out of range",110:"Protocol driver not attached",111:"No CSI structure available",112:"Level 2 halted",113:"Invalid exchange",114:"Invalid request descriptor",115:"Exchange full",116:"No data (for no delay io)",117:"Timer expired",118:"Out of streams resources",119:"Machine is not on the network",120:"Package not installed",121:"The object is remote",122:"Advertise error",123:"Srmount error",124:"Communication error on send",125:"Cross mount point (not really error)",126:"Given log. name not unique",127:"f.d. invalid for this operation",128:"Remote address changed",129:"Can   access a needed shared lib",130:"Accessing a corrupted shared lib",131:".lib section in a.out corrupted",132:"Attempting to link in too many libs",133:"Attempting to exec a shared library",135:"Streams pipe error",136:"Too many users",137:"Socket type not supported",138:"Not supported",139:"Protocol family not supported",140:"Can't send after socket shutdown",141:"Too many references",142:"Host is down",148:"No medium (in tape drive)",156:"Level 2 not synchronized"},Fe={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(e,t){if(t=t||{},!(e=De.resolve(Fe.cwd(),e)))return{path:"",node:null};var r,n={follow_mount:!0,recurse_count:0};for(r in n)void 0===t[r]&&(t[r]=n[r]);if(8<t.recurse_count)throw new Fe.ErrnoError(32);for(var o=_e.normalizeArray(e.split("/").filter(function(e){return!!e}),!1),i=Fe.root,a="/",s=0;s<o.length;s++){var c=s===o.length-1;if(c&&t.parent)break;if(i=Fe.lookupNode(i,o[s]),a=_e.join2(a,o[s]),Fe.isMountpoint(i)&&(c&&!t.follow_mount||(i=i.mounted.root)),!c||t.follow)for(var l=0;Fe.isLink(i.mode);){var d=Fe.readlink(a),a=De.resolve(_e.dirname(a),d),i=Fe.lookupPath(a,{recurse_count:t.recurse_count}).node;if(40<l++)throw new Fe.ErrnoError(32)}}return{path:a,node:i}},getPath:function(e){for(var t;;){if(Fe.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%Fe.nameTable.length},hashAddNode:function(e){var t=Fe.hashName(e.parent.id,e.name);e.name_next=Fe.nameTable[t],Fe.nameTable[t]=e},hashRemoveNode:function(e){var t=Fe.hashName(e.parent.id,e.name);if(Fe.nameTable[t]===e)Fe.nameTable[t]=e.name_next;else for(var r=Fe.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:function(e,t){var r=Fe.mayLookup(e);if(r)throw new Fe.ErrnoError(r,e);for(var r=Fe.hashName(e.id,t),n=Fe.nameTable[r];n;n=n.name_next){var o=n.name;if(n.parent.id===e.id&&o===t)return n}return Fe.lookup(e,t)},createNode:function(e,t,r,n){M("object"==typeof e);n=new Fe.FSNode(e,t,r,n);return Fe.hashAddNode(n),n},destroyNode:function(e){Fe.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(e){var t=Fe.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return Fe.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2},mayLookup:function(e){var t=Fe.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{Fe.lookupNode(e,t);return 20}catch(e){}return Fe.nodePermissions(e,"wx")},mayDelete:function(e,t,r){var n;try{n=Fe.lookupNode(e,t)}catch(e){return e.errno}e=Fe.nodePermissions(e,"wx");if(e)return e;if(r){if(!Fe.isDir(n.mode))return 54;if(Fe.isRoot(n)||Fe.getPath(n)===Fe.cwd())return 10}else if(Fe.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?Fe.isLink(e.mode)?32:Fe.isDir(e.mode)&&("r"!==Fe.flagsToPermissionString(t)||512&t)?31:Fe.nodePermissions(e,Fe.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){t=t||Fe.MAX_OPEN_FDS;for(var r=e=e||0;r<=t;r++)if(!Fe.streams[r])return r;throw new Fe.ErrnoError(33)},getStream:function(e){return Fe.streams[e]},createStream:function(e,t,r){Fe.FSStream||(Fe.FSStream=function(){},Fe.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var n,o=new Fe.FSStream;for(n in e)o[n]=e[n];e=o;r=Fe.nextfd(t,r);return e.fd=r,Fe.streams[r]=e},closeStream:function(e){Fe.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=Fe.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new Fe.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){Fe.devices[e]={stream_ops:t}},getDevice:function(e){return Fe.devices[e]},getMounts:function(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs:function(t,r){"function"==typeof t&&(r=t,t=!1),Fe.syncFSRequests++,1<Fe.syncFSRequests&&O("warning: "+Fe.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var n=Fe.getMounts(Fe.root.mount),o=0;function i(e){return M(0<Fe.syncFSRequests),Fe.syncFSRequests--,r(e)}function a(e){if(e)return a.errored?void 0:(a.errored=!0,i(e));++o>=n.length&&i(null)}n.forEach(function(e){return e.type.syncfs?void e.type.syncfs(e,t,a):a(null)})},mount:function(e,t,r){if("string"==typeof e)throw e;var n="/"===r,o=!r;if(n&&Fe.root)throw new Fe.ErrnoError(10);if(!n&&!o){var i=Fe.lookupPath(r,{follow_mount:!1});if(r=i.path,i=i.node,Fe.isMountpoint(i))throw new Fe.ErrnoError(10);if(!Fe.isDir(i.mode))throw new Fe.ErrnoError(54)}r={type:e,opts:t,mountpoint:r,mounts:[]},e=e.mount(r);return(e.mount=r).root=e,n?Fe.root=e:i&&(i.mounted=r,i.mount&&i.mount.mounts.push(r)),e},unmount:function(e){var t=Fe.lookupPath(e,{follow_mount:!1});if(!Fe.isMountpoint(t.node))throw new Fe.ErrnoError(28);var e=t.node,t=e.mounted,n=Fe.getMounts(t);Object.keys(Fe.nameTable).forEach(function(e){for(var t=Fe.nameTable[e];t;){var r=t.name_next;n.includes(t.mount)&&Fe.destroyNode(t),t=r}}),e.mounted=null;t=e.mount.mounts.indexOf(t);M(-1!==t),e.mount.mounts.splice(t,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,r){var n=Fe.lookupPath(e,{parent:!0}).node,o=_e.basename(e);if(!o||"."===o||".."===o)throw new Fe.ErrnoError(28);e=Fe.mayCreate(n,o);if(e)throw new Fe.ErrnoError(e);if(!n.node_ops.mknod)throw new Fe.ErrnoError(63);return n.node_ops.mknod(n,o,t,r)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,Fe.mknod(e,t|=32768,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,Fe.mknod(e,t|=16384,0)},mkdirTree:function(e,t){for(var r=e.split("/"),n="",o=0;o<r.length;++o)if(r[o]){n+="/"+r[o];try{Fe.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:function(e,t,r){return void 0===r&&(r=t,t=438),Fe.mknod(e,t|=8192,r)},symlink:function(e,t){if(!De.resolve(e))throw new Fe.ErrnoError(44);var r=Fe.lookupPath(t,{parent:!0}).node;if(!r)throw new Fe.ErrnoError(44);var n=_e.basename(t),t=Fe.mayCreate(r,n);if(t)throw new Fe.ErrnoError(t);if(!r.node_ops.symlink)throw new Fe.ErrnoError(63);return r.node_ops.symlink(r,n,e)},rename:function(t,r){var e=_e.dirname(t),n=_e.dirname(r),o=_e.basename(t),i=_e.basename(r),a=Fe.lookupPath(t,{parent:!0}),s=a.node,c=Fe.lookupPath(r,{parent:!0}).node;if(!s||!c)throw new Fe.ErrnoError(44);if(s.mount!==c.mount)throw new Fe.ErrnoError(75);var l,a=Fe.lookupNode(s,o),n=De.relative(t,n);if("."!==n.charAt(0))throw new Fe.ErrnoError(28);if("."!==(n=De.relative(r,e)).charAt(0))throw new Fe.ErrnoError(55);try{l=Fe.lookupNode(c,i)}catch(e){}if(a!==l){n=Fe.isDir(a.mode),o=Fe.mayDelete(s,o,n);if(o)throw new Fe.ErrnoError(o);if(o=l?Fe.mayDelete(c,i,n):Fe.mayCreate(c,i))throw new Fe.ErrnoError(o);if(!s.node_ops.rename)throw new Fe.ErrnoError(63);if(Fe.isMountpoint(a)||l&&Fe.isMountpoint(l))throw new Fe.ErrnoError(10);if(c!==s&&(o=Fe.nodePermissions(s,"w")))throw new Fe.ErrnoError(o);try{Fe.trackingDelegate.willMovePath&&Fe.trackingDelegate.willMovePath(t,r)}catch(e){O("FS.trackingDelegate['willMovePath']('"+t+"', '"+r+"') threw an exception: "+e.message)}Fe.hashRemoveNode(a);try{s.node_ops.rename(a,c,i)}catch(e){throw e}finally{Fe.hashAddNode(a)}try{Fe.trackingDelegate.onMovePath&&Fe.trackingDelegate.onMovePath(t,r)}catch(e){O("FS.trackingDelegate['onMovePath']('"+t+"', '"+r+"') threw an exception: "+e.message)}}},rmdir:function(t){var e=Fe.lookupPath(t,{parent:!0}).node,r=_e.basename(t),n=Fe.lookupNode(e,r),o=Fe.mayDelete(e,r,!0);if(o)throw new Fe.ErrnoError(o);if(!e.node_ops.rmdir)throw new Fe.ErrnoError(63);if(Fe.isMountpoint(n))throw new Fe.ErrnoError(10);try{Fe.trackingDelegate.willDeletePath&&Fe.trackingDelegate.willDeletePath(t)}catch(e){O("FS.trackingDelegate['willDeletePath']('"+t+"') threw an exception: "+e.message)}e.node_ops.rmdir(e,r),Fe.destroyNode(n);try{Fe.trackingDelegate.onDeletePath&&Fe.trackingDelegate.onDeletePath(t)}catch(e){O("FS.trackingDelegate['onDeletePath']('"+t+"') threw an exception: "+e.message)}},readdir:function(e){e=Fe.lookupPath(e,{follow:!0}).node;if(!e.node_ops.readdir)throw new Fe.ErrnoError(54);return e.node_ops.readdir(e)},unlink:function(t){var e=Fe.lookupPath(t,{parent:!0}).node,r=_e.basename(t),n=Fe.lookupNode(e,r),o=Fe.mayDelete(e,r,!1);if(o)throw new Fe.ErrnoError(o);if(!e.node_ops.unlink)throw new Fe.ErrnoError(63);if(Fe.isMountpoint(n))throw new Fe.ErrnoError(10);try{Fe.trackingDelegate.willDeletePath&&Fe.trackingDelegate.willDeletePath(t)}catch(e){O("FS.trackingDelegate['willDeletePath']('"+t+"') threw an exception: "+e.message)}e.node_ops.unlink(e,r),Fe.destroyNode(n);try{Fe.trackingDelegate.onDeletePath&&Fe.trackingDelegate.onDeletePath(t)}catch(e){O("FS.trackingDelegate['onDeletePath']('"+t+"') threw an exception: "+e.message)}},readlink:function(e){e=Fe.lookupPath(e).node;if(!e)throw new Fe.ErrnoError(44);if(!e.node_ops.readlink)throw new Fe.ErrnoError(28);return De.resolve(Fe.getPath(e.parent),e.node_ops.readlink(e))},stat:function(e,t){t=Fe.lookupPath(e,{follow:!t}).node;if(!t)throw new Fe.ErrnoError(44);if(!t.node_ops.getattr)throw new Fe.ErrnoError(63);return t.node_ops.getattr(t)},lstat:function(e){return Fe.stat(e,!0)},chmod:function(e,t,r){if(!(e="string"==typeof e?Fe.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new Fe.ErrnoError(63);e.node_ops.setattr(e,{mode:4095&t|-4096&e.mode,timestamp:Date.now()})},lchmod:function(e,t){Fe.chmod(e,t,!0)},fchmod:function(e,t){e=Fe.getStream(e);if(!e)throw new Fe.ErrnoError(8);Fe.chmod(e.node,t)},chown:function(e,t,r,n){if(!(e="string"==typeof e?Fe.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new Fe.ErrnoError(63);e.node_ops.setattr(e,{timestamp:Date.now()})},lchown:function(e,t,r){Fe.chown(e,t,r,!0)},fchown:function(e,t,r){e=Fe.getStream(e);if(!e)throw new Fe.ErrnoError(8);Fe.chown(e.node,t,r)},truncate:function(e,t){if(t<0)throw new Fe.ErrnoError(28);var r;if(!(r="string"==typeof e?Fe.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new Fe.ErrnoError(63);if(Fe.isDir(r.mode))throw new Fe.ErrnoError(31);if(!Fe.isFile(r.mode))throw new Fe.ErrnoError(28);e=Fe.nodePermissions(r,"w");if(e)throw new Fe.ErrnoError(e);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){e=Fe.getStream(e);if(!e)throw new Fe.ErrnoError(8);if(0==(2097155&e.flags))throw new Fe.ErrnoError(28);Fe.truncate(e.node,t)},utime:function(e,t,r){e=Fe.lookupPath(e,{follow:!0}).node;e.node_ops.setattr(e,{timestamp:Math.max(t,r)})},open:function(t,e,r,n,o){if(""===t)throw new Fe.ErrnoError(44);if(r=void 0===r?438:r,r=64&(e="string"==typeof e?Fe.modeStringToFlags(e):e)?4095&r|32768:0,"object"==typeof t)i=t;else{t=_e.normalize(t);try{var i=Fe.lookupPath(t,{follow:!(131072&e)}).node}catch(e){}}var a=!1;if(64&e)if(i){if(128&e)throw new Fe.ErrnoError(20)}else i=Fe.mknod(t,r,0),a=!0;if(!i)throw new Fe.ErrnoError(44);if(Fe.isChrdev(i.mode)&&(e&=-513),65536&e&&!Fe.isDir(i.mode))throw new Fe.ErrnoError(54);if(!a){a=Fe.mayOpen(i,e);if(a)throw new Fe.ErrnoError(a)}512&e&&Fe.truncate(i,0),e&=-131713;var s,o=Fe.createStream({node:i,path:Fe.getPath(i),flags:e,seekable:!0,position:0,stream_ops:i.stream_ops,ungotten:[],error:!1},n,o);o.stream_ops.open&&o.stream_ops.open(o),!y.logReadFiles||1&e||(Fe.readFiles||(Fe.readFiles={}),t in Fe.readFiles||(Fe.readFiles[t]=1,O("FS.trackingDelegate error on read file: "+t)));try{Fe.trackingDelegate.onOpenFile&&(s=0,1!=(2097155&e)&&(s|=Fe.tracking.openFlags.READ),0!=(2097155&e)&&(s|=Fe.tracking.openFlags.WRITE),Fe.trackingDelegate.onOpenFile(t,s))}catch(e){O("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return o},close:function(e){if(Fe.isClosed(e))throw new Fe.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{Fe.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,r){if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Fe.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new Fe.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:function(e,t,r,n,o){if(n<0||o<0)throw new Fe.ErrnoError(28);if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(1==(2097155&e.flags))throw new Fe.ErrnoError(8);if(Fe.isDir(e.node.mode))throw new Fe.ErrnoError(31);if(!e.stream_ops.read)throw new Fe.ErrnoError(28);var i=void 0!==o;if(i){if(!e.seekable)throw new Fe.ErrnoError(70)}else o=e.position;o=e.stream_ops.read(e,t,r,n,o);return i||(e.position+=o),o},write:function(t,e,r,n,o,i){if(n<0||o<0)throw new Fe.ErrnoError(28);if(Fe.isClosed(t))throw new Fe.ErrnoError(8);if(0==(2097155&t.flags))throw new Fe.ErrnoError(8);if(Fe.isDir(t.node.mode))throw new Fe.ErrnoError(31);if(!t.stream_ops.write)throw new Fe.ErrnoError(28);t.seekable&&1024&t.flags&&Fe.llseek(t,0,2);var a=void 0!==o;if(a){if(!t.seekable)throw new Fe.ErrnoError(70)}else o=t.position;i=t.stream_ops.write(t,e,r,n,o,i);a||(t.position+=i);try{t.path&&Fe.trackingDelegate.onWriteToFile&&Fe.trackingDelegate.onWriteToFile(t.path)}catch(e){O("FS.trackingDelegate['onWriteToFile']('"+t.path+"') threw an exception: "+e.message)}return i},allocate:function(e,t,r){if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(t<0||r<=0)throw new Fe.ErrnoError(28);if(0==(2097155&e.flags))throw new Fe.ErrnoError(8);if(!Fe.isFile(e.node.mode)&&!Fe.isDir(e.node.mode))throw new Fe.ErrnoError(43);if(!e.stream_ops.allocate)throw new Fe.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:function(e,t,r,n,o,i){if(0!=(2&o)&&0==(2&i)&&2!=(2097155&e.flags))throw new Fe.ErrnoError(2);if(1==(2097155&e.flags))throw new Fe.ErrnoError(2);if(!e.stream_ops.mmap)throw new Fe.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,o,i)},msync:function(e,t,r,n,o){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,o):0},munmap:function(e){return 0},ioctl:function(e,t,r){if(!e.stream_ops.ioctl)throw new Fe.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:function(e,t){if((t=t||{}).flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var r,n=Fe.open(e,t.flags),o=Fe.stat(e).size,e=new Uint8Array(o);return Fe.read(n,e,0,o,0),"utf8"===t.encoding?r=N(e,0):"binary"===t.encoding&&(r=e),Fe.close(n),r},writeFile:function(e,t,r){(r=r||{}).flags=r.flags||577;var n=Fe.open(e,r.flags,r.mode);if("string"==typeof t){var o=new Uint8Array(j(t)+1),e=U(t,o,0,o.length);Fe.write(n,o,0,e,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Fe.write(n,t,0,t.byteLength,void 0,r.canOwn)}Fe.close(n)},cwd:function(){return Fe.currentPath},chdir:function(e){var t=Fe.lookupPath(e,{follow:!0});if(null===t.node)throw new Fe.ErrnoError(44);if(!Fe.isDir(t.node.mode))throw new Fe.ErrnoError(54);e=Fe.nodePermissions(t.node,"x");if(e)throw new Fe.ErrnoError(e);Fe.currentPath=t.path},createDefaultDirectories:function(){Fe.mkdir("/tmp"),Fe.mkdir("/home"),Fe.mkdir("/home/web_user")},createDefaultDevices:function(){Fe.mkdir("/dev"),Fe.registerDevice(Fe.makedev(1,3),{read:function(){return 0},write:function(e,t,r,n,o){return n}}),Fe.mkdev("/dev/null",Fe.makedev(1,3)),Se.register(Fe.makedev(5,0),Se.default_tty_ops),Se.register(Fe.makedev(6,0),Se.default_tty1_ops),Fe.mkdev("/dev/tty",Fe.makedev(5,0)),Fe.mkdev("/dev/tty1",Fe.makedev(6,0));var e=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}if(i)try{var t=require("crypto");return function(){return t.randomBytes(1)[0]}}catch(e){}return function(){de("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: function(array) { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")}}();Fe.createDevice("/dev","random",e),Fe.createDevice("/dev","urandom",e),Fe.mkdir("/dev/shm"),Fe.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){Fe.mkdir("/proc");var t=Fe.mkdir("/proc/self");Fe.mkdir("/proc/self/fd"),Fe.mount({mount:function(){var e=Fe.createNode(t,"fd",16895,73);return e.node_ops={lookup:function(e,t){var r=Fe.getStream(+t);if(!r)throw new Fe.ErrnoError(8);t={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return r.path}}};return t.parent=t}},e}},{},"/proc/self/fd")},createStandardStreams:function(){y.stdin?Fe.createDevice("/dev","stdin",y.stdin):Fe.symlink("/dev/tty","/dev/stdin"),y.stdout?Fe.createDevice("/dev","stdout",null,y.stdout):Fe.symlink("/dev/tty","/dev/stdout"),y.stderr?Fe.createDevice("/dev","stderr",null,y.stderr):Fe.symlink("/dev/tty1","/dev/stderr");var e=Fe.open("/dev/stdin",0),t=Fe.open("/dev/stdout",1),r=Fe.open("/dev/stderr",1);M(0===e.fd,"invalid handle for stdin ("+e.fd+")"),M(1===t.fd,"invalid handle for stdout ("+t.fd+")"),M(2===r.fd,"invalid handle for stderr ("+r.fd+")")},ensureErrnoError:function(){Fe.ErrnoError||(Fe.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){for(var t in this.errno=e,Pe)if(Pe[t]===e){this.code=t;break}},this.setErrno(e),this.message=Ae[e],this.stack&&(Object.defineProperty(this,"stack",{value:(new Error).stack,writable:!0}),this.stack=be(this.stack))},Fe.ErrnoError.prototype=new Error,Fe.ErrnoError.prototype.constructor=Fe.ErrnoError,[44].forEach(function(e){Fe.genericErrors[e]=new Fe.ErrnoError(e),Fe.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){Fe.ensureErrnoError(),Fe.nameTable=new Array(4096),Fe.mount(Re,{},"/"),Fe.createDefaultDirectories(),Fe.createDefaultDevices(),Fe.createSpecialDirectories(),Fe.filesystems={MEMFS:Re,NODEFS:ke,WORKERFS:xe}},init:function(e,t,r){M(!Fe.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),Fe.init.initialized=!0,Fe.ensureErrnoError(),y.stdin=e||y.stdin,y.stdout=t||y.stdout,y.stderr=r||y.stderr,Fe.createStandardStreams()},quit:function(){Fe.init.initialized=!1;var e=y._fflush;e&&e(0);for(var t=0;t<Fe.streams.length;t++){var r=Fe.streams[t];r&&Fe.close(r)}},getMode:function(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r},findObject:function(e,t){t=Fe.analyzePath(e,t);return t.exists?t.object:null},analyzePath:function(e,t){try{e=(n=Fe.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=Fe.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=_e.basename(e),n=Fe.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(e){r.error=e.errno}return r},createPath:function(e,t,r,n){e="string"==typeof e?e:Fe.getPath(e);for(var o=t.split("/").reverse();o.length;){var i=o.pop();if(i){var a=_e.join2(e,i);try{Fe.mkdir(a)}catch(e){}e=a}}return a},createFile:function(e,t,r,n,o){t=_e.join2("string"==typeof e?e:Fe.getPath(e),t),o=Fe.getMode(n,o);return Fe.create(t,o)},createDataFile:function(e,t,r,n,o,i){e=t?_e.join2("string"==typeof e?e:Fe.getPath(e),t):e,n=Fe.getMode(n,o),o=Fe.create(e,n);if(r){if("string"==typeof r){for(var a=new Array(r.length),s=0,c=r.length;s<c;++s)a[s]=r.charCodeAt(s);r=a}Fe.chmod(o,146|n);e=Fe.open(o,577);Fe.write(e,r,0,r.length,0,i),Fe.close(e),Fe.chmod(o,n)}return o},createDevice:function(e,t,c,a){var r=_e.join2("string"==typeof e?e:Fe.getPath(e),t),e=Fe.getMode(!!c,!!a);Fe.createDevice.major||(Fe.createDevice.major=64);t=Fe.makedev(Fe.createDevice.major++,0);return Fe.registerDevice(t,{open:function(e){e.seekable=!1},close:function(e){a&&a.buffer&&a.buffer.length&&a(10)},read:function(e,t,r,n,o){for(var i,a=0,s=0;s<n;s++){try{i=c()}catch(e){throw new Fe.ErrnoError(29)}if(void 0===i&&0===a)throw new Fe.ErrnoError(6);if(null==i)break;a++,t[r+s]=i}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,r,n,o){for(var i=0;i<n;i++)try{a(t[r+i])}catch(e){throw new Fe.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),i}}),Fe.mkdev(r,e,t)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!f)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=Le(f(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new Fe.ErrnoError(29)}},createLazyFile:function(e,t,a,r,n){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,e=e/this.chunkSize|0;return this.getter(e)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",a,!1),e.send(null),!(200<=e.status&&e.status<300||304===e.status))throw new Error("Couldn't load "+a+". Status: "+e.status);var n=Number(e.getResponseHeader("Content-length")),t=(r=e.getResponseHeader("Accept-Ranges"))&&"bytes"===r,r=(r=e.getResponseHeader("Content-Encoding"))&&"gzip"===r,o=1048576;t||(o=n);var i=this;i.setDataGetter(function(e){var t=e*o,r=(e+1)*o-1,r=Math.min(r,n-1);if(void 0===i.chunks[e]&&(i.chunks[e]=function(e,t){if(t<e)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(n-1<t)throw new Error("only "+n+" bytes available! programmer error!");var r=new XMLHttpRequest;if(r.open("GET",a,!1),n!==o&&r.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(r.responseType="arraybuffer"),r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.send(null),!(200<=r.status&&r.status<300||304===r.status))throw new Error("Couldn't load "+a+". Status: "+r.status);return void 0!==r.response?new Uint8Array(r.response||[]):Le(r.responseText||"",!0)}(t,r)),void 0===i.chunks[e])throw new Error("doXHR failed!");return i.chunks[e]}),!r&&n||(o=n=1,n=this.getter(0).length,o=n,b("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=o,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!d)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var i=new o;Object.defineProperties(i,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});i={isDevice:!1,contents:i}}else i={isDevice:!1,url:a};var c=Fe.createFile(e,t,i,r,n);i.contents?c.contents=i.contents:i.url&&(c.contents=null,c.url=i.url),Object.defineProperties(c,{usedBytes:{get:function(){return this.contents.length}}});var s={};return Object.keys(c.stream_ops).forEach(function(e){var t=c.stream_ops[e];s[e]=function(){return Fe.forceLoadFile(c),t.apply(null,arguments)}}),s.read=function(e,t,r,n,o){Fe.forceLoadFile(c);var i=e.node.contents;if(o>=i.length)return 0;var a=Math.min(i.length-o,n);if(M(0<=a),i.slice)for(var s=0;s<a;s++)t[r+s]=i[o+s];else for(s=0;s<a;s++)t[r+s]=i.get(o+s);return a},c.stream_ops=s,c},createPreloadedFile:function(o,i,e,a,s,c,l,d,u,f){Browser.init();var t,r,n,h,p,g=i?De.resolve(_e.join2(o,i)):o,m=se("cp "+g);function E(t){function r(e){f&&f(),d||Fe.createDataFile(o,i,e,a,s,u),c&&c(),le(m)}var n=!1;y.preloadPlugins.forEach(function(e){n||e.canHandle(g)&&(e.handle(t,g,r,function(){l&&l(),le(m)}),n=!0)}),n||r(t)}ce(m),"string"==typeof e?(t=e,r=function(e){E(e)},n=l,p=h?"":se("al "+t),w(t,function(e){M(e,'Loading data file "'+t+'" failed (no arrayBuffer).'),r(new Uint8Array(e)),p&&le(p)},function(e){if(!n)throw'Loading data file "'+t+'" failed.';n()}),p&&ce(p)):E(e)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(a,s,c){s=s||function(){},c=c||function(){};var e=Fe.indexedDB();try{var l=e.open(Fe.DB_NAME(),Fe.DB_VERSION)}catch(e){return c(e)}l.onupgradeneeded=function(){b("creating db"),l.result.createObjectStore(Fe.DB_STORE_NAME)},l.onsuccess=function(){var e=l.result.transaction([Fe.DB_STORE_NAME],"readwrite"),t=e.objectStore(Fe.DB_STORE_NAME),r=0,n=0,o=a.length;function i(){(0==n?s:c)()}a.forEach(function(e){e=t.put(Fe.analyzePath(e).object.contents,e);e.onsuccess=function(){++r+n==o&&i()},e.onerror=function(){r+ ++n==o&&i()}}),e.onerror=c},l.onerror=c},loadFilesFromDB:function(s,c,l){c=c||function(){},l=l||function(){};var e=Fe.indexedDB();try{var d=e.open(Fe.DB_NAME(),Fe.DB_VERSION)}catch(e){return l(e)}d.onupgradeneeded=l,d.onsuccess=function(){var e=d.result;try{var t=e.transaction([Fe.DB_STORE_NAME],"readonly")}catch(e){return void l(e)}var r=t.objectStore(Fe.DB_STORE_NAME),n=0,o=0,i=s.length;function a(){(0==o?c:l)()}s.forEach(function(e){var t=r.get(e);t.onsuccess=function(){Fe.analyzePath(e).exists&&Fe.unlink(e),Fe.createDataFile(_e.dirname(e),_e.basename(e),t.result,!0,!0,!0),++n+o==i&&a()},t.onerror=function(){n+ ++o==i&&a()}}),t.onerror=l},d.onerror=l},absolutePath:function(){de("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder:function(){de("FS.createFolder has been removed; use FS.mkdir instead")},createLink:function(){de("FS.createLink has been removed; use FS.symlink instead")},joinPath:function(){de("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc:function(){de("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath:function(){de("FS.standardizePath has been removed; use PATH.normalize instead")}},Ie={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t,r){if("/"===t[0])return t;var n;if(-100===e)n=Fe.cwd();else{e=Fe.getStream(e);if(!e)throw new Fe.ErrnoError(8);n=e.path}if(0!=t.length)return _e.join2(n,t);if(!r)throw new Fe.ErrnoError(44);return n},doStat:function(e,t,r){try{var n=e(t)}catch(e){if(e&&e.node&&_e.normalize(t)!==_e.normalize(Fe.getPath(e.node)))return-54;throw e}return A[r>>2]=n.dev,A[r+4>>2]=0,A[r+8>>2]=n.ino,A[r+12>>2]=n.mode,A[r+16>>2]=n.nlink,A[r+20>>2]=n.uid,A[r+24>>2]=n.gid,A[r+28>>2]=n.rdev,A[r+32>>2]=0,pe=[n.size>>>0,(he=n.size,1<=+Math.abs(he)?0<he?(0|Math.min(+Math.floor(he/4294967296),4294967295))>>>0:~~+Math.ceil((he-(~~he>>>0))/4294967296)>>>0:0)],A[r+40>>2]=pe[0],A[r+44>>2]=pe[1],A[r+48>>2]=4096,A[r+52>>2]=n.blocks,A[r+56>>2]=n.atime.getTime()/1e3|0,A[r+60>>2]=0,A[r+64>>2]=n.mtime.getTime()/1e3|0,A[r+68>>2]=0,A[r+72>>2]=n.ctime.getTime()/1e3|0,A[r+76>>2]=0,pe=[n.ino>>>0,(he=n.ino,1<=+Math.abs(he)?0<he?(0|Math.min(+Math.floor(he/4294967296),4294967295))>>>0:~~+Math.ceil((he-(~~he>>>0))/4294967296)>>>0:0)],A[r+80>>2]=pe[0],A[r+84>>2]=pe[1],0},doMsync:function(e,t,r,n,o){e=k.slice(e,e+r);Fe.msync(t,e,o,r,n)},doMkdir:function(e,t){return"/"===(e=_e.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),Fe.mkdir(e,t,0),0},doMknod:function(e,t,r){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return Fe.mknod(e,t,r),0},doReadlink:function(e,t,r){if(r<=0)return-28;var n=Fe.readlink(e),o=Math.min(r,j(n)),e=P[t+o];return C(n,t,r+1),P[t+o]=e,o},doAccess:function(e,t){if(-8&t)return-28;var r=Fe.lookupPath(e,{follow:!0}).node;if(!r)return-44;e="";return 4&t&&(e+="r"),2&t&&(e+="w"),1&t&&(e+="x"),e&&Fe.nodePermissions(r,e)?-2:0},doDup:function(e,t,r){var n=Fe.getStream(r);return n&&Fe.close(n),Fe.open(e,t,0,r,r).fd},doReadv:function(e,t,r,n){for(var o=0,i=0;i<r;i++){var a=A[t+8*i>>2],s=A[t+(8*i+4)>>2],a=Fe.read(e,P,a,s,n);if(a<0)return-1;if(o+=a,a<s)break}return o},doWritev:function(e,t,r,n){for(var o=0,i=0;i<r;i++){var a=A[t+8*i>>2],s=A[t+(8*i+4)>>2],s=Fe.write(e,P,a,s,n);if(s<0)return-1;o+=s}return o},varargs:void 0,get:function(){return M(null!=Ie.varargs),Ie.varargs+=4,A[Ie.varargs-4>>2]},getStr:function(e){var t;return(e=e)?N(k,e,t):""},getStreamFromFD:function(e){e=Fe.getStream(e);if(!e)throw new Fe.ErrnoError(8);return e},get64:function(e,t){return M(0<=e?0===t:-1===t),e}};var Ne={};function Ue(){if(!Ue.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:s||"./this.program"};for(t in Ne)void 0===Ne[t]?delete e[t]:e[t]=Ne[t];var t,r=[];for(t in e)r.push(t+"="+e[t]);Ue.strings=r}return Ue.strings}var Ce,je,u=function(e,t,r,n){this.parent=e=e||this,this.mount=e.mount,this.mounted=null,this.id=Fe.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n};function Le(e,t,r){r=0<r?r:j(e)+1,r=new Array(r),e=U(e,r,0,r.length);return t&&(r.length=e),r}Object.defineProperties(u.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return Fe.isDir(this.mode)}},isDevice:{get:function(){return Fe.isChrdev(this.mode)}}}),Fe.FSNode=u,Fe.staticInit(),i&&(Ce=require("fs"),je=require("path"),ke.staticInit());var Pe={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},He={__cxa_allocate_exception:function(e){return Be(e+16)+16},__cxa_atexit:function(e,t){},__cxa_throw:function(e,t,r){throw new Oe(e).init(t,r),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s NO_DISABLE_EXCEPTION_CATCHING or -s EXCEPTION_CATCHING_ALLOWED=[..] to catch."},__gmtime_r:Te,__localtime_r:function(e,t){return function(e,t){ve();var r=new Date(1e3*A[e>>2]);A[t>>2]=r.getSeconds(),A[t+4>>2]=r.getMinutes(),A[t+8>>2]=r.getHours(),A[t+12>>2]=r.getDate(),A[t+16>>2]=r.getMonth(),A[t+20>>2]=r.getFullYear()-1900,A[t+24>>2]=r.getDay();var n=new Date(r.getFullYear(),0,1),e=(r.getTime()-n.getTime())/864e5|0;return A[t+28>>2]=e,A[t+36>>2]=-60*r.getTimezoneOffset(),e=new Date(r.getFullYear(),6,1).getTimezoneOffset(),n=n.getTimezoneOffset(),e=0|(e!=n&&r.getTimezoneOffset()==Math.min(n,e)),A[t+32>>2]=e,e=A[Qe()+(e?4:0)>>2],A[t+40>>2]=e,t}(e,t)},__sys_chmod:function(e,t){try{return e=Ie.getStr(e),Fe.chmod(e,t),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_chown32:function(e,t,r){try{return e=Ie.getStr(e),Fe.chown(e,t,r),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_fstat64:function(e,t){try{var r=Ie.getStreamFromFD(e);return Ie.doStat(Fe.stat,r.path,t)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_fstatat64:function(e,t,r,n){try{t=Ie.getStr(t);var o=256&n,i=4096&n;return M(!(n&=-4353),n),t=Ie.calculateAt(e,t,i),Ie.doStat(o?Fe.lstat:Fe.stat,t,r)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_ftruncate64:function(e,t,r,n){try{var o=Ie.get64(r,n);return Fe.ftruncate(e,o),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_getcwd:function(e,t){try{if(0===t)return-28;var r=Fe.cwd();return t<j(r)+1?-68:(C(r,e,t),e)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_getdents64:function(e,t,r){try{var n=Ie.getStreamFromFD(e);n.getdents||(n.getdents=Fe.readdir(n.path));for(var o=0,i=Fe.llseek(n,0,1),a=Math.floor(i/280);a<n.getdents.length&&o+280<=r;){var s,c,l,d=n.getdents[a];l="."===d[0]?(c=1,4):(c=(s=Fe.lookupNode(n.node,d)).id,Fe.isChrdev(s.mode)?2:Fe.isDir(s.mode)?4:Fe.isLink(s.mode)?10:8),pe=[c>>>0,(he=c,1<=+Math.abs(he)?0<he?(0|Math.min(+Math.floor(he/4294967296),4294967295))>>>0:~~+Math.ceil((he-(~~he>>>0))/4294967296)>>>0:0)],A[t+o>>2]=pe[0],A[t+o+4>>2]=pe[1],pe=[280*(a+1)>>>0,(he=280*(a+1),1<=+Math.abs(he)?0<he?(0|Math.min(+Math.floor(he/4294967296),4294967295))>>>0:~~+Math.ceil((he-(~~he>>>0))/4294967296)>>>0:0)],A[t+o+8>>2]=pe[0],A[t+o+12>>2]=pe[1],x[t+o+16>>1]=280,P[t+o+18>>0]=l,C(d,t+o+19,256),o+=280,a+=1}return Fe.llseek(n,280*a,0),o}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_getpid:function(){return 42},__sys_getppid:function(){return 1},__sys_ioctl:function(e,t,r){Ie.varargs=r;try{var n=Ie.getStreamFromFD(e);switch(t){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:if(!n.tty)return-59;var o=Ie.get();return A[o>>2]=0;case 21520:return n.tty?-28:-59;case 21531:o=Ie.get();return Fe.ioctl(n,t,o);case 21523:case 21524:return n.tty?0:-59;default:de("bad ioctl syscall "+t)}}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_link:function(e,t){return-34},__sys_lstat64:function(e,t){try{return e=Ie.getStr(e),Ie.doStat(Fe.lstat,e,t)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_mkdir:function(e,t){try{return e=Ie.getStr(e),Ie.doMkdir(e,t)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_open:function(e,t,r){Ie.varargs=r;try{var n=Ie.getStr(e),o=r?Ie.get():0;return Fe.open(n,t,o).fd}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_readlink:function(e,t,r){try{return e=Ie.getStr(e),Ie.doReadlink(e,t,r)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_rename:function(e,t){try{return e=Ie.getStr(e),t=Ie.getStr(t),Fe.rename(e,t),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_rmdir:function(e){try{return e=Ie.getStr(e),Fe.rmdir(e),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_stat64:function(e,t){try{return e=Ie.getStr(e),Ie.doStat(Fe.stat,e,t)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_symlink:function(e,t){try{return e=Ie.getStr(e),t=Ie.getStr(t),Fe.symlink(e,t),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_umask:function(e){try{var t=Ie.umask;return Ie.umask=e,t}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_uname:function(r){try{if(!r)return-21;var n={__size__:390,domainname:325,machine:260,nodename:65,release:130,sysname:0,version:195},e=function(e,t){B(t,r+n[e])};return e("sysname","Emscripten"),e("nodename","emscripten"),e("release","1.0"),e("version","#1"),e("machine","wasm32"),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_unlink:function(e){try{return e=Ie.getStr(e),Fe.unlink(e),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},__sys_utimensat:function(e,t,r,n){try{t=Ie.getStr(t),M(0===n),t=Ie.calculateAt(e,t,!0);var o=1e3*A[r>>2]+A[r+4>>2]/1e6,i=1e3*A[(r+=8)>>2]+A[r+4>>2]/1e6;return Fe.utime(t,o,i),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),-e.errno}},abort:function(){de()},emscripten_get_heap_max:function(){return 2147483648},emscripten_memcpy_big:function(e,t,r){k.copyWithin(e,t,t+r)},emscripten_resize_heap:function(e){var t=k.length;M(t<(e>>>=0));var r=2147483648;if(r<e)return O("Cannot enlarge memory, asked to go up to "+e+" bytes, but the limit is "+r+" bytes!"),!1;for(var n,o=1;o<=4;o*=2){var i=t*(1+.2/o),i=Math.min(i,e+100663296),a=Math.min(r,(0<(n=Math.max(e,i))%(i=65536)&&(n+=i-n%i),n));if(function(t){try{return v.grow(t-R.byteLength+65535>>>16),X(v.buffer),1}catch(e){O("emscripten_realloc_buffer: Attempted to grow heap from "+R.byteLength+" bytes to "+t+" bytes, but got error: "+e)}}(a))return!0}return O("Failed to grow the heap from "+t+" bytes to "+a+" bytes, not enough memory!"),!1},environ_get:function(n,o){var i=0;return Ue().forEach(function(e,t){var r=o+i;B(e,A[n+4*t>>2]=r),i+=e.length+1}),0},environ_sizes_get:function(e,t){var r=Ue();A[e>>2]=r.length;var n=0;return r.forEach(function(e){n+=e.length+1}),A[t>>2]=n,0},exit:function(e){Ze(e)},fd_close:function(e){try{var t=Ie.getStreamFromFD(e);return Fe.close(t),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),e.errno}},fd_fdstat_get:function(e,t){try{var r=Ie.getStreamFromFD(e),n=r.tty?2:Fe.isDir(r.mode)?3:Fe.isLink(r.mode)?7:4;return P[t>>0]=n,0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),e.errno}},fd_read:function(e,t,r,n){try{var o=Ie.getStreamFromFD(e),i=Ie.doReadv(o,t,r);return A[n>>2]=i,0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),e.errno}},fd_seek:function(e,t,r,n,o){try{var i=Ie.getStreamFromFD(e),a=4294967296*r+(t>>>0),s=9007199254740992;return a<=-s||s<=a?-61:(Fe.llseek(i,a,n),pe=[i.position>>>0,(he=i.position,1<=+Math.abs(he)?0<he?(0|Math.min(+Math.floor(he/4294967296),4294967295))>>>0:~~+Math.ceil((he-(~~he>>>0))/4294967296)>>>0:0)],A[o>>2]=pe[0],A[o+4>>2]=pe[1],i.getdents&&0==a&&0===n&&(i.getdents=null),0)}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),e.errno}},fd_write:function(e,t,r,n){try{var o=Ie.getStreamFromFD(e),i=Ie.doWritev(o,t,r);return A[n>>2]=i,0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||de(e),e.errno}},getgrgid:function(){throw"getgrgid: TODO"},getpwuid:function(){throw"getpwuid: TODO"},gettimeofday:function(e){var t=Date.now();return A[e>>2]=t/1e3|0,A[e+4>>2]=t%1e3*1e3|0,0},mktime:function(e){ve();var t=new Date(A[e+20>>2]+1900,A[e+16>>2],A[e+12>>2],A[e+8>>2],A[e+4>>2],A[e>>2],0),r=A[e+32>>2],n=t.getTimezoneOffset(),o=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=o.getTimezoneOffset(),s=Math.min(a,i);return r<0?A[e+32>>2]=Number(i!=a&&s==n):0<r!=(s==n)&&(i=Math.max(a,i),i=0<r?s:i,t.setTime(t.getTime()+6e4*(i-n))),A[e+24>>2]=t.getDay(),o=(t.getTime()-o.getTime())/864e5|0,A[e+28>>2]=o,A[e>>2]=t.getSeconds(),A[e+4>>2]=t.getMinutes(),A[e+8>>2]=t.getHours(),A[e+12>>2]=t.getDate(),A[e+16>>2]=t.getMonth(),t.getTime()/1e3|0},setTempRet0:function(e){},time:function(e){var t=Date.now()/1e3|0;return e&&(A[e>>2]=t),t},times:function(e){var t;return 0!==e&&(t=16,k.fill(0,e,e+t)),0}};!function(){var t={env:He,wasi_snapshot_preview1:He};function r(e,t){e=e.exports;y.asm=e,M(v=y.asm.memory,"memory not found in wasm exports"),X(v.buffer),M(z=y.asm.__indirect_function_table,"table not found in wasm exports"),e=y.asm.__wasm_call_ctors,q.unshift(e),le("wasm-instantiate")}ce("wasm-instantiate");var n=y;function o(e){M(y===n,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),n=null,r(e.instance)}function i(e){return function(){if(!E&&(l||d)){if("function"==typeof fetch&&!me(ue))return fetch(ue,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ue+"'";return e.arrayBuffer()}).catch(function(){return ye(ue)});if(w)return new Promise(function(t,e){w(ue,function(e){t(new Uint8Array(e))},e)})}return Promise.resolve().then(function(){return ye(ue)})}().then(function(e){return WebAssembly.instantiate(e,t)}).then(function(e){return e}).then(e,function(e){O("failed to asynchronously prepare wasm: "+e),me(ue)&&O("warning: Loading from a file URI ("+ue+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing"),de(e)})}if(y.instantiateWasm)try{return y.instantiateWasm(t,r)}catch(e){return O("Module.instantiateWasm callback failed with error: "+e)}(E||"function"!=typeof WebAssembly.instantiateStreaming||ge(ue)||me(ue)||"function"!=typeof fetch?i(o):fetch(ue,{credentials:"same-origin"}).then(function(e){return WebAssembly.instantiateStreaming(e,t).then(o,function(e){return O("wasm streaming compile failed: "+e),O("falling back to ArrayBuffer instantiation"),i(o)})})).catch(a)}(),y.___wasm_call_ctors=Ee("__wasm_call_ctors");var Be=y._malloc=Ee("malloc");y.___errno_location=Ee("__errno_location"),y._fflush=Ee("fflush"),y._main=Ee("main");var Xe=y._emscripten_stack_get_end=function(){return(Xe=y._emscripten_stack_get_end=y.asm.emscripten_stack_get_end).apply(null,arguments)},Qe=y.__get_tzname=Ee("_get_tzname"),ze=y.__get_daylight=Ee("_get_daylight"),We=y.__get_timezone=Ee("_get_timezone");y.stackSave=Ee("stackSave"),y.stackRestore=Ee("stackRestore");var Ge,$e=y.stackAlloc=Ee("stackAlloc"),qe=y._emscripten_stack_init=function(){return(qe=y._emscripten_stack_init=y.asm.emscripten_stack_init).apply(null,arguments)};function Ye(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Ke(e){M(0==ne,'cannot call main when async dependencies remain! (listen on Module["onRuntimeInitialized"])'),M(0==$.length,"cannot call main when preRun functions remain to be called");var t=y._main,r=(e=e||[]).length+1,n=$e(4*(r+1));A[n>>2]=H(s);for(var o=1;o<r;o++)A[(n>>2)+o]=H(e[o-1]);A[(n>>2)+r]=0;try{var i=t(r,n);return Ze(i,!0),i}catch(e){return function(e){if(e instanceof Ye||"unwind"==e)return D;var t=e;e&&"object"==typeof e&&e.stack&&(t=[e,e.stack]),O("exception thrown: "+t),c(1,e)}(e)}}function Ve(e){function t(){Ge||(Ge=!0,y.calledRun=!0,S||(G(),M(!V),V=!0,y.noFSInit||Fe.init.initialized||Fe.init(),Fe.ignorePermissions=!1,we(q),G(),we(Y),r(y),y.onRuntimeInitialized&&y.onRuntimeInitialized(),Je&&Ke(e),re()))}e=e||o,0<ne||(qe(),W(),te(),0<ne||(y.setStatus?(y.setStatus("Running..."),setTimeout(function(){setTimeout(function(){y.setStatus("")},1),t()},1)):t(),G()))}function Ze(e,t){D=e,function(){var e=b,t=O,r=!1;b=O=function(e){r=!0};try{var n=y._fflush;n&&n(0),["stdout","stderr"].forEach(function(e){e=Fe.analyzePath("/dev/"+e);e&&(e=e.object.rdev,(e=Se.ttys[e])&&e.output&&e.output.length&&(r=!0))})}catch(e){}b=e,O=t,r&&T("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc.")}(),ee()?t||(a(t="program exited (with status: "+e+"), but EXIT_RUNTIME is not set, so halting execution but not exiting the runtime or preventing further async execution (build with EXIT_RUNTIME=1, if you want a true shutdown)"),O(t)):(G(),Z=!0),function(e){D=e,ee()||(y.onExit&&y.onExit(e),S=!0);c(e,new Ye(e))}(e)}if(y._emscripten_stack_get_free=function(){return(y._emscripten_stack_get_free=y.asm.emscripten_stack_get_free).apply(null,arguments)},y.dynCall_iijj=Ee("dynCall_iijj"),y.dynCall_iijii=Ee("dynCall_iijii"),y.dynCall_jii=Ee("dynCall_jii"),y.dynCall_iiji=Ee("dynCall_iiji"),y.dynCall_iij=Ee("dynCall_iij"),y.dynCall_vij=Ee("dynCall_vij"),y.dynCall_iiij=Ee("dynCall_iiij"),y.dynCall_jiji=Ee("dynCall_jiji"),Object.getOwnPropertyDescriptor(y,"intArrayFromString")||(y.intArrayFromString=function(){de("'intArrayFromString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"intArrayToString")||(y.intArrayToString=function(){de("'intArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"ccall")||(y.ccall=function(){de("'ccall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"cwrap")||(y.cwrap=function(){de("'cwrap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setValue")||(y.setValue=function(){de("'setValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getValue")||(y.getValue=function(){de("'getValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"allocate")||(y.allocate=function(){de("'allocate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"UTF8ArrayToString")||(y.UTF8ArrayToString=function(){de("'UTF8ArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"UTF8ToString")||(y.UTF8ToString=function(){de("'UTF8ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stringToUTF8Array")||(y.stringToUTF8Array=function(){de("'stringToUTF8Array' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stringToUTF8")||(y.stringToUTF8=function(){de("'stringToUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"lengthBytesUTF8")||(y.lengthBytesUTF8=function(){de("'lengthBytesUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stackTrace")||(y.stackTrace=function(){de("'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addOnPreRun")||(y.addOnPreRun=function(){de("'addOnPreRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addOnInit")||(y.addOnInit=function(){de("'addOnInit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addOnPreMain")||(y.addOnPreMain=function(){de("'addOnPreMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addOnExit")||(y.addOnExit=function(){de("'addOnExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addOnPostRun")||(y.addOnPostRun=function(){de("'addOnPostRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeStringToMemory")||(y.writeStringToMemory=function(){de("'writeStringToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeArrayToMemory")||(y.writeArrayToMemory=function(){de("'writeArrayToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeAsciiToMemory")||(y.writeAsciiToMemory=function(){de("'writeAsciiToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addRunDependency")||(y.addRunDependency=function(){de("'addRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"removeRunDependency")||(y.removeRunDependency=function(){de("'removeRunDependency' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"FS_createFolder")||(y.FS_createFolder=function(){de("'FS_createFolder' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"FS_createPath")||(y.FS_createPath=function(){de("'FS_createPath' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"FS_createDataFile")||(y.FS_createDataFile=function(){de("'FS_createDataFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"FS_createPreloadedFile")||(y.FS_createPreloadedFile=function(){de("'FS_createPreloadedFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"FS_createLazyFile")||(y.FS_createLazyFile=function(){de("'FS_createLazyFile' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"FS_createLink")||(y.FS_createLink=function(){de("'FS_createLink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"FS_createDevice")||(y.FS_createDevice=function(){de("'FS_createDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"FS_unlink")||(y.FS_unlink=function(){de("'FS_unlink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),Object.getOwnPropertyDescriptor(y,"getLEB")||(y.getLEB=function(){de("'getLEB' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getFunctionTables")||(y.getFunctionTables=function(){de("'getFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"alignFunctionTables")||(y.alignFunctionTables=function(){de("'alignFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerFunctions")||(y.registerFunctions=function(){de("'registerFunctions' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"addFunction")||(y.addFunction=function(){de("'addFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"removeFunction")||(y.removeFunction=function(){de("'removeFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getFuncWrapper")||(y.getFuncWrapper=function(){de("'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"prettyPrint")||(y.prettyPrint=function(){de("'prettyPrint' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"dynCall")||(y.dynCall=function(){de("'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getCompilerSetting")||(y.getCompilerSetting=function(){de("'getCompilerSetting' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"print")||(y.print=function(){de("'print' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"printErr")||(y.printErr=function(){de("'printErr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getTempRet0")||(y.getTempRet0=function(){de("'getTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setTempRet0")||(y.setTempRet0=function(){de("'setTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"callMain")||(y.callMain=function(){de("'callMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"abort")||(y.abort=function(){de("'abort' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"keepRuntimeAlive")||(y.keepRuntimeAlive=function(){de("'keepRuntimeAlive' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"zeroMemory")||(y.zeroMemory=function(){de("'zeroMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stringToNewUTF8")||(y.stringToNewUTF8=function(){de("'stringToNewUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setFileTime")||(y.setFileTime=function(){de("'setFileTime' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"emscripten_realloc_buffer")||(y.emscripten_realloc_buffer=function(){de("'emscripten_realloc_buffer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"ENV")||(y.ENV=function(){de("'ENV' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"ERRNO_CODES")||(y.ERRNO_CODES=function(){de("'ERRNO_CODES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"ERRNO_MESSAGES")||(y.ERRNO_MESSAGES=function(){de("'ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setErrNo")||(y.setErrNo=function(){de("'setErrNo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"inetPton4")||(y.inetPton4=function(){de("'inetPton4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"inetNtop4")||(y.inetNtop4=function(){de("'inetNtop4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"inetPton6")||(y.inetPton6=function(){de("'inetPton6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"inetNtop6")||(y.inetNtop6=function(){de("'inetNtop6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"readSockaddr")||(y.readSockaddr=function(){de("'readSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeSockaddr")||(y.writeSockaddr=function(){de("'writeSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"DNS")||(y.DNS=function(){de("'DNS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getHostByName")||(y.getHostByName=function(){de("'getHostByName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"GAI_ERRNO_MESSAGES")||(y.GAI_ERRNO_MESSAGES=function(){de("'GAI_ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"Protocols")||(y.Protocols=function(){de("'Protocols' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"Sockets")||(y.Sockets=function(){de("'Sockets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getRandomDevice")||(y.getRandomDevice=function(){de("'getRandomDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"traverseStack")||(y.traverseStack=function(){de("'traverseStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"UNWIND_CACHE")||(y.UNWIND_CACHE=function(){de("'UNWIND_CACHE' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"withBuiltinMalloc")||(y.withBuiltinMalloc=function(){de("'withBuiltinMalloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"readAsmConstArgsArray")||(y.readAsmConstArgsArray=function(){de("'readAsmConstArgsArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"readAsmConstArgs")||(y.readAsmConstArgs=function(){de("'readAsmConstArgs' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"mainThreadEM_ASM")||(y.mainThreadEM_ASM=function(){de("'mainThreadEM_ASM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"jstoi_q")||(y.jstoi_q=function(){de("'jstoi_q' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"jstoi_s")||(y.jstoi_s=function(){de("'jstoi_s' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getExecutableName")||(y.getExecutableName=function(){de("'getExecutableName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"listenOnce")||(y.listenOnce=function(){de("'listenOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"autoResumeAudioContext")||(y.autoResumeAudioContext=function(){de("'autoResumeAudioContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"dynCallLegacy")||(y.dynCallLegacy=function(){de("'dynCallLegacy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getDynCaller")||(y.getDynCaller=function(){de("'getDynCaller' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"dynCall")||(y.dynCall=function(){de("'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"callRuntimeCallbacks")||(y.callRuntimeCallbacks=function(){de("'callRuntimeCallbacks' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"handleException")||(y.handleException=function(){de("'handleException' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"runtimeKeepalivePush")||(y.runtimeKeepalivePush=function(){de("'runtimeKeepalivePush' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"runtimeKeepalivePop")||(y.runtimeKeepalivePop=function(){de("'runtimeKeepalivePop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"callUserCallback")||(y.callUserCallback=function(){de("'callUserCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"maybeExit")||(y.maybeExit=function(){de("'maybeExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"safeSetTimeout")||(y.safeSetTimeout=function(){de("'safeSetTimeout' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"asmjsMangle")||(y.asmjsMangle=function(){de("'asmjsMangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"asyncLoad")||(y.asyncLoad=function(){de("'asyncLoad' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"alignMemory")||(y.alignMemory=function(){de("'alignMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"mmapAlloc")||(y.mmapAlloc=function(){de("'mmapAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"reallyNegative")||(y.reallyNegative=function(){de("'reallyNegative' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"unSign")||(y.unSign=function(){de("'unSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"reSign")||(y.reSign=function(){de("'reSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"formatString")||(y.formatString=function(){de("'formatString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"PATH")||(y.PATH=function(){de("'PATH' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"PATH_FS")||(y.PATH_FS=function(){de("'PATH_FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SYSCALLS")||(y.SYSCALLS=function(){de("'SYSCALLS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"syscallMmap2")||(y.syscallMmap2=function(){de("'syscallMmap2' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"syscallMunmap")||(y.syscallMunmap=function(){de("'syscallMunmap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getSocketFromFD")||(y.getSocketFromFD=function(){de("'getSocketFromFD' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getSocketAddress")||(y.getSocketAddress=function(){de("'getSocketAddress' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"JSEvents")||(y.JSEvents=function(){de("'JSEvents' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerKeyEventCallback")||(y.registerKeyEventCallback=function(){de("'registerKeyEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"specialHTMLTargets")||(y.specialHTMLTargets=function(){de("'specialHTMLTargets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"maybeCStringToJsString")||(y.maybeCStringToJsString=function(){de("'maybeCStringToJsString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"findEventTarget")||(y.findEventTarget=function(){de("'findEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"findCanvasEventTarget")||(y.findCanvasEventTarget=function(){de("'findCanvasEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getBoundingClientRect")||(y.getBoundingClientRect=function(){de("'getBoundingClientRect' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillMouseEventData")||(y.fillMouseEventData=function(){de("'fillMouseEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerMouseEventCallback")||(y.registerMouseEventCallback=function(){de("'registerMouseEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerWheelEventCallback")||(y.registerWheelEventCallback=function(){de("'registerWheelEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerUiEventCallback")||(y.registerUiEventCallback=function(){de("'registerUiEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerFocusEventCallback")||(y.registerFocusEventCallback=function(){de("'registerFocusEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillDeviceOrientationEventData")||(y.fillDeviceOrientationEventData=function(){de("'fillDeviceOrientationEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerDeviceOrientationEventCallback")||(y.registerDeviceOrientationEventCallback=function(){de("'registerDeviceOrientationEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillDeviceMotionEventData")||(y.fillDeviceMotionEventData=function(){de("'fillDeviceMotionEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerDeviceMotionEventCallback")||(y.registerDeviceMotionEventCallback=function(){de("'registerDeviceMotionEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"screenOrientation")||(y.screenOrientation=function(){de("'screenOrientation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillOrientationChangeEventData")||(y.fillOrientationChangeEventData=function(){de("'fillOrientationChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerOrientationChangeEventCallback")||(y.registerOrientationChangeEventCallback=function(){de("'registerOrientationChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillFullscreenChangeEventData")||(y.fillFullscreenChangeEventData=function(){de("'fillFullscreenChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerFullscreenChangeEventCallback")||(y.registerFullscreenChangeEventCallback=function(){de("'registerFullscreenChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerRestoreOldStyle")||(y.registerRestoreOldStyle=function(){de("'registerRestoreOldStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"hideEverythingExceptGivenElement")||(y.hideEverythingExceptGivenElement=function(){de("'hideEverythingExceptGivenElement' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"restoreHiddenElements")||(y.restoreHiddenElements=function(){de("'restoreHiddenElements' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setLetterbox")||(y.setLetterbox=function(){de("'setLetterbox' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"currentFullscreenStrategy")||(y.currentFullscreenStrategy=function(){de("'currentFullscreenStrategy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"restoreOldWindowedStyle")||(y.restoreOldWindowedStyle=function(){de("'restoreOldWindowedStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"softFullscreenResizeWebGLRenderTarget")||(y.softFullscreenResizeWebGLRenderTarget=function(){de("'softFullscreenResizeWebGLRenderTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"doRequestFullscreen")||(y.doRequestFullscreen=function(){de("'doRequestFullscreen' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillPointerlockChangeEventData")||(y.fillPointerlockChangeEventData=function(){de("'fillPointerlockChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerPointerlockChangeEventCallback")||(y.registerPointerlockChangeEventCallback=function(){de("'registerPointerlockChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerPointerlockErrorEventCallback")||(y.registerPointerlockErrorEventCallback=function(){de("'registerPointerlockErrorEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"requestPointerLock")||(y.requestPointerLock=function(){de("'requestPointerLock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillVisibilityChangeEventData")||(y.fillVisibilityChangeEventData=function(){de("'fillVisibilityChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerVisibilityChangeEventCallback")||(y.registerVisibilityChangeEventCallback=function(){de("'registerVisibilityChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerTouchEventCallback")||(y.registerTouchEventCallback=function(){de("'registerTouchEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillGamepadEventData")||(y.fillGamepadEventData=function(){de("'fillGamepadEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerGamepadEventCallback")||(y.registerGamepadEventCallback=function(){de("'registerGamepadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerBeforeUnloadEventCallback")||(y.registerBeforeUnloadEventCallback=function(){de("'registerBeforeUnloadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"fillBatteryEventData")||(y.fillBatteryEventData=function(){de("'fillBatteryEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"battery")||(y.battery=function(){de("'battery' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"registerBatteryEventCallback")||(y.registerBatteryEventCallback=function(){de("'registerBatteryEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setCanvasElementSize")||(y.setCanvasElementSize=function(){de("'setCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getCanvasElementSize")||(y.getCanvasElementSize=function(){de("'getCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"polyfillSetImmediate")||(y.polyfillSetImmediate=function(){de("'polyfillSetImmediate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"demangle")||(y.demangle=function(){de("'demangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"demangleAll")||(y.demangleAll=function(){de("'demangleAll' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"jsStackTrace")||(y.jsStackTrace=function(){de("'jsStackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stackTrace")||(y.stackTrace=function(){de("'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getEnvStrings")||(y.getEnvStrings=function(){de("'getEnvStrings' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"checkWasiClock")||(y.checkWasiClock=function(){de("'checkWasiClock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeI53ToI64")||(y.writeI53ToI64=function(){de("'writeI53ToI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeI53ToI64Clamped")||(y.writeI53ToI64Clamped=function(){de("'writeI53ToI64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeI53ToI64Signaling")||(y.writeI53ToI64Signaling=function(){de("'writeI53ToI64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeI53ToU64Clamped")||(y.writeI53ToU64Clamped=function(){de("'writeI53ToU64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeI53ToU64Signaling")||(y.writeI53ToU64Signaling=function(){de("'writeI53ToU64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"readI53FromI64")||(y.readI53FromI64=function(){de("'readI53FromI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"readI53FromU64")||(y.readI53FromU64=function(){de("'readI53FromU64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"convertI32PairToI53")||(y.convertI32PairToI53=function(){de("'convertI32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"convertU32PairToI53")||(y.convertU32PairToI53=function(){de("'convertU32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"uncaughtExceptionCount")||(y.uncaughtExceptionCount=function(){de("'uncaughtExceptionCount' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"exceptionLast")||(y.exceptionLast=function(){de("'exceptionLast' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"exceptionCaught")||(y.exceptionCaught=function(){de("'exceptionCaught' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"ExceptionInfo")||(y.ExceptionInfo=function(){de("'ExceptionInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"CatchInfo")||(y.CatchInfo=function(){de("'CatchInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"exception_addRef")||(y.exception_addRef=function(){de("'exception_addRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"exception_decRef")||(y.exception_decRef=function(){de("'exception_decRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"Browser")||(y.Browser=function(){de("'Browser' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"funcWrappers")||(y.funcWrappers=function(){de("'funcWrappers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"getFuncWrapper")||(y.getFuncWrapper=function(){de("'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"setMainLoop")||(y.setMainLoop=function(){de("'setMainLoop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"wget")||(y.wget=function(){de("'wget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"FS")||(y.FS=function(){de("'FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"MEMFS")||(y.MEMFS=function(){de("'MEMFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"TTY")||(y.TTY=function(){de("'TTY' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"PIPEFS")||(y.PIPEFS=function(){de("'PIPEFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SOCKFS")||(y.SOCKFS=function(){de("'SOCKFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"_setNetworkCallback")||(y._setNetworkCallback=function(){de("'_setNetworkCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"tempFixedLengthArray")||(y.tempFixedLengthArray=function(){de("'tempFixedLengthArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"miniTempWebGLFloatBuffers")||(y.miniTempWebGLFloatBuffers=function(){de("'miniTempWebGLFloatBuffers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"heapObjectForWebGLType")||(y.heapObjectForWebGLType=function(){de("'heapObjectForWebGLType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"heapAccessShiftForWebGLHeap")||(y.heapAccessShiftForWebGLHeap=function(){de("'heapAccessShiftForWebGLHeap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"GL")||(y.GL=function(){de("'GL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"emscriptenWebGLGet")||(y.emscriptenWebGLGet=function(){de("'emscriptenWebGLGet' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"computeUnpackAlignedImageSize")||(y.computeUnpackAlignedImageSize=function(){de("'computeUnpackAlignedImageSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"emscriptenWebGLGetTexPixelData")||(y.emscriptenWebGLGetTexPixelData=function(){de("'emscriptenWebGLGetTexPixelData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"emscriptenWebGLGetUniform")||(y.emscriptenWebGLGetUniform=function(){de("'emscriptenWebGLGetUniform' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"webglGetUniformLocation")||(y.webglGetUniformLocation=function(){de("'webglGetUniformLocation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"webglPrepareUniformLocationsBeforeFirstUse")||(y.webglPrepareUniformLocationsBeforeFirstUse=function(){de("'webglPrepareUniformLocationsBeforeFirstUse' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"webglGetLeftBracePos")||(y.webglGetLeftBracePos=function(){de("'webglGetLeftBracePos' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"emscriptenWebGLGetVertexAttrib")||(y.emscriptenWebGLGetVertexAttrib=function(){de("'emscriptenWebGLGetVertexAttrib' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"writeGLArray")||(y.writeGLArray=function(){de("'writeGLArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"AL")||(y.AL=function(){de("'AL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SDL_unicode")||(y.SDL_unicode=function(){de("'SDL_unicode' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SDL_ttfContext")||(y.SDL_ttfContext=function(){de("'SDL_ttfContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SDL_audio")||(y.SDL_audio=function(){de("'SDL_audio' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SDL")||(y.SDL=function(){de("'SDL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"SDL_gfx")||(y.SDL_gfx=function(){de("'SDL_gfx' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"GLUT")||(y.GLUT=function(){de("'GLUT' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"EGL")||(y.EGL=function(){de("'EGL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"GLFW_Window")||(y.GLFW_Window=function(){de("'GLFW_Window' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"GLFW")||(y.GLFW=function(){de("'GLFW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"GLEW")||(y.GLEW=function(){de("'GLEW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"IDBStore")||(y.IDBStore=function(){de("'IDBStore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"runAndAbortIfError")||(y.runAndAbortIfError=function(){de("'runAndAbortIfError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"NODEFS")||(y.NODEFS=function(){de("'NODEFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"WORKERFS")||(y.WORKERFS=function(){de("'WORKERFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"warnOnce")||(y.warnOnce=function(){de("'warnOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stackSave")||(y.stackSave=function(){de("'stackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stackRestore")||(y.stackRestore=function(){de("'stackRestore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stackAlloc")||(y.stackAlloc=function(){de("'stackAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"AsciiToString")||(y.AsciiToString=function(){de("'AsciiToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stringToAscii")||(y.stringToAscii=function(){de("'stringToAscii' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"UTF16ToString")||(y.UTF16ToString=function(){de("'UTF16ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stringToUTF16")||(y.stringToUTF16=function(){de("'stringToUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"lengthBytesUTF16")||(y.lengthBytesUTF16=function(){de("'lengthBytesUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"UTF32ToString")||(y.UTF32ToString=function(){de("'UTF32ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"stringToUTF32")||(y.stringToUTF32=function(){de("'stringToUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"lengthBytesUTF32")||(y.lengthBytesUTF32=function(){de("'lengthBytesUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"allocateUTF8")||(y.allocateUTF8=function(){de("'allocateUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(y,"allocateUTF8OnStack")||(y.allocateUTF8OnStack=function(){de("'allocateUTF8OnStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),y.writeStackCookie=W,y.checkStackCookie=G,Object.getOwnPropertyDescriptor(y,"ALLOC_NORMAL")||Object.defineProperty(y,"ALLOC_NORMAL",{configurable:!0,get:function(){de("'ALLOC_NORMAL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(y,"ALLOC_STACK")||Object.defineProperty(y,"ALLOC_STACK",{configurable:!0,get:function(){de("'ALLOC_STACK' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),ie=function e(){Ge||Ve(),Ge||(ie=e)},y.run=Ve,y.preInit)for("function"==typeof y.preInit&&(y.preInit=[y.preInit]);0<y.preInit.length;)y.preInit.pop()();var Je=!0;return y.noInitialRun&&(Je=!1),Ve(),y.FS=Fe,y.NODEFS=ke,y.WORKERFS=xe,y.callMain=Ke,e.ready});const io=e=>e?.trim()?.replace(/\s{2,}/g," "),ao=e=>io(e?.textContent),so={XLINK:"http://www.w3.org/1999/xlink",EPUB:"http://www.idpf.org/2007/ops"},co={XML:"application/xml",XHTML:"application/xhtml+xml"},lo={strong:["strong","self"],emphasis:["em","self"],style:["span","self"],a:"anchor",strikethrough:["s","self"],sub:["sub","self"],sup:["sup","self"],code:["code","self"],image:"image"};const uo={epigraph:["blockquote"],subtitle:["h2",lo],"text-author":["p",lo],date:["p",lo],stanza:"stanza"},fo={title:["header",{p:["h1",lo],"empty-line":["br"]}],epigraph:["blockquote","self"],image:"image",annotation:["aside"],section:["section","self"],p:["p",lo],poem:["blockquote",uo],subtitle:["h2",lo],cite:["blockquote","self"],"empty-line":["br"],table:["table",{tr:["tr",["align"]],th:["th",["colspan","rowspan","align","valign"]],td:["td",["colspan","rowspan","align","valign"]]}],"text-author":["p",lo]};uo.epigraph.push(fo);const ho={image:"image",title:["section",{p:["h1",lo],"empty-line":["br"]}],epigraph:["section",fo],section:["section",fo]},po=e=>{const t=e.getAttributeNS(so.XLINK,"href");var[,r]=t.split("#");const n=e.getRootNode().getElementById(r);return n?`data:${n.getAttribute("content-type")};base64,${n.textContent}`:t};class go{constructor(e){this.fb2=e,this.doc=document.implementation.createDocument(so.XHTML,"html")}image(e){const t=this.doc.createElement("img");return t.alt=e.getAttribute("alt"),t.title=e.getAttribute("title"),t.setAttribute("src",po(e)),t}anchor(e){const t=this.convert(e,{a:["a",lo]});return t.setAttribute("href",e.getAttributeNS(so.XLINK,"href")),"note"===e.getAttribute("type")&&t.setAttributeNS(so.EPUB,"epub:type","noteref"),t}stanza(e){const t=this.convert(e,{stanza:["p",{title:["header",{p:["strong",lo],"empty-line":["br"]}],subtitle:["p",lo]}]});for(const r of e.children)"v"===r.nodeName&&(t.append(this.doc.createTextNode(r.textContent)),t.append(this.doc.createElement("br")));return t}convert(e,t){if(3===e.nodeType)return this.doc.createTextNode(e.textContent);if(4===e.nodeType)return this.doc.createCDATASection(e.textContent);if(8===e.nodeType)return this.doc.createComment(e.textContent);var r=t?.[e.nodeName];if(!r)return null;if("string"==typeof r)return this[r](e);var[n,r]=r;const o=this.doc.createElement(n);if(e.id&&(o.id=e.id),o.classList.add(e.nodeName),Array.isArray(r))for(const c of r)o.setAttribute(c,e.getAttribute(c));var i="self"===r?t:Array.isArray(r)?null:r;let a=e.firstChild;for(;a;){var s=this.convert(a,i);s&&o.append(s),a=a.nextSibling}return o}}const mo=URL.createObjectURL(new Blob([`
@namespace epub "http://www.idpf.org/2007/ops";
body > img, section > img {
    display: block;
    margin: auto;
}
.title {
    text-align: center;
}
body > section > .title, body.notesBodyType > .title {
    margin: 3em 0;
}
body.notesBodyType > section .title {
    text-align: left;
    margin: 1em 0;
}
p {
    text-indent: 1em;
    margin: 0;
}
:not(p) + p, p:first-child {
    text-indent: 0;
}
.poem p {
    text-indent: 0;
    margin: 1em 0;
}
.text-author, .date {
    text-align: end;
}
.text-author:before {
    content: "—";
}
table {
    border-collapse: collapse;
}
td, th {
    padding: .25em;
}
a[epub|type~="noteref"] {
    font-size: .75em;
    vertical-align: super;
}
body:not(.notesBodyType) > .title, body:not(.notesBodyType) > .epigraph {
    margin: 3em 0;
}
`],{type:"text/css"})),Eo="data-foliate-id",yo=async e=>{const t={},r=await(async e=>{var t=await e.arrayBuffer();const r=new TextDecoder("utf-8").decode(t),n=new DOMParser;e=n.parseFromString(r,co.XML);const o=e.xmlEncoding||r.match(/^<\?xml\s+version\s*=\s*["']1.\d+"\s+encoding\s*=\s*["']([A-Za-z0-9._-]*)["']/)?.[1];if(o&&"utf-8"!==o.toLowerCase()){const r=new TextDecoder(o).decode(t);return n.parseFromString(r,co.XML)}return e})(e),n=new go(r),o=e=>r.querySelector(e);var i=e=>[...r.querySelectorAll(e)],a=e=>{var t=ao(e.querySelector("nickname"));if(t)return t;const r=ao(e.querySelector("first-name")),n=ao(e.querySelector("middle-name")),o=ao(e.querySelector("last-name"));return{name:[r,n,o].filter(e=>e).join(" "),sortAs:o?[o,[r,n].filter(e=>e).join(" ")].join(", "):null}},s=e=>e?.getAttribute("value")??ao(e),e=o("title-info annotation");t.metadata={title:ao(o("title-info book-title")),identifier:ao(o("document-info id")),language:ao(o("title-info lang")),author:i("title-info author").map(a),translator:i("title-info translator").map(a),producer:i("document-info author").map(a).concat(i("document-info program-used").map(ao)),publisher:ao(o("publish-info publisher")),published:s(o("title-info date")),modified:s(o("document-info date")),description:e?n.convert(e,{annotation:["div",fo]}).innerHTML:null,subject:i("title-info genre").map(ao)},t.getCover=()=>fetch(po(o("coverpage image"))).then(e=>e.blob());const c=Array.from(r.querySelectorAll("body"),e=>{e=n.convert(e,{body:["body",ho]});return[Array.from(e.children,e=>{var t=[e,...e.querySelectorAll("[id]")].map(e=>e.id);return{el:e,ids:t}}),e]}),l=c[0][0].map(({el:e,ids:t})=>{return{ids:t,titles:Array.from(e.querySelectorAll(":scope > section > .title"),(e,t)=>(e.setAttribute(Eo,t),{title:ao(e),index:t})),el:e}}).concat(c.slice(1).map(([e,t])=>{e=e.map(e=>e.ids).flat();return t.classList.add("notesBodyType"),{ids:e,el:t,linear:"no"}})).map(({ids:e,titles:t,el:r,linear:n})=>{const o=(i=r.outerHTML,`<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head><link href="${mo}" rel="stylesheet" type="text/css"/></head>
    <body>${i}</body>
</html>`);var i=new Blob([o],{type:co.XHTML});const a=URL.createObjectURL(i);return{ids:e,title:io(r.querySelector(".title, .subtitle, p")?.textContent??(r.classList.contains("title")?r.textContent:"")),titles:t,load:()=>a,createDocument:()=>(new DOMParser).parseFromString(o,co.XHTML),size:i.size-Array.from(r.querySelectorAll("[src]"),e=>e.getAttribute("src")?.length??0).reduce((e,t)=>e+t,0),linear:n}}),d=new Map;return t.sections=l.map((e,t)=>{var{ids:r,load:n,createDocument:o,size:i,linear:e}=e;for(const a of r)a&&d.set(a,t);return{id:t,load:n,createDocument:o,size:i,linear:e}}),t.toc=l.map(({title:e,titles:t},r)=>{const n=r.toString();return{label:e,href:n,subitems:t?.length?t.map(({title:e,index:t})=>({label:e,href:`${n}#${t}`})):null}}).filter(e=>e),t.resolveHref=e=>{const[t,r]=e.split("#");return t?{index:Number(t),anchor:e=>e.querySelector(`[${Eo}="${r}"]`)}:{index:d.get(r),anchor:e=>e.getElementById(r)}},t.splitTOCHref=e=>e?.split("#")?.map(e=>Number(e))??[],t.getTOCFragment=(e,t)=>e.querySelector(`[${Eo}="${t}"]`),t};window.e=window.eval,window.a=window.atob,e.ComicRender=class extends br{constructor(e,t,r,n){super(t,n),this.comicBuffer=e,this.mode=t,this.format=r,this.chapterList=[],this.chapterDocList=[],this.book="",this.element="",this.isSliding=n||!1,this.rpc}renderTo(i){return new Promise((o,e)=>f(this,void 0,void 0,function*(){if(yield w()){var t,r,n=new Blob([this.comicBuffer]),n=new File([n],"book."+this.format.toLocaleLowerCase(),{lastModified:(new Date).getTime(),type:n.type});"CBZ"===this.format?(t=yield this.makeZipLoader(n),this.book=to(t,n)):"CBT"===this.format?(t=yield this.makeTarLoader(),this.book=to(t,n)):"CBR"===this.format?(this.rpc=yield window.RPC.new("/lib/libunrar/worker.js",{loaded:function(){console.log("loaded")},progressShow:function(e,t,r){console.log(r)}}),yield new Promise(e=>setTimeout(e,200)),r=yield this.makeRarLoader(),this.book=to(r,n)):"CB7"===this.format&&(r=yield this.make7zLoader(),this.book=to(r,n));let e=new Or(this.book);this.element=i,this.chapterList=yield e.getChapter(this.book.toc),this.chapterDocList=yield e.getChapterDoc(),nr(i),or(i,this.mode),this.trigger("rendered"),o()}else o()}))}makeZipLoader(l){return f(this,void 0,void 0,function*(){const{ZipReader:e,BlobReader:t,TextWriter:r,BlobWriter:n}=window.zip;window.zip.configure({useWebWorkers:!1});const o=new e(new t(l)),i=yield o.getEntries(),a=new Map(i.map(e=>[e.filename,e]));var s=r=>(e,...t)=>a.has(e)?r(a.get(e),...t):null,c=s(e=>e.getData(new r)),s=s((e,t)=>e.getData(new n(t)));return{entries:i,loadText:c,loadBlob:s,getSize:e=>{return null!==(e=null===(e=a.get(e))||void 0===e?void 0:e.uncompressedSize)&&void 0!==e?e:0}}})}makeTarLoader(){return f(this,void 0,void 0,function*(){const e=yield no(this.comicBuffer),n=new Map(e.map(e=>[e.name,e]));var t=r=>(e,...t)=>n.has(e)?r(n.get(e),...t):null,r=t(e=>e.readAsString()),t=t((e,t)=>e.blob);return{entries:e.map(e=>({filename:e.name})),loadText:r,loadBlob:t,getSize:e=>{return null!==(e=null===(e=n.get(e))||void 0===e?void 0:e.size)&&void 0!==e?e:0}}})}makeRarLoader(){return f(this,void 0,void 0,function*(){return new Promise((o,e)=>{var t=[this.comicBuffer],r=[{name:"test.rar",content:this.comicBuffer}];this.rpc.transferables=t,this.rpc.unrar(r,null,0).then(e=>{var t=this.getRarEntries(e.ls);const n=new Map(Object.values(t).map(e=>[e.fullFileName,e]));var r=r=>(e,...t)=>n.has(e)?r(n.get(e),...t):null,e=r(e=>e.fullFileName),r=r((e,t)=>new Blob([e.fileContent]));o({entries:Object.values(t).map(e=>({filename:e.fullFileName})),loadText:e,loadBlob:r,getSize:e=>{return null!==(e=null===(e=n.get(e))||void 0===e?void 0:e.fileSize)&&void 0!==e?e:0}})}).catch(e=>{console.log(e)})})})}make7zLoader(){return f(this,void 0,void 0,function*(){var e="/lib/7z-wasm/7zz.wasm";if(!window.wasmBinary){const s=yield fetch(e,{credentials:"same-origin"});if(!s.ok)throw"failed to load wasm binary file at '"+e+"'";window.wasmBinary=yield s.arrayBuffer()}const t=yield oo({wasmBinary:window.wasmBinary});var r=new Uint8Array(this.comicBuffer),n="archive.cb7",e=t.FS.open(n,"w+");t.FS.write(e,r,0,r.length),t.FS.close(e),t.callMain(["x",n]);const o=t.FS,i=this.get7zEntries(o.lookupPath("/").node),a=new Map(i.map(e=>[e.name,e]));e=r=>(e,...t)=>a.has(e)?r(a.get(e),...t):null,n=e(e=>e.name),e=e((e,t)=>new Blob([e.buffer]));return{entries:i.map(e=>({filename:e.name})),loadText:n,loadBlob:e,getSize:e=>{return null!==(e=null===(e=a.get(e))||void 0===e?void 0:e.packSize)&&void 0!==e?e:0}}})}getRarEntries(t){const e=Object.keys(t);let r=[];return e.forEach(e=>{"dir"===t[e].type?r=r.concat(this.getRarEntries(t[e].ls)):r.push({fullFileName:e,fileContent:t[e].fileContent,fileSize:t[e].fileSize})}),r}get7zEntries(e){const t=e.contents,r=Object.keys(t).filter(e=>"archive.cb7"!=e&&"dev"!=e&&"home"!=e&&"proc"!=e&&"tmp"!=e);let n=[];return r.forEach(e=>{t[e].isFolder?n=n.concat(this.get7zEntries(t[e])):n.push({name:e,buffer:t[e].contents,size:t[e].usedBytes})}),n}getMetadata(){return f(this,void 0,void 0,function*(){return new Promise((o,e)=>f(this,void 0,void 0,function*(){var e,t,r=new Blob([this.comicBuffer]),r=new File([r],"book",{lastModified:(new Date).getTime(),type:r.type});"CBZ"===this.format?(e=yield this.makeZipLoader(r),this.book=to(e,r)):"CBT"===this.format?(e=yield this.makeTarLoader(),this.book=to(e,r)):"CBR"===this.format?(this.rpc=yield window.RPC.new("/lib/libunrar/worker.js",{loaded:function(){console.log("loaded")},progressShow:function(e,t,r){console.log(r)}}),yield new Promise(e=>setTimeout(e,200)),t=yield this.makeRarLoader(),this.book=to(t,r)):"CB7"===this.format&&(t=yield this.make7zLoader(),this.book=to(t,r));var r=yield this.book.getCover(),n=new FileReader;n.readAsDataURL(r),n.onloadend=()=>{o({cover:n.result})}}))})}},e.EpubRender=class extends br{constructor(e,t,r){super(t,r),this.epubBuffer=e,this.mode=t,this.chapterList=[],this.chapterDocList=[],this.book="",this.element="",this.isSliding=r||!1}renderTo(n){return new Promise((r,e)=>f(this,void 0,void 0,function*(){if(yield w()){var t=new Blob([this.epubBuffer]),t=new File([t],"book",{lastModified:(new Date).getTime(),type:t.type}),t=yield this.makeZipLoader(t);this.book=yield new gn(t).init();let e=new Or(this.book);this.element=n,this.chapterList=yield e.getChapter(this.book.toc),this.chapterDocList=yield e.getChapterDoc(),nr(n),or(n,this.mode),this.trigger("rendered"),r()}else r()}))}makeZipLoader(l){return f(this,void 0,void 0,function*(){const{ZipReader:e,BlobReader:t,TextWriter:r,BlobWriter:n}=window.zip;window.zip.configure({useWebWorkers:!1});const o=new e(new t(l)),i=yield o.getEntries(),a=new Map(i.map(e=>[e.filename,e]));var s=r=>(e,...t)=>a.has(e)?r(a.get(e),...t):null,c=s(e=>e.getData(new r)),s=s((e,t)=>e.getData(new n(t)));return{entries:i,loadText:c,loadBlob:s,getSize:e=>{return null!==(e=null===(e=a.get(e))||void 0===e?void 0:e.uncompressedSize)&&void 0!==e?e:0}}})}getMetadata(){return f(this,void 0,void 0,function*(){var e=new Blob([this.epubBuffer]),e=new File([e],"book",{lastModified:(new Date).getTime(),type:e.type}),e=yield this.makeZipLoader(e);this.book=yield new gn(e).init();let t=new Or(this.book);return yield t.getMetadata()})}},e.Fb2Render=class extends br{constructor(e,t,r){super(t,r),this.fb2Buffer=e,this.mode=t,this.chapterList=[],this.chapterDocList=[],this.book="",this.element="",this.isSliding=r||!1}renderTo(n){return new Promise((r,e)=>f(this,void 0,void 0,function*(){if(yield w()){var t=new Blob([this.fb2Buffer]);this.book=yield yo(t);let e=new Or(this.book);this.element=n,this.chapterList=yield e.getChapter(this.book.toc),this.chapterDocList=yield e.getChapterDoc(),nr(n),or(n,this.mode),this.trigger("rendered"),r()}else r()}))}getMetadata(){return f(this,void 0,void 0,function*(){var e=new Blob([this.fb2Buffer]);this.book=yield yo(e);let t=new Or(this.book);return yield t.getMetadata()})}},e.MobiRender=class extends br{constructor(e,t,r){super(t,r),this.mobiBuffer=e,this.mode=t,this.chapterList=[],this.chapterDocList=[],this.book="",this.element="",this.isSliding=r||!1}renderTo(n){return new Promise((r,e)=>f(this,void 0,void 0,function*(){if(yield w()){var t=new Blob([this.mobiBuffer]),t=new File([t],"book",{lastModified:(new Date).getTime(),type:t.type});if(yield(async e=>{return"BOOKMOBI"===Nn(await e.slice(60,68).arrayBuffer())})(t)){this.book=yield new Wn({unzlib:window.fflate.unzlibSync}).open(t);let e=new Or(this.book);this.element=n,this.chapterList=yield e.getChapter(this.book.toc),this.chapterDocList=yield e.getChapterDoc(),this.metadata=yield e.getMetadata(),nr(n),or(n,this.mode),this.trigger("rendered"),r()}}else r()}))}getMetadata(){return f(this,void 0,void 0,function*(){var e=new Blob([this.mobiBuffer]),e=new File([e],"book",{lastModified:(new Date).getTime(),type:e.type});this.book=yield new Wn({unzlib:window.fflate.unzlibSync}).open(e);let t=new Or(this.book);return yield t.getMetadata()})}},e.StrRender=class extends br{constructor(e,t,r){super(t,r),this.bookStr=e,this.mode=t,this.chapterList=[],this.chapterDocList=[],this.element="",this.isSliding=r||!1}renderTo(r){return new Promise((t,e)=>f(this,void 0,void 0,function*(){if(yield w()){this.element=r;let e=new ar(this.bookStr);e.isContainChapter()||(this.bookStr=y(e.getDocText()),e=new ar(this.bookStr)),this.chapterList=e.getChapter(),this.chapterDocList=e.getChapterDoc(),nr(r),or(r,this.mode),this.trigger("rendered"),t()}else t()}))}},e.TxtRender=class extends br{constructor(e,t,r,n){super(t,n),this.txtBuffer=e,this.encoding=r,this.mode=t,this.chapterList=[],this.chapterDocList=[],this.bookStr="",this.element="",this.isSliding=n||!1}renderTo(n){return new Promise((r,e)=>f(this,void 0,void 0,function*(){if(yield w()){var t=new TextDecoder(this.encoding).decode(this.txtBuffer),t=y(t);this.bookStr=t,this.element=n;let e=new ar(this.bookStr);this.chapterList=e.getChapter(),this.chapterDocList=e.getChapterDoc(),nr(n),or(n,this.mode),this.trigger("rendered"),r()}else r()}))}},Object.defineProperty(e,"__esModule",{value:!0})});
